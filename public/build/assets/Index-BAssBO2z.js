import{r as m,j as e,H as B,a as x}from"./app-BM0pG2K-.js";import{B as d}from"./button-BtPQLgvd.js";import{I as y}from"./input-P4gpjAsX.js";import{T as I,a as O,b as v,c as o,d as U,e as l}from"./table-D--rNkV5.js";import{B as p}from"./badge-DhtLSkPy.js";import{C as P,b as V,c as q,d as W,a as E}from"./card-BQW5J6xq.js";import{D as $,a as G,b as J,c as K}from"./dialog-BqsMCmD5.js";import{s as h}from"./index-ikzcNs2d.js";import{A as X}from"./app-layout-BjpU8ztl.js";import{A}from"./activity-CUq59JAf.js";import{F as Q}from"./filter-DO5e8H_c.js";import{S as F,X as Y}from"./app-header-cwaq-Tzd.js";import{C as Z}from"./clock-D-avsIE2.js";import{U as ee}from"./user-BjYq-B1L.js";import{F as se}from"./file-text-Bx2SdM7g.js";import{E as ae}from"./eye-Ddg5pr6X.js";import{C as te}from"./chevron-left-C-2wuiID.js";import{C as re}from"./chevron-right-CSI4tqQj.js";/* empty css            */import"./utils-Bx_P6K9N.js";import"./index-DPFnJWts.js";import"./index-ClymHhac.js";import"./index-uCtcDc-w.js";import"./createLucideIcon-BTWQ-ZwJ.js";import"./index-C7FLMnpn.js";import"./index-B5Z9C6CJ.js";import"./index-DqYA8G-1.js";import"./toaster-BQaot-6m.js";import"./index-Bz9564uu.js";import"./index-CLa6oRL-.js";import"./wayfinder-Bf9OnZdi.js";import"./index-B4i4Sow2.js";import"./graduation-cap-CBLUEHTy.js";import"./users-7lztWReb.js";import"./credit-card-B_zWbJ9G.js";import"./calendar-CMD_C6w3.js";import"./lock-BX7cIt7B.js";import"./shield-CsHRZJ-g.js";import"./loader-circle-DY8ckhBZ.js";import"./mail-ij4C9UCm.js";const le=[{title:"Inicio",href:h("programas_academicos.index")},{title:"Auditoría",href:h("audit.index")}];function T(s){return{"App\\Models\\User":"Usuario","App\\Models\\AcademicProgram":"Programa","App\\Models\\Enrollment":"Matrícula","App\\Models\\Payment":"Pago","App\\Models\\Schedule":"Horario","App\\Models\\Attendance":"Asistencia","App\\Models\\StudyPlan":"Plan de Estudio","App\\Models\\Activity":"Actividad","App\\Models\\Message":"Mensaje","App\\Models\\Conversation":"Conversación","App\\Models\\ParentGuardian":"Acudiente","App\\Models\\StudentProfile":"Perfil Estudiante","App\\Models\\TeacherProfile":"Perfil Profesor","App\\Models\\ScheduleEnrollment":"Inscripción Horario","App\\Models\\EvaluationCriteria":"Criterio Evaluación","App\\Models\\ActivityEvaluation":"Evaluación","App\\Models\\PaymentTransaction":"Transacción","App\\Models\\PaymentSetting":"Config. Pago","App\\Models\\WompiSetting":"Config. Wompi","App\\Models\\SmtpSetting":"Config. SMTP","App\\Models\\DemoRequest":"Solicitud Demo","App\\Models\\DemoLead":"Demo Lead","App\\Models\\StudentProgress":"Progreso"}[s]||s.split("\\").pop()||"Desconocido"}function C(s){return{created:{label:"Creado",className:"bg-green-100 text-green-800"},updated:{label:"Actualizado",className:"bg-blue-100 text-blue-800"},deleted:{label:"Eliminado",className:"bg-red-100 text-red-800"}}[s]||{label:s,className:"bg-gray-100 text-gray-800"}}function H(s){return new Date(s).toLocaleDateString("es-CO",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function k(s){return s==null?"—":typeof s=="boolean"?s?"Sí":"No":typeof s=="object"?JSON.stringify(s):String(s)}function L(s){return{name:"Nombre",last_name:"Apellido",email:"Email",status:"Estado",description:"Descripción",monthly_fee:"Cuota Mensual",amount:"Monto",due_date:"Fecha Vencimiento",payment_date:"Fecha Pago",payment_method:"Método Pago",enrolled_level:"Nivel",enrollment_date:"Fecha Matrícula",days_of_week:"Días",start_time:"Hora Inicio",end_time:"Hora Fin",classroom:"Salón",max_students:"Cupos Máx.",class_date:"Fecha Clase",notes:"Notas",modality:"Modalidad",concept:"Concepto",reference_number:"Referencia",is_active:"Activo",module_name:"Módulo",hours:"Horas",level:"Nivel",weight:"Peso",order:"Orden",points_earned:"Puntos",feedback:"Retroalimentación",color:"Color",semester:"Semestre",duration_months:"Duración (meses)",progress:"Progreso",remarks:"Observaciones"}[s]||s.replace(/_/g," ").replace(/\b\w/g,j=>j.toUpperCase())}function $e({activities:s,links:c,meta:j,filters:u}){const[g,w]=m.useState(u?.action||""),[N,M]=m.useState(u?.start_date||""),[f,_]=m.useState(u?.end_date||""),[t,S]=m.useState(null),r=j||{current_page:s.current_page,from:s.from,last_page:s.last_page,to:s.to,total:s.total},i=c||s.links,D=()=>{x.get(h("audit.filter"),{action:g||void 0,start_date:N||void 0,end_date:f||void 0},{preserveState:!0,preserveScroll:!0})},R=()=>{w(""),M(""),_(""),x.get(h("audit.index"))},z=g||N||f,b=s.data||s;return e.jsxs(X,{breadcrumbs:le,children:[e.jsx(B,{title:"Auditoría"}),e.jsxs("div",{className:"mx-auto max-w-7xl space-y-6 p-4 lg:p-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Registro de Auditoría"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Historial de cambios realizados en el sistema"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(p,{variant:"outline",className:"text-sm",children:[e.jsx(A,{className:"mr-1 h-3.5 w-3.5"}),r.total," registros"]})})]}),e.jsxs(P,{children:[e.jsxs(V,{className:"pb-3",children:[e.jsxs(q,{className:"flex items-center gap-2 text-base",children:[e.jsx(Q,{className:"h-4 w-4"}),"Filtros"]}),e.jsx(W,{children:"Filtra los registros por acción, fecha o usuario"})]}),e.jsx(E,{children:e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-end",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"mb-1 block text-xs font-medium text-gray-600",children:"Buscar acción"}),e.jsxs("div",{className:"relative",children:[e.jsx(y,{value:g,onChange:a=>w(a.target.value),placeholder:"created, updated, deleted...",className:"pl-9",onKeyDown:a=>a.key==="Enter"&&D()}),e.jsx(F,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-medium text-gray-600",children:"Desde"}),e.jsx(y,{type:"date",value:N,onChange:a=>M(a.target.value),className:"w-40"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-medium text-gray-600",children:"Hasta"}),e.jsx(y,{type:"date",value:f,onChange:a=>_(a.target.value),className:"w-40"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{onClick:D,size:"sm",children:[e.jsx(F,{className:"mr-1 h-4 w-4"}),"Filtrar"]}),z&&e.jsxs(d,{onClick:R,variant:"outline",size:"sm",children:[e.jsx(Y,{className:"mr-1 h-4 w-4"}),"Limpiar"]})]})]})})]}),e.jsxs(P,{children:[e.jsx(E,{className:"p-0",children:e.jsxs(I,{children:[e.jsx(O,{children:e.jsxs(v,{children:[e.jsx(o,{className:"w-[180px]",children:"Fecha"}),e.jsx(o,{children:"Usuario"}),e.jsx(o,{className:"w-[120px]",children:"Acción"}),e.jsx(o,{children:"Entidad"}),e.jsx(o,{children:"Elemento"}),e.jsx(o,{className:"w-[80px] text-center",children:"Detalle"})]})}),e.jsx(U,{children:Array.isArray(b)&&b.length>0?b.map(a=>{const n=C(a.description);return e.jsxs(v,{className:"hover:bg-gray-50",children:[e.jsx(l,{className:"text-xs text-gray-600",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Z,{className:"h-3.5 w-3.5 text-gray-400"}),H(a.created_at)]})}),e.jsx(l,{children:a.causer?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex h-7 w-7 items-center justify-center rounded-full bg-gray-100",children:e.jsx(ee,{className:"h-3.5 w-3.5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:a.causer.name}),e.jsx("div",{className:"text-xs text-gray-500",children:a.causer.email})]})]}):e.jsx("span",{className:"text-xs text-gray-400 italic",children:"Sistema"})}),e.jsx(l,{children:e.jsx(p,{variant:"secondary",className:n.className,children:n.label})}),e.jsx(l,{children:a.subject?e.jsxs(p,{variant:"outline",className:"font-normal",children:[e.jsx(se,{className:"mr-1 h-3 w-3"}),T(a.subject.type)]}):e.jsx("span",{className:"text-xs text-gray-400",children:"—"})}),e.jsxs(l,{children:[e.jsx("span",{className:"text-sm text-gray-700",children:a.subject?.name||"—"}),a.subject?.id&&e.jsxs("span",{className:"ml-1 text-xs text-gray-400",children:["#",a.subject.id]})]}),e.jsx(l,{className:"text-center",children:e.jsx(d,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>S(a),children:e.jsx(ae,{className:"h-4 w-4 text-gray-500"})})})]},a.id)}):e.jsx(v,{children:e.jsx(l,{colSpan:6,className:"py-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2 text-gray-400",children:[e.jsx(A,{className:"h-10 w-10"}),e.jsx("p",{className:"text-sm font-medium",children:"No se encontraron registros"}),e.jsx("p",{className:"text-xs",children:"Intenta ajustar los filtros de búsqueda"})]})})})})]})}),r.last_page>1&&e.jsxs("div",{className:"flex items-center justify-between border-t px-4 py-3",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Mostrando"," ",e.jsx("span",{className:"font-medium",children:r.from})," ","a"," ",e.jsx("span",{className:"font-medium",children:r.to})," ","de"," ",e.jsx("span",{className:"font-medium",children:r.total})," ","registros"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(d,{variant:"outline",size:"sm",disabled:!i?.prev,onClick:()=>i?.prev&&x.get(i.prev),children:[e.jsx(te,{className:"h-4 w-4"}),"Anterior"]}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Página ",r.current_page," de"," ",r.last_page]}),e.jsxs(d,{variant:"outline",size:"sm",disabled:!i?.next,onClick:()=>i?.next&&x.get(i.next),children:["Siguiente",e.jsx(re,{className:"h-4 w-4"})]})]})]})]})]}),e.jsx($,{open:!!t,onOpenChange:()=>S(null),children:e.jsxs(G,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsx(J,{children:e.jsxs(K,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-5 w-5"}),"Detalle del Registro #",t?.id]})}),t&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 rounded-lg bg-gray-50 p-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Fecha"}),e.jsx("p",{className:"text-sm text-gray-900",children:H(t.created_at)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Acción"}),e.jsx(p,{variant:"secondary",className:C(t.description).className,children:C(t.description).label})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Usuario"}),e.jsx("p",{className:"text-sm text-gray-900",children:t.causer?.name||"Sistema"}),t.causer?.email&&e.jsx("p",{className:"text-xs text-gray-500",children:t.causer.email})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Entidad"}),e.jsx("p",{className:"text-sm text-gray-900",children:t.subject?`${T(t.subject.type)} #${t.subject.id}`:"—"}),t.subject?.name&&e.jsx("p",{className:"text-xs text-gray-500",children:t.subject.name})]})]}),t.properties?.attributes&&e.jsxs("div",{children:[e.jsxs("h4",{className:"mb-2 flex items-center gap-1.5 text-sm font-semibold text-gray-900",children:[e.jsx("span",{className:"h-2 w-2 rounded-full bg-green-500"}),t.properties?.old?"Valores Nuevos":"Valores"]}),e.jsx("div",{className:"overflow-hidden rounded-lg border",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-green-50",children:[e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-600",children:"Campo"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-600",children:"Valor"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:Object.entries(t.properties.attributes).map(([a,n])=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-3 py-2 font-medium text-gray-700",children:L(a)}),e.jsx("td",{className:"px-3 py-2 text-gray-600",children:k(n)})]},a))})]})})]}),t.properties?.old&&e.jsxs("div",{children:[e.jsxs("h4",{className:"mb-2 flex items-center gap-1.5 text-sm font-semibold text-gray-900",children:[e.jsx("span",{className:"h-2 w-2 rounded-full bg-orange-500"}),"Valores Anteriores"]}),e.jsx("div",{className:"overflow-hidden rounded-lg border",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-orange-50",children:[e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-600",children:"Campo"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-600",children:"Valor"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:Object.entries(t.properties.old).map(([a,n])=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-3 py-2 font-medium text-gray-700",children:L(a)}),e.jsx("td",{className:"px-3 py-2 text-gray-600",children:k(n)})]},a))})]})})]}),!t.properties?.attributes&&!t.properties?.old&&e.jsx("div",{className:"rounded-lg border border-dashed py-8 text-center text-sm text-gray-400",children:"No hay detalles de cambios registrados"})]})]})})]})}export{$e as default};
