import{r as b,j as a,H as S,L as _,a as T}from"./app-B-gf--_t.js";import{A as F}from"./app-layout-DCfsguUo.js";import{B as x}from"./button-DTUf-G6D.js";import{C as p,b as y,c as C,a as h}from"./card-CtCBZFLS.js";import{B as j}from"./badge-DHGaHh_K.js";import{I as E}from"./input-CTu6QkH6.js";import{T as L}from"./textarea-BBKmZhVT.js";import{L as u}from"./label-KAX_2qcR.js";import{I as v}from"./app-header-C7WnRrDD.js";import{A as P}from"./arrow-left-COnhC6c-.js";import{G as B}from"./graduation-cap-B9BAa-o7.js";import{S as D}from"./save-tTiNnXcL.js";import"./app-ByrExa3J.js";import"./utils-CBfrqCZ4.js";import"./index-86_gkdgf.js";import"./index-Bw9BVP0i.js";import"./index-BE6TIB6q.js";import"./createLucideIcon-BKgpMFfl.js";import"./index-DPi3QwXA.js";import"./index-ZKCUC6w_.js";import"./index-gJzyg25X.js";import"./toaster-B6w1HnuI.js";import"./index-CdJFUDDL.js";import"./index-IvkJj8jp.js";import"./index-CbRbsemT.js";import"./wayfinder-Bf9OnZdi.js";import"./index-D0SF2iEG.js";import"./user-9gpTgHHE.js";import"./users-zOAYG_oC.js";import"./credit-card-CtoVMbCz.js";import"./calendar-DTT_Gcgg.js";import"./file-text-Ms1_89oi.js";import"./lock-CmYtdoIE.js";import"./shield-BDPpEQT_.js";import"./mail-Cj9TAJd0.js";function fa({schedule:l,activity:r,students:o}){const[f,$]=b.useState(new Date().toISOString().split("T")[0]),[n,g]=b.useState(()=>{const e={};return o.forEach(i=>{e[i.id]={student_id:i.id,criteria:r.evaluation_criteria.map(s=>{const c=i.existing_evaluations.find(t=>t.evaluation_criteria_id===s.id);return{evaluation_criteria_id:s.id,points_earned:c?.points_earned||0}}),feedback:i.existing_evaluations[0]?.feedback||""}}),e}),w=(e,i,s)=>{const c=parseFloat(s)||0;g(t=>({...t,[e]:{...t[e],criteria:t[e].criteria.map(m=>m.evaluation_criteria_id===i?{...m,points_earned:c}:m)}}))},k=(e,i)=>{g(s=>({...s,[e]:{...s[e],feedback:i}}))},N=e=>n[e]?.criteria.reduce((i,s)=>i+s.points_earned,0)||0,d=()=>r.evaluation_criteria.reduce((e,i)=>e+i.max_points,0),A=()=>{const e=Object.values(n);T.post(`/profesor/grupo/${l.id}/actividad/${r.id}/evaluaciones`,{evaluation_date:f,evaluations:e})};return a.jsxs(F,{variant:"sidebar",title:`Evaluar: ${r.name} - Portal Profesor`,children:[a.jsx(S,{title:`Evaluar: ${r.name} - Portal Profesor`}),a.jsxs("div",{className:"px-6 py-8",children:[a.jsx("div",{className:"mb-8",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Evaluar Actividad"}),a.jsx("p",{className:"text-gray-600",children:l.program.name})]}),a.jsx(_,{href:`/profesor/grupo/${l.id}`,children:a.jsxs(x,{variant:"outline",children:[a.jsx(v,{iconNode:P,className:"w-4 h-4 mr-2"}),"Volver"]})})]})}),a.jsxs(p,{className:"mb-6",children:[a.jsx(y,{children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsx(C,{className:"text-2xl mb-2",children:r.name}),a.jsx("p",{className:"text-gray-600 mb-3",children:r.description}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(j,{variant:"outline",children:r.study_plan.module_name}),a.jsxs(j,{variant:"secondary",children:["Peso: ",r.weight,"%"]}),a.jsxs(j,{variant:"secondary",children:["Puntaje Total: ",d()," puntos"]})]})]}),a.jsx(v,{iconNode:B,className:"w-12 h-12 text-[#7a9b3c]"})]})}),a.jsx(h,{children:a.jsxs("div",{children:[a.jsx(u,{htmlFor:"evaluation_date",children:"Fecha de Evaluación"}),a.jsx(E,{id:"evaluation_date",type:"date",value:f,onChange:e=>$(e.target.value),className:"max-w-xs"})]})})]}),a.jsx("div",{className:"space-y-6",children:o.length===0?a.jsx(p,{children:a.jsx(h,{className:"py-12 text-center text-gray-500",children:"No hay estudiantes para evaluar"})}):o.map(e=>a.jsxs(p,{children:[a.jsx(y,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(C,{children:e.name}),a.jsx("p",{className:"text-sm text-gray-600",children:e.email})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"text-3xl font-bold text-gray-900",children:[N(e.id),"/",d()]}),a.jsxs("div",{className:"text-sm text-gray-600",children:[d()>0?Math.round(N(e.id)/d()*100):0,"%"]})]})]})}),a.jsx(h,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Criterios de Evaluación"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.evaluation_criteria.map(i=>a.jsxs("div",{className:"space-y-2",children:[a.jsxs(u,{htmlFor:`student-${e.id}-criteria-${i.id}`,children:[i.name,a.jsxs("span",{className:"text-gray-500 ml-2 text-sm",children:["(Max: ",i.max_points," pts)"]})]}),a.jsx(E,{id:`student-${e.id}-criteria-${i.id}`,type:"number",min:"0",max:i.max_points,step:"0.5",value:n[e.id]?.criteria.find(s=>s.evaluation_criteria_id===i.id)?.points_earned||0,onChange:s=>w(e.id,i.id,s.target.value)}),i.description&&a.jsx("p",{className:"text-xs text-gray-500",children:i.description})]},i.id))})]}),a.jsxs("div",{children:[a.jsx(u,{htmlFor:`feedback-${e.id}`,children:"Retroalimentación (opcional)"}),a.jsx(L,{id:`feedback-${e.id}`,placeholder:"Escribe comentarios o sugerencias para el estudiante...",value:n[e.id]?.feedback||"",onChange:i=>k(e.id,i.target.value),rows:3})]})]})})]},e.id))}),o.length>0&&a.jsxs("div",{className:"mt-8 flex gap-4",children:[a.jsxs(x,{onClick:A,className:"flex-1 bg-[#7a9b3c] hover:bg-[#6a8a2c] text-lg py-6",children:[a.jsx(v,{iconNode:D,className:"w-5 h-5 mr-2"}),"Guardar Evaluaciones"]}),a.jsx(_,{href:`/profesor/grupo/${l.id}`,className:"flex-shrink-0",children:a.jsx(x,{variant:"outline",className:"text-lg py-6",children:"Cancelar"})})]})]})]})}export{fa as default};
