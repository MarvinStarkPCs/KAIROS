import{r as h,j as e,H as k,L as o,a as i}from"./app-C_wc9es_.js";import{B as t}from"./button-CK7_c_5e.js";import{I as w}from"./input-C7PQsbVn.js";import{L as m}from"./label-nyAx6Y8t.js";import{A as y}from"./app-layout-RCkHY00m.js";import{A as _,b as D,c as S,d as L,e as P,f as A,g as E,h as F}from"./alert-dialog-DSO5EJZi.js";import{C as I}from"./chart-column-CY7693rt.js";import{g as z,S as $}from"./app-header-3tM_PALz.js";import{P as M}from"./plus-CQpr_2NB.js";import{F as B}from"./filter-y48JMa5Z.js";import{c as T}from"./createLucideIcon-Cl_h1Hpc.js";import{C as R}from"./credit-card-Cyqos1IL.js";import{D as O}from"./dollar-sign-BaSFt2-U.js";import{R as V}from"./refresh-cw-BgE7mHnV.js";import{E as H}from"./eye-DFqR6Zng.js";import{S as q}from"./square-pen-C_v7H18p.js";import{T as W}from"./trash-2-wqlGlzgk.js";import{C as g}from"./circle-x-B_8ujt9i.js";import{C as G}from"./clock-B2E0vVh3.js";import{C as K}from"./circle-check-big-e5VBrFsL.js";/* empty css            */import"./utils-BTwnVSy2.js";import"./index-CNhhqjg2.js";import"./index-BPZo39PE.js";import"./index-DJBO6EKN.js";import"./index-myZmSymV.js";import"./index-Be2p5AN3.js";import"./index-BLRCw3fc.js";import"./toaster-eRoXJvOx.js";import"./chevron-right-FEguOG6w.js";import"./index-BXFwRZdy.js";import"./index-CLa6oRL-.js";import"./wayfinder-Bf9OnZdi.js";import"./index-D12nj1Ca.js";import"./book-open-DgLAYnVa.js";import"./graduation-cap-DpEnpuH4.js";import"./users-BlXHteJc.js";import"./calendar-CdY4SBhE.js";import"./file-text-BcV-VVC0.js";import"./lock-l4QBdaDv.js";import"./shield-Dk7fcTnH.js";import"./chevron-down-D4MJa3Wh.js";import"./loader-circle-DIXjFJg0.js";import"./mail-jATxNgrm.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],J=T("List",X);function Re({payments:x,programs:j,filters:n}){const[l,c]=h.useState({open:!1,paymentId:null}),[r,d]=h.useState({status:n.status||"",search:n.search||"",program_id:n.program_id||""}),p=()=>{i.get("/pagos",r,{preserveState:!0})},f=()=>{d({status:"",search:"",program_id:""}),i.get("/pagos")},b=()=>{l.paymentId&&i.delete(`/pagos/${l.paymentId}`,{onSuccess:()=>{c({open:!1,paymentId:null})}})},N=s=>{i.post(`/pagos/${s}/check-wompi`,{},{preserveScroll:!0})},v=s=>{const a={completed:{bg:"bg-green-100 dark:bg-green-900/30",text:"text-green-700 dark:text-green-400",label:"Completado",icon:K},pending:{bg:"bg-yellow-100 dark:bg-yellow-900/30",text:"text-yellow-700 dark:text-yellow-400",label:"Pendiente",icon:G},overdue:{bg:"bg-red-100 dark:bg-red-900/30",text:"text-red-700 dark:text-red-400",label:"Vencido",icon:g},cancelled:{bg:"bg-muted",text:"text-muted-foreground",label:"Cancelado",icon:g}};return a[s]||a.pending};return e.jsxs(y,{children:[e.jsx(k,{title:"Pagos"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Pagos"}),e.jsx("p",{className:"mt-2 text-muted-foreground",children:"Gestiona mensualidades, cuotas y abonos"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(o,{href:"/reportes/pagos",children:e.jsxs(t,{variant:"outline",className:"flex items-center space-x-2",children:[e.jsx(I,{className:"h-5 w-5"}),e.jsx("span",{children:"Reportes"})]})}),e.jsx(o,{href:"/pagos/settings",children:e.jsxs(t,{variant:"outline",className:"flex items-center space-x-2",children:[e.jsx(z,{className:"h-5 w-5"}),e.jsx("span",{children:"Configuración"})]})}),e.jsx(o,{href:"/pagos/create",children:e.jsxs(t,{className:"flex items-center space-x-2",children:[e.jsx(M,{className:"h-5 w-5"}),e.jsx("span",{children:"Registrar Pago"})]})})]})]}),e.jsxs("div",{className:"rounded-xl border border-border bg-card p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx(B,{className:"h-5 w-5 text-muted-foreground"}),e.jsx("h2",{className:"text-lg font-semibold text-foreground",children:"Filtros"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"status",children:"Estado"}),e.jsxs("select",{id:"status",value:r.status,onChange:s=>d({...r,status:s.target.value}),className:"mt-1 w-full rounded-md border border-input bg-background px-3 py-2 text-sm text-foreground",children:[e.jsx("option",{value:"",children:"Todos"}),e.jsx("option",{value:"pending",children:"Pendiente"}),e.jsx("option",{value:"completed",children:"Completado"}),e.jsx("option",{value:"overdue",children:"Vencido"}),e.jsx("option",{value:"cancelled",children:"Cancelado"})]})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"search",children:"Estudiante (nombre o identificación)"}),e.jsx(w,{id:"search",type:"text",value:r.search,onChange:s=>d({...r,search:s.target.value}),placeholder:"Buscar por nombre o documento...",className:"mt-1",onKeyDown:s=>s.key==="Enter"&&p()})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"program",children:"Programa"}),e.jsxs("select",{id:"program",value:r.program_id,onChange:s=>d({...r,program_id:Number(s.target.value)||""}),className:"mt-1 w-full rounded-md border border-input bg-background px-3 py-2 text-sm text-foreground",children:[e.jsx("option",{value:"",children:"Todos"}),j.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsxs(t,{onClick:p,className:"flex-1",children:[e.jsx($,{className:"mr-2 h-4 w-4"}),"Filtrar"]}),e.jsx(t,{variant:"outline",onClick:f,children:"Limpiar"})]})]})]}),e.jsx("div",{className:"rounded-xl border border-border bg-card shadow-sm",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"border-b border-border bg-muted",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-muted-foreground",children:"Estudiante"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-muted-foreground",children:"Concepto"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-muted-foreground",children:"Tipo/Progreso"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-muted-foreground",children:"Monto"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-muted-foreground",children:"Vencimiento"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-muted-foreground",children:"Estado"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium uppercase text-muted-foreground",children:"Acciones"})]})}),e.jsx("tbody",{className:"divide-y divide-border",children:x.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-12 text-center text-muted-foreground",children:"No se encontraron pagos"})}):x.data.map(s=>{const a=v(s.status),C=a.icon,u=s.original_amount?s.paid_amount/s.original_amount*100:0;return e.jsxs("tr",{className:"hover:bg-muted/50",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsxs("div",{className:"font-medium text-foreground",children:[s.student.name," ",s.student.last_name||""]}),s.student.document_number&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Doc: ",s.student.document_number]})]}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-foreground",children:s.concept}),s.program&&e.jsx("div",{className:"text-xs text-muted-foreground",children:s.program.name})]}),e.jsxs("td",{className:"px-6 py-4",children:[s.payment_type==="installment"&&e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-blue-100 dark:bg-blue-900/30 px-2 py-1 text-xs font-medium text-blue-700 dark:text-blue-400",children:[e.jsx(J,{className:"h-3 w-3"}),"Cuota ",s.installment_number,"/",s.total_installments]}),s.payment_type==="partial"&&s.has_transactions&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-purple-100 dark:bg-purple-900/30 px-2 py-1 text-xs font-medium text-purple-700 dark:text-purple-400",children:[e.jsx(R,{className:"h-3 w-3"}),"Con abonos"]}),e.jsxs("div",{className:"w-32",children:[e.jsx("div",{className:"h-2 rounded-full bg-muted",children:e.jsx("div",{className:"h-2 rounded-full bg-purple-600",style:{width:`${u}%`}})}),e.jsxs("div",{className:"mt-0.5 text-xs text-muted-foreground",children:[u.toFixed(0),"% pagado"]})]})]}),s.payment_type==="single"&&e.jsx("span",{className:"text-xs text-muted-foreground",children:"Pago único"})]}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsxs("div",{className:"flex items-center gap-1 font-semibold text-foreground",children:[e.jsx(O,{className:"h-4 w-4"}),s.amount.toLocaleString("es-CO")]}),s.pending_balance>0&&s.status!=="completed"&&e.jsxs("div",{className:"text-xs text-orange-600 dark:text-orange-400",children:["Pendiente: $",s.pending_balance.toLocaleString("es-CO")]})]}),e.jsx("td",{className:"px-6 py-4 text-sm text-muted-foreground",children:new Date(s.due_date).toLocaleDateString("es-CO")}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-2.5 py-1 text-xs font-medium ${a.bg} ${a.text}`,children:[e.jsx(C,{className:"h-3 w-3"}),a.label]})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[s.wompi_transaction_id&&s.status==="pending"&&e.jsx(t,{variant:"outline",size:"sm",className:"text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20",onClick:()=>N(s.id),title:"Verificar estado en Wompi",children:e.jsx(V,{className:"h-4 w-4"})}),e.jsx(o,{href:`/pagos/${s.id}`,children:e.jsx(t,{variant:"outline",size:"sm",children:e.jsx(H,{className:"h-4 w-4"})})}),e.jsx(o,{href:`/pagos/${s.id}/edit`,children:e.jsx(t,{variant:"outline",size:"sm",children:e.jsx(q,{className:"h-4 w-4"})})}),e.jsx(t,{variant:"outline",size:"sm",className:"text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20",onClick:()=>c({open:!0,paymentId:s.id}),children:e.jsx(W,{className:"h-4 w-4"})})]})})]},s.id)})})]})})})]}),e.jsx(_,{open:l.open,onOpenChange:s=>c({...l,open:s}),children:e.jsxs(D,{children:[e.jsxs(S,{children:[e.jsx(L,{children:"¿Estás seguro?"}),e.jsx(P,{children:"Esta acción no se puede deshacer. El pago será eliminado permanentemente."})]}),e.jsxs(A,{children:[e.jsx(E,{children:"Cancelar"}),e.jsx(F,{onClick:b,className:"bg-red-600 hover:bg-red-700",children:"Eliminar"})]})]})})]})}export{Re as default};
