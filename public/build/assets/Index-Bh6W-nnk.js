import{r as g,j as e,H as v,L as i,a as c}from"./app-B85toirr.js";import{B as r}from"./button-V5I046Om.js";import{I as C}from"./input-DwwiTAjL.js";import{L as x}from"./label-xRujv7VM.js";import{A as w}from"./app-layout-uaa7LMg4.js";import{A as _,b as k,c as D,d as S,e as P,f as A,g as E,h as L}from"./alert-dialog-rASfoqc_.js";import{j as F,S as I}from"./app-header-BoSKnCjG.js";import{P as z}from"./plus-sbbb07kg.js";import{F as $}from"./filter-cc4kpeJM.js";import{c as M}from"./createLucideIcon-COpZNn89.js";import{C as B}from"./credit-card-C6xjWlW1.js";import{D as T}from"./dollar-sign-KDpXK4pA.js";import{R as O}from"./refresh-cw-CId3YXtZ.js";import{E as R}from"./eye-MJ7Dbdj_.js";import{S as V}from"./square-pen-DEt4YCLP.js";import{T as H}from"./trash-2-CiRTKiT6.js";import{C as u}from"./circle-x-PlW6FsBv.js";import{C as q}from"./clock-DkLs3PX3.js";import{C as W}from"./circle-check-big-CscPH83H.js";import"./app-C6Vy-nmo.js";import"./utils-CXWJhbrE.js";import"./index-BfJaSvo0.js";import"./index-B4YQdnni.js";import"./index-MRgZvhks.js";import"./index-BKdeqJ9g.js";import"./index-CQRKOrpE.js";import"./index-B_OyAaor.js";import"./toaster-BP8DQWEf.js";import"./chevron-right-ZeX9EP49.js";import"./index-YL3iSs7e.js";import"./index-BGHOW37F.js";import"./wayfinder-Bf9OnZdi.js";import"./index-DGFuwtWj.js";import"./graduation-cap-CMb3OYv1.js";import"./users-CPQ58gqB.js";import"./calendar-DoTJ9WpJ.js";import"./file-text-CDbcMrsE.js";import"./lock-DvBGh-ba.js";import"./shield-CkMlCz6n.js";import"./mail-80QjdHWr.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],K=M("List",G);function Ie({payments:m,programs:j,filters:o}){const[l,n]=g.useState({open:!1,paymentId:null}),[t,d]=g.useState({status:o.status||"",search:o.search||"",program_id:o.program_id||""}),p=()=>{c.get("/pagos/list",t,{preserveState:!0})},f=()=>{l.paymentId&&c.delete(`/pagos/${l.paymentId}`,{onSuccess:()=>{n({open:!1,paymentId:null})}})},N=s=>{c.post(`/pagos/${s}/check-wompi`,{},{preserveScroll:!0})},b=s=>{const a={completed:{bg:"bg-green-100",text:"text-green-700",label:"Completado",icon:W},pending:{bg:"bg-yellow-100",text:"text-yellow-700",label:"Pendiente",icon:q},overdue:{bg:"bg-red-100",text:"text-red-700",label:"Vencido",icon:u},cancelled:{bg:"bg-gray-100",text:"text-gray-700",label:"Cancelado",icon:u}};return a[s]||a.pending};return e.jsxs(w,{children:[e.jsx(v,{title:"Pagos"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Pagos"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Gestiona mensualidades, cuotas y abonos"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(i,{href:"/pagos/settings",children:e.jsxs(r,{variant:"outline",className:"flex items-center space-x-2",children:[e.jsx(F,{className:"h-5 w-5"}),e.jsx("span",{children:"Configuración"})]})}),e.jsx(i,{href:"/pagos/create",children:e.jsxs(r,{className:"flex items-center space-x-2",children:[e.jsx(z,{className:"h-5 w-5"}),e.jsx("span",{children:"Registrar Pago"})]})})]})]}),e.jsxs("div",{className:"rounded-xl border border-gray-200 bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx($,{className:"h-5 w-5 text-gray-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Filtros"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"status",children:"Estado"}),e.jsxs("select",{id:"status",value:t.status,onChange:s=>d({...t,status:s.target.value}),className:"mt-1 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm",children:[e.jsx("option",{value:"",children:"Todos"}),e.jsx("option",{value:"pending",children:"Pendiente"}),e.jsx("option",{value:"completed",children:"Completado"}),e.jsx("option",{value:"overdue",children:"Vencido"}),e.jsx("option",{value:"cancelled",children:"Cancelado"})]})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"search",children:"Estudiante (nombre o identificación)"}),e.jsx(C,{id:"search",type:"text",value:t.search,onChange:s=>d({...t,search:s.target.value}),placeholder:"Buscar por nombre o documento...",className:"mt-1",onKeyDown:s=>s.key==="Enter"&&p()})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"program",children:"Programa"}),e.jsxs("select",{id:"program",value:t.program_id,onChange:s=>d({...t,program_id:Number(s.target.value)||""}),className:"mt-1 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm",children:[e.jsx("option",{value:"",children:"Todos"}),j.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs(r,{onClick:p,className:"w-full",children:[e.jsx(I,{className:"mr-2 h-4 w-4"}),"Filtrar"]})})]})]}),e.jsx("div",{className:"rounded-xl border border-gray-200 bg-white shadow-sm",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"border-b border-gray-200 bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-700",children:"Estudiante"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-700",children:"Concepto"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-700",children:"Tipo/Progreso"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-700",children:"Monto"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-700",children:"Vencimiento"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-700",children:"Estado"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium uppercase text-gray-700",children:"Acciones"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:m.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-500",children:"No se encontraron pagos"})}):m.data.map(s=>{const a=b(s.status),y=a.icon,h=s.original_amount?s.paid_amount/s.original_amount*100:0;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"font-medium text-gray-900",children:s.student.name})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-gray-700",children:s.concept}),s.program&&e.jsx("div",{className:"text-xs text-gray-500",children:s.program.name})]}),e.jsxs("td",{className:"px-6 py-4",children:[s.payment_type==="installment"&&e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-blue-100 px-2 py-1 text-xs font-medium text-blue-700",children:[e.jsx(K,{className:"h-3 w-3"}),"Cuota ",s.installment_number,"/",s.total_installments]}),s.payment_type==="partial"&&s.has_transactions&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-purple-100 px-2 py-1 text-xs font-medium text-purple-700",children:[e.jsx(B,{className:"h-3 w-3"}),"Con abonos"]}),e.jsxs("div",{className:"w-32",children:[e.jsx("div",{className:"h-2 rounded-full bg-gray-200",children:e.jsx("div",{className:"h-2 rounded-full bg-purple-600",style:{width:`${h}%`}})}),e.jsxs("div",{className:"mt-0.5 text-xs text-gray-600",children:[h.toFixed(0),"% pagado"]})]})]}),s.payment_type==="single"&&e.jsx("span",{className:"text-xs text-gray-500",children:"Pago único"})]}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsxs("div",{className:"flex items-center gap-1 font-semibold text-gray-900",children:[e.jsx(T,{className:"h-4 w-4"}),s.amount.toLocaleString("es-CO")]}),s.pending_balance>0&&s.status!=="completed"&&e.jsxs("div",{className:"text-xs text-orange-600",children:["Pendiente: $",s.pending_balance.toLocaleString("es-CO")]})]}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:new Date(s.due_date).toLocaleDateString("es-CO")}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-2.5 py-1 text-xs font-medium ${a.bg} ${a.text}`,children:[e.jsx(y,{className:"h-3 w-3"}),a.label]})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[s.wompi_transaction_id&&s.status==="pending"&&e.jsx(r,{variant:"outline",size:"sm",className:"text-blue-600 hover:bg-blue-50",onClick:()=>N(s.id),title:"Verificar estado en Wompi",children:e.jsx(O,{className:"h-4 w-4"})}),e.jsx(i,{href:`/pagos/${s.id}`,children:e.jsx(r,{variant:"outline",size:"sm",children:e.jsx(R,{className:"h-4 w-4"})})}),e.jsx(i,{href:`/pagos/${s.id}/edit`,children:e.jsx(r,{variant:"outline",size:"sm",children:e.jsx(V,{className:"h-4 w-4"})})}),e.jsx(r,{variant:"outline",size:"sm",className:"text-red-600 hover:bg-red-50",onClick:()=>n({open:!0,paymentId:s.id}),children:e.jsx(H,{className:"h-4 w-4"})})]})})]},s.id)})})]})})})]}),e.jsx(_,{open:l.open,onOpenChange:s=>n({...l,open:s}),children:e.jsxs(k,{children:[e.jsxs(D,{children:[e.jsx(S,{children:"¿Estás seguro?"}),e.jsx(P,{children:"Esta acción no se puede deshacer. El pago será eliminado permanentemente."})]}),e.jsxs(A,{children:[e.jsx(E,{children:"Cancelar"}),e.jsx(L,{onClick:f,className:"bg-red-600 hover:bg-red-700",children:"Eliminar"})]})]})})]})}export{Ie as default};
