import{u as ie,r as k,j as t,b as Qe,H as qe,L as xe,a as B}from"./app-_rOQn_46.js";import{B as u}from"./button-Cwjg0RKq.js";import{A as Z,a as ee,b as je}from"./alert-CYZS65Ov.js";import{p as pe}from"./program_academy-IHQIcmQm.js";import{a as q,q as $}from"./wayfinder-Bf9OnZdi.js";import{A as $e}from"./app-layout-CLhCFhGY.js";import{D as ae,a as de,b as le,c as oe,d as ne,f as ce}from"./dialog-DY_ZgsD6.js";import{I as W}from"./input-C_eRjc1n.js";import{L as g}from"./label-DRPRRf45.js";import{T as me}from"./textarea-DonjrRxY.js";import{C as re}from"./circle-check-CPfYiL2w.js";import{T as se}from"./triangle-alert-ncTQFx2-.js";import{c as fe}from"./createLucideIcon-BTUecZaa.js";import{A as G,b as O,c as R,d as V,e as J,f as K,g as X,h as Y}from"./alert-dialog-CFvNabCX.js";import{A as Ie}from"./arrow-left-BFNy3nN-.js";import{P as U}from"./plus-25oOd8Jq.js";import{B as he,L as Le}from"./list-checks-BLF9I54Z.js";import{T as te}from"./trash-2-B0HAO7F0.js";import{A as Me}from"./book-open-d3nfV-Db.js";/* empty css            */import"./utils-CHYGzkwl.js";import"./index-HbNiKBAr.js";import"./index-kZXzX9CC.js";import"./index-C0WYYgI1.js";import"./index-DhMGY2fr.js";import"./index-LDKjRhno.js";import"./index-86eqSqYr.js";import"./app-header-uhUDMoS0.js";import"./chevron-right-KvpbVvzH.js";import"./index-B4ow9L1E.js";import"./index-CLa6oRL-.js";import"./index-D12nj1Ca.js";import"./graduation-cap-h2z_kizA.js";import"./users-CU2UoBYp.js";import"./credit-card-CtYZ3YyT.js";import"./calendar-DwYwQP4N.js";import"./file-text-CqZet-U8.js";import"./lock-BoKNE-VZ.js";import"./shield-DI4dg6mj.js";import"./chevron-down-gmsC21Id.js";import"./loader-circle-eUOhA3c_.js";import"./mail-DuzhTNEq.js";import"./toaster-DF114ULM.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],ue=fe("Info",ze);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],ve=fe("WandSparkles",We),C=(e,r)=>({url:C.url(e,r),method:"post"});C.definition={methods:["post"],url:"/programas_academicos/{program}/study-plans"};C.url=(e,r)=>{(typeof e=="string"||typeof e=="number")&&(e={program:e}),typeof e=="object"&&!Array.isArray(e)&&"id"in e&&(e={program:e.id}),Array.isArray(e)&&(e={program:e[0]}),e=q(e);const a={program:typeof e.program=="object"?e.program.id:e.program};return C.definition.url.replace("{program}",a.program.toString()).replace(/\/+$/,"")+$(r)};C.post=(e,r)=>({url:C.url(e,r),method:"post"});const ye=(e,r)=>({action:C.url(e,r),method:"post"});ye.post=(e,r)=>({action:C.url(e,r),method:"post"});C.form=ye;const w=(e,r)=>({url:w.url(e,r),method:"put"});w.definition={methods:["put"],url:"/study-plans/{studyPlan}"};w.url=(e,r)=>{(typeof e=="string"||typeof e=="number")&&(e={studyPlan:e}),typeof e=="object"&&!Array.isArray(e)&&"id"in e&&(e={studyPlan:e.id}),Array.isArray(e)&&(e={studyPlan:e[0]}),e=q(e);const a={studyPlan:typeof e.studyPlan=="object"?e.studyPlan.id:e.studyPlan};return w.definition.url.replace("{studyPlan}",a.studyPlan.toString()).replace(/\/+$/,"")+$(r)};w.put=(e,r)=>({url:w.url(e,r),method:"put"});const be=(e,r)=>({action:w.url(e,{[r?.mergeQuery?"mergeQuery":"query"]:{_method:"PUT",...r?.query??r?.mergeQuery??{}}}),method:"post"});be.put=(e,r)=>({action:w.url(e,{[r?.mergeQuery?"mergeQuery":"query"]:{_method:"PUT",...r?.query??r?.mergeQuery??{}}}),method:"post"});w.form=be;const E=(e,r)=>({url:E.url(e,r),method:"delete"});E.definition={methods:["delete"],url:"/study-plans/{studyPlan}"};E.url=(e,r)=>{(typeof e=="string"||typeof e=="number")&&(e={studyPlan:e}),typeof e=="object"&&!Array.isArray(e)&&"id"in e&&(e={studyPlan:e.id}),Array.isArray(e)&&(e={studyPlan:e[0]}),e=q(e);const a={studyPlan:typeof e.studyPlan=="object"?e.studyPlan.id:e.studyPlan};return E.definition.url.replace("{studyPlan}",a.studyPlan.toString()).replace(/\/+$/,"")+$(r)};E.delete=(e,r)=>({url:E.url(e,r),method:"delete"});const ge=(e,r)=>({action:E.url(e,{[r?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...r?.query??r?.mergeQuery??{}}}),method:"post"});ge.delete=(e,r)=>({action:E.url(e,{[r?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...r?.query??r?.mergeQuery??{}}}),method:"post"});E.form=ge;const P=(e,r)=>({url:P.url(e,r),method:"post"});P.definition={methods:["post"],url:"/study-plans/{studyPlan}/activities"};P.url=(e,r)=>{(typeof e=="string"||typeof e=="number")&&(e={studyPlan:e}),typeof e=="object"&&!Array.isArray(e)&&"id"in e&&(e={studyPlan:e.id}),Array.isArray(e)&&(e={studyPlan:e[0]}),e=q(e);const a={studyPlan:typeof e.studyPlan=="object"?e.studyPlan.id:e.studyPlan};return P.definition.url.replace("{studyPlan}",a.studyPlan.toString()).replace(/\/+$/,"")+$(r)};P.post=(e,r)=>({url:P.url(e,r),method:"post"});const Ne=(e,r)=>({action:P.url(e,r),method:"post"});Ne.post=(e,r)=>({action:P.url(e,r),method:"post"});P.form=Ne;const S=(e,r)=>({url:S.url(e,r),method:"put"});S.definition={methods:["put"],url:"/activities/{activity}"};S.url=(e,r)=>{(typeof e=="string"||typeof e=="number")&&(e={activity:e}),typeof e=="object"&&!Array.isArray(e)&&"id"in e&&(e={activity:e.id}),Array.isArray(e)&&(e={activity:e[0]}),e=q(e);const a={activity:typeof e.activity=="object"?e.activity.id:e.activity};return S.definition.url.replace("{activity}",a.activity.toString()).replace(/\/+$/,"")+$(r)};S.put=(e,r)=>({url:S.url(e,r),method:"put"});const Ae=(e,r)=>({action:S.url(e,{[r?.mergeQuery?"mergeQuery":"query"]:{_method:"PUT",...r?.query??r?.mergeQuery??{}}}),method:"post"});Ae.put=(e,r)=>({action:S.url(e,{[r?.mergeQuery?"mergeQuery":"query"]:{_method:"PUT",...r?.query??r?.mergeQuery??{}}}),method:"post"});S.form=Ae;const _=(e,r)=>({url:_.url(e,r),method:"delete"});_.definition={methods:["delete"],url:"/activities/{activity}"};_.url=(e,r)=>{(typeof e=="string"||typeof e=="number")&&(e={activity:e}),typeof e=="object"&&!Array.isArray(e)&&"id"in e&&(e={activity:e.id}),Array.isArray(e)&&(e={activity:e[0]}),e=q(e);const a={activity:typeof e.activity=="object"?e.activity.id:e.activity};return _.definition.url.replace("{activity}",a.activity.toString()).replace(/\/+$/,"")+$(r)};_.delete=(e,r)=>({url:_.url(e,r),method:"delete"});const ke=(e,r)=>({action:_.url(e,{[r?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...r?.query??r?.mergeQuery??{}}}),method:"post"});ke.delete=(e,r)=>({action:_.url(e,{[r?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...r?.query??r?.mergeQuery??{}}}),method:"post"});_.form=ke;const D=(e,r)=>({url:D.url(e,r),method:"post"});D.definition={methods:["post"],url:"/activities/{activity}/criteria"};D.url=(e,r)=>{(typeof e=="string"||typeof e=="number")&&(e={activity:e}),typeof e=="object"&&!Array.isArray(e)&&"id"in e&&(e={activity:e.id}),Array.isArray(e)&&(e={activity:e[0]}),e=q(e);const a={activity:typeof e.activity=="object"?e.activity.id:e.activity};return D.definition.url.replace("{activity}",a.activity.toString()).replace(/\/+$/,"")+$(r)};D.post=(e,r)=>({url:D.url(e,r),method:"post"});const Ce=(e,r)=>({action:D.url(e,r),method:"post"});Ce.post=(e,r)=>({action:D.url(e,r),method:"post"});D.form=Ce;const T=(e,r)=>({url:T.url(e,r),method:"post"});T.definition={methods:["post"],url:"/programas_academicos/{program}/criteria/set-ten-points"};T.url=(e,r)=>{(typeof e=="string"||typeof e=="number")&&(e={program:e}),typeof e=="object"&&!Array.isArray(e)&&"id"in e&&(e={program:e.id}),Array.isArray(e)&&(e={program:e[0]}),e=q(e);const a={program:typeof e.program=="object"?e.program.id:e.program};return T.definition.url.replace("{program}",a.program.toString()).replace(/\/+$/,"")+$(r)};T.post=(e,r)=>({url:T.url(e,r),method:"post"});const we=(e,r)=>({action:T.url(e,r),method:"post"});we.post=(e,r)=>({action:T.url(e,r),method:"post"});T.form=we;const F=(e,r)=>({url:F.url(e,r),method:"put"});F.definition={methods:["put"],url:"/criteria/{criteria}"};F.url=(e,r)=>{(typeof e=="string"||typeof e=="number")&&(e={criteria:e}),typeof e=="object"&&!Array.isArray(e)&&"id"in e&&(e={criteria:e.id}),Array.isArray(e)&&(e={criteria:e[0]}),e=q(e);const a={criteria:typeof e.criteria=="object"?e.criteria.id:e.criteria};return F.definition.url.replace("{criteria}",a.criteria.toString()).replace(/\/+$/,"")+$(r)};F.put=(e,r)=>({url:F.url(e,r),method:"put"});const Ee=(e,r)=>({action:F.url(e,{[r?.mergeQuery?"mergeQuery":"query"]:{_method:"PUT",...r?.query??r?.mergeQuery??{}}}),method:"post"});Ee.put=(e,r)=>({action:F.url(e,{[r?.mergeQuery?"mergeQuery":"query"]:{_method:"PUT",...r?.query??r?.mergeQuery??{}}}),method:"post"});F.form=Ee;const Q=(e,r)=>({url:Q.url(e,r),method:"delete"});Q.definition={methods:["delete"],url:"/criteria/{criteria}"};Q.url=(e,r)=>{(typeof e=="string"||typeof e=="number")&&(e={criteria:e}),typeof e=="object"&&!Array.isArray(e)&&"id"in e&&(e={criteria:e.id}),Array.isArray(e)&&(e={criteria:e[0]}),e=q(e);const a={criteria:typeof e.criteria=="object"?e.criteria.id:e.criteria};return Q.definition.url.replace("{criteria}",a.criteria.toString()).replace(/\/+$/,"")+$(r)};Q.delete=(e,r)=>({url:Q.url(e,r),method:"delete"});const Pe=(e,r)=>({action:Q.url(e,{[r?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...r?.query??r?.mergeQuery??{}}}),method:"post"});Pe.delete=(e,r)=>({action:Q.url(e,{[r?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...r?.query??r?.mergeQuery??{}}}),method:"post"});Q.form=Pe;const I={store:C,update:w,destroy:E,storeActivity:P,updateActivity:S,destroyActivity:_,storeCriteria:D,setAllCriteriaToTenPoints:T,updateCriteria:F,destroyCriteria:Q};function He({open:e,onOpenChange:r,programId:a,studyPlan:s}){const j=!!s,{data:y,setData:x,post:n,put:f,processing:v,errors:d,reset:c}=ie({module_name:s?.module_name||"",description:s?.description||"",hours:s?.hours||1,level:s?.level||1});k.useEffect(()=>{s?x({module_name:s.module_name,description:s.description||"",hours:s.hours,level:s.level}):c()},[s,e]);const b=m=>{m.preventDefault(),j?f(I.update({studyPlan:s.id}).url,{preserveScroll:!0,onSuccess:()=>{r(!1),c()}}):n(I.store({program:a}).url,{preserveScroll:!0,onSuccess:()=>{r(!1),c()}})};return t.jsx(ae,{open:e,onOpenChange:r,children:t.jsx(de,{className:"sm:max-w-[500px]",children:t.jsxs("form",{onSubmit:b,children:[t.jsxs(le,{children:[t.jsx(oe,{children:j?"Editar Módulo":"Agregar Módulo"}),t.jsx(ne,{children:j?"Actualiza la información del módulo del plan de estudios.":"Agrega un nuevo módulo al plan de estudios del programa."})]}),t.jsxs("div",{className:"grid gap-4 py-4",children:[t.jsxs("div",{className:"grid gap-2",children:[t.jsx(g,{htmlFor:"module_name",children:"Nombre del Módulo *"}),t.jsx(W,{id:"module_name",value:y.module_name,onChange:m=>x("module_name",m.target.value),placeholder:"Ej: Introducción a la Programación",className:d.module_name?"border-red-500":""}),d.module_name&&t.jsx("p",{className:"text-sm text-red-600",children:d.module_name})]}),t.jsxs("div",{className:"grid gap-2",children:[t.jsx(g,{htmlFor:"description",children:"Descripción"}),t.jsx(me,{id:"description",value:y.description,onChange:m=>x("description",m.target.value),placeholder:"Describe el contenido y objetivos del módulo",rows:3,className:d.description?"border-red-500":""}),d.description&&t.jsx("p",{className:"text-sm text-red-600",children:d.description})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"grid gap-2",children:[t.jsx(g,{htmlFor:"hours",children:"Horas *"}),t.jsx(W,{id:"hours",type:"number",min:"1",value:y.hours,onChange:m=>x("hours",parseInt(m.target.value)||1),className:d.hours?"border-red-500":""}),d.hours&&t.jsx("p",{className:"text-sm text-red-600",children:d.hours})]}),t.jsxs("div",{className:"grid gap-2",children:[t.jsx(g,{htmlFor:"level",children:"Nivel *"}),t.jsx(W,{id:"level",type:"number",min:"1",value:y.level,onChange:m=>x("level",parseInt(m.target.value)||1),className:d.level?"border-red-500":""}),d.level&&t.jsx("p",{className:"text-sm text-red-600",children:d.level})]})]})]}),t.jsxs(ce,{children:[t.jsx(u,{type:"button",variant:"outline",onClick:()=>r(!1),disabled:v,children:"Cancelar"}),t.jsx(u,{type:"submit",disabled:v,children:v?"Guardando...":j?"Actualizar":"Crear"})]})]})})})}function Ue({open:e,onOpenChange:r,studyPlanId:a,activity:s,nextOrder:j=0,currentTotalWeight:y=0}){const x=!!s,n=Number(y)||0,f=Math.max(0,100-n),{data:v,setData:d,post:c,put:b,processing:m,errors:l,reset:L}=ie({name:s?.name||"",description:s?.description||"",order:s?.order??j,weight:s?.weight||0,status:s?.status||"active"});k.useEffect(()=>{s?d({name:s.name,description:s.description||"",order:s.order,weight:s.weight,status:s.status}):(L(),d("order",j))},[s,e,j]);const H=h=>{h.preventDefault(),x?b(I.updateActivity({activity:s.id}).url,{preserveScroll:!0,onSuccess:()=>{r(!1),L()}}):c(I.storeActivity({studyPlan:a}).url,{preserveScroll:!0,onSuccess:()=>{r(!1),L()}})};return t.jsx(ae,{open:e,onOpenChange:r,children:t.jsx(de,{className:"sm:max-w-[500px]",children:t.jsxs("form",{onSubmit:H,children:[t.jsxs(le,{children:[t.jsx(oe,{children:x?"Editar Actividad":"Agregar Actividad"}),t.jsx(ne,{children:x?"Actualiza la información de la actividad.":"Agrega una nueva actividad al módulo del plan de estudios."})]}),(()=>{const h=Number(v.weight)||0,M=n+h,z=M===100,N=M>100;return t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:`rounded-lg border p-3 ${z?"border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-950/30":N?"border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-950/30":"border-amber-200 dark:border-amber-800 bg-amber-50 dark:bg-amber-950/30"}`,children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{className:"flex items-center gap-2",children:[z?t.jsx(re,{className:"h-4 w-4 text-green-600"}):N?t.jsx(se,{className:"h-4 w-4 text-red-600"}):t.jsx(ue,{className:"h-4 w-4 text-amber-600"}),t.jsx("span",{className:`text-sm font-medium ${z?"text-green-800 dark:text-green-200":N?"text-red-800 dark:text-red-200":"text-amber-800 dark:text-amber-200"}`,children:"Estado del módulo"})]})}),t.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-2 text-center text-xs",children:[t.jsxs("div",{className:"rounded bg-white/60 p-2",children:[t.jsxs("div",{className:"font-semibold text-muted-foreground",children:[n.toFixed(1),"%"]}),t.jsx("div",{className:"text-muted-foreground",children:"Asignado"})]}),t.jsxs("div",{className:"rounded bg-white/60 p-2",children:[t.jsxs("div",{className:`font-semibold ${f>0?"text-amber-700 dark:text-amber-300":"text-green-700 dark:text-green-300"}`,children:[f.toFixed(1),"%"]}),t.jsx("div",{className:"text-muted-foreground",children:"Disponible"})]}),t.jsxs("div",{className:"rounded bg-white/60 p-2",children:[t.jsxs("div",{className:`font-semibold ${z?"text-green-700 dark:text-green-300":N?"text-red-700 dark:text-red-300":"text-muted-foreground"}`,children:[M.toFixed(1),"%"]}),t.jsx("div",{className:"text-muted-foreground",children:"Proyectado"})]})]}),t.jsx("div",{className:"mt-2 h-2 w-full overflow-hidden rounded-full bg-muted",children:t.jsxs("div",{className:"flex h-full",children:[t.jsx("div",{className:"bg-blue-400 transition-all duration-300",style:{width:`${Math.min(n,100)}%`}}),t.jsx("div",{className:`transition-all duration-300 ${N?"bg-red-500":"bg-green-500"}`,style:{width:`${Math.min(h,100-Math.min(n,100))}%`}})]})}),t.jsxs("div",{className:"mt-1 flex justify-between text-xs text-muted-foreground",children:[t.jsxs("span",{children:["Otras actividades: ",n.toFixed(1),"%"]}),t.jsxs("span",{children:["Esta actividad: ",h,"%"]})]})]}),N&&t.jsxs(Z,{className:"border-red-300 dark:border-red-700 bg-red-50 dark:bg-red-950/30",children:[t.jsx(se,{className:"h-4 w-4 text-red-600"}),t.jsxs(ee,{className:"text-red-700 dark:text-red-300 text-xs",children:["La suma total (",M.toFixed(1),"%) excede el 100%. Reduce el peso a máximo ",t.jsxs("strong",{children:[f.toFixed(1),"%"]}),"."]})]}),z&&t.jsxs(Z,{className:"border-green-300 dark:border-green-700 bg-green-50 dark:bg-green-950/30",children:[t.jsx(re,{className:"h-4 w-4 text-green-600"}),t.jsx(ee,{className:"text-green-700 dark:text-green-300 text-xs",children:"¡Perfecto! La suma total es exactamente 100%."})]})]})})(),t.jsxs("div",{className:"grid gap-4 py-4",children:[t.jsxs("div",{className:"grid gap-2",children:[t.jsx(g,{htmlFor:"name",children:"Nombre de la Actividad *"}),t.jsx(W,{id:"name",value:v.name,onChange:h=>d("name",h.target.value),placeholder:"Ej: Proyecto Final",className:l.name?"border-red-500":""}),l.name&&t.jsx("p",{className:"text-sm text-red-600",children:l.name})]}),t.jsxs("div",{className:"grid gap-2",children:[t.jsx(g,{htmlFor:"description",children:"Descripción"}),t.jsx(me,{id:"description",value:v.description,onChange:h=>d("description",h.target.value),placeholder:"Describe la actividad y sus objetivos",rows:3,className:l.description?"border-red-500":""}),l.description&&t.jsx("p",{className:"text-sm text-red-600",children:l.description})]}),t.jsx("div",{className:"grid gap-4",children:t.jsxs("div",{className:"grid gap-2",children:[t.jsx(g,{htmlFor:"weight",children:"Peso (%) *"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(W,{id:"weight",type:"number",min:"0",max:"100",step:"0.01",value:v.weight,onChange:h=>d("weight",parseFloat(h.target.value)||0),className:`flex-1 ${l.weight?"border-red-500":""}`}),f>0&&t.jsxs(u,{type:"button",variant:"outline",size:"sm",className:"shrink-0 text-xs",onClick:()=>d("weight",Math.round(f*100)/100),title:`Usar peso restante: ${f.toFixed(1)}%`,children:[t.jsx(ve,{className:"mr-1 h-3 w-3"}),f.toFixed(1),"%"]})]}),l.weight&&t.jsx("p",{className:"text-sm text-red-600",children:l.weight}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:["% de la nota final del módulo",f>0&&v.weight===0&&t.jsx("span",{className:"ml-1 text-amber-600",children:"(Haz clic en el botón para usar el restante)"})]})]})}),t.jsxs("div",{className:"grid gap-2",children:[t.jsx(g,{htmlFor:"status",children:"Estado *"}),t.jsxs("select",{id:"status",value:v.status,onChange:h=>d("status",h.target.value),className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm text-foreground ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[t.jsx("option",{value:"active",children:"Activa"}),t.jsx("option",{value:"inactive",children:"Inactiva"})]}),l.status&&t.jsx("p",{className:"text-sm text-red-600",children:l.status})]})]}),t.jsxs(ce,{children:[t.jsx(u,{type:"button",variant:"outline",onClick:()=>r(!1),disabled:m,children:"Cancelar"}),t.jsx(u,{type:"submit",disabled:m,children:m?"Guardando...":x?"Actualizar":"Crear"})]})]})})})}function Be({open:e,onOpenChange:r,activityId:a,criteria:s,nextOrder:j=0}){const y=!!s,{data:x,setData:n,post:f,put:v,processing:d,errors:c,reset:b}=ie({name:s?.name||"",description:s?.description||"",max_points:s?.max_points||10,order:s?.order??j});k.useEffect(()=>{s?n({name:s.name,description:s.description||"",max_points:s.max_points,order:s.order}):(b(),n("order",j))},[s,e,j]);const m=l=>{l.preventDefault(),y?v(I.updateCriteria({criteria:s.id}).url,{preserveScroll:!0,onSuccess:()=>{r(!1),b()}}):f(I.storeCriteria({activity:a}).url,{preserveScroll:!0,onSuccess:()=>{r(!1),b()}})};return t.jsx(ae,{open:e,onOpenChange:r,children:t.jsx(de,{className:"sm:max-w-[500px]",children:t.jsxs("form",{onSubmit:m,children:[t.jsxs(le,{children:[t.jsx(oe,{children:y?"Editar Criterio de Evaluación":"Agregar Criterio de Evaluación"}),t.jsx(ne,{children:y?"Actualiza la información del criterio de evaluación.":"Agrega un nuevo criterio de evaluación a la actividad."})]}),t.jsxs(Z,{className:"border-amber-200 dark:border-amber-800 bg-amber-50 dark:bg-amber-950/30",children:[t.jsx(ue,{className:"h-4 w-4 text-amber-600"}),t.jsx(je,{className:"text-amber-800 dark:text-amber-200",children:"Sistema de Puntos"}),t.jsx(ee,{className:"text-amber-700 dark:text-amber-300",children:t.jsxs("ul",{className:"mt-1 list-disc space-y-1 pl-4 text-xs",children:[t.jsxs("li",{children:[t.jsx("strong",{children:"Puntuación Máxima:"})," Es el número máximo de puntos que un estudiante puede obtener en este criterio."]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Cálculo de nota:"})," La nota del criterio se calcula como: (puntos obtenidos / puntuación máxima) × 100."]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Ejemplo:"})," Si el máximo es 10 pts y el estudiante obtiene 8 pts, su nota en este criterio será 80%."]})]})})]}),t.jsxs("div",{className:"grid gap-4 py-4",children:[t.jsxs("div",{className:"grid gap-2",children:[t.jsx(g,{htmlFor:"name",children:"Nombre del Criterio *"}),t.jsx(W,{id:"name",value:x.name,onChange:l=>n("name",l.target.value),placeholder:"Ej: Calidad del código",className:c.name?"border-red-500":""}),c.name&&t.jsx("p",{className:"text-sm text-red-600",children:c.name})]}),t.jsxs("div",{className:"grid gap-2",children:[t.jsx(g,{htmlFor:"description",children:"Descripción"}),t.jsx(me,{id:"description",value:x.description,onChange:l=>n("description",l.target.value),placeholder:"Describe qué se evaluará en este criterio",rows:3,className:c.description?"border-red-500":""}),c.description&&t.jsx("p",{className:"text-sm text-red-600",children:c.description})]}),t.jsxs("div",{className:"grid gap-2",children:[t.jsx(g,{htmlFor:"max_points",children:"Puntuación Máxima *"}),t.jsx(W,{id:"max_points",type:"number",min:"0",step:"0.01",value:x.max_points,onChange:l=>n("max_points",parseFloat(l.target.value)||0),className:c.max_points?"border-red-500":""}),c.max_points&&t.jsx("p",{className:"text-sm text-red-600",children:c.max_points}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Puntos máximos a obtener"})]})]}),t.jsxs(ce,{children:[t.jsx(u,{type:"button",variant:"outline",onClick:()=>r(!1),disabled:d,children:"Cancelar"}),t.jsx(u,{type:"submit",disabled:d,children:d?"Guardando...":y?"Actualizar":"Crear"})]})]})})})}function Qt({program:e,studyPlans:r}){const{auth:a}=Qe().props,s=a?.permissions??[],j=i=>s.includes(i),[y,x]=k.useState({open:!1}),[n,f]=k.useState({open:!1}),v=(i,A)=>i.filter(o=>o.id!==A).reduce((o,p)=>o+(Number(p.weight)||0),0),d=i=>{const A=Number(i)||0;return A===100?{status:"complete",color:"green",message:"Completo"}:A>100?{status:"over",color:"red",message:`Excede por ${(A-100).toFixed(1)}%`}:{status:"incomplete",color:"amber",message:`Faltan ${(100-A).toFixed(1)}%`}},[c,b]=k.useState({open:!1}),[m,l]=k.useState({open:!1}),[L,H]=k.useState({open:!1}),[h,M]=k.useState({open:!1}),[z,N]=k.useState(!1),Se=()=>{m.studyPlan&&B.delete(I.destroy(m.studyPlan.id).url,{preserveScroll:!0,onSuccess:()=>l({open:!1})})},_e=()=>{L.activity&&B.delete(I.destroyActivity(L.activity.id).url,{preserveScroll:!0,onSuccess:()=>H({open:!1})})},De=()=>{h.criteria&&B.delete(I.destroyCriteria(h.criteria.id).url,{preserveScroll:!0,onSuccess:()=>M({open:!1})})},Te=()=>{B.post(`/programas_academicos/${e.id}/criteria/set-ten-points`,{},{preserveScroll:!0,onSuccess:()=>N(!1)})},Fe=r.some(i=>i.activities.some(A=>A.evaluation_criteria.length>0));return t.jsxs($e,{children:[t.jsx(qe,{title:`${e.name} - Plan de Estudios`}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsxs(xe,{href:pe.index().url,className:"mb-3 inline-flex items-center text-sm text-muted-foreground hover:text-foreground",children:[t.jsx(Ie,{className:"mr-1 h-4 w-4"}),"Volver a programas"]}),t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-foreground",children:e.name}),e.description&&t.jsx("p",{className:"mt-2 text-muted-foreground",children:e.description}),t.jsxs("div",{className:"mt-3 flex items-center gap-4 text-sm text-muted-foreground",children:[t.jsxs("span",{children:[e.duration_months," meses"]}),t.jsx("span",{children:"•"}),t.jsx("span",{className:`rounded-full px-2.5 py-0.5 text-xs font-medium ${e.status==="active"?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400":"bg-muted text-muted-foreground"}`,children:e.status==="active"?"Activo":"Inactivo"})]})]}),t.jsx(xe,{href:pe.edit({program:e.id}).url,children:t.jsx(u,{variant:"outline",children:"Editar Programa"})})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Plan de Estudios"}),t.jsxs("div",{className:"flex items-center gap-2",children:[Fe&&j("editar_criterio_evaluacion")&&t.jsxs(u,{variant:"outline",onClick:()=>N(!0),children:[t.jsx(ve,{className:"mr-2 h-4 w-4"}),"Todos los criterios a 10 pts"]}),t.jsxs(u,{onClick:()=>x({open:!0}),children:[t.jsx(U,{className:"mr-2 h-4 w-4"}),"Agregar Módulo"]})]})]}),t.jsxs(Z,{className:"border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-950/30",children:[t.jsx(ue,{className:"h-4 w-4 text-blue-600"}),t.jsx(je,{className:"text-blue-800 dark:text-blue-200",children:"Sistema de Evaluación: Puntos y Porcentajes"}),t.jsx(ee,{className:"text-blue-700 dark:text-blue-300",children:t.jsxs("div",{className:"mt-2 grid gap-3 text-sm md:grid-cols-2",children:[t.jsxs("div",{className:"rounded-md bg-white/60 p-3",children:[t.jsx("strong",{className:"text-blue-900 dark:text-blue-100",children:"Peso de Actividades (%):"}),t.jsxs("ul",{className:"mt-1 list-disc pl-4 text-xs",children:[t.jsx("li",{children:"Cada actividad tiene un peso porcentual dentro del módulo"}),t.jsxs("li",{children:["La suma de todos los pesos debe ser ",t.jsx("strong",{children:"100%"})]}),t.jsx("li",{children:"Ejemplo: Tarea 30% + Examen 40% + Proyecto 30% = 100%"})]})]}),t.jsxs("div",{className:"rounded-md bg-white/60 p-3",children:[t.jsx("strong",{className:"text-blue-900 dark:text-blue-100",children:"Puntos de Criterios:"}),t.jsxs("ul",{className:"mt-1 list-disc pl-4 text-xs",children:[t.jsx("li",{children:"Cada criterio tiene una puntuación máxima (ej: 10 pts)"}),t.jsx("li",{children:"El estudiante recibe puntos según su desempeño"}),t.jsx("li",{children:"La nota se calcula: (obtenidos / máximo) × peso de actividad"})]})]})]})})]}),r.length>0?t.jsx("div",{className:"space-y-4",children:r.map((i,A)=>t.jsxs("div",{className:"rounded-xl border border-border bg-card p-6 shadow-sm",children:[t.jsxs("div",{className:"mb-4 flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-blue-100 dark:bg-blue-900/30",children:t.jsx(he,{className:"h-5 w-5 text-blue-600"})}),t.jsxs("div",{children:[t.jsxs("h3",{className:"text-lg font-semibold text-foreground",children:["Módulo ",A+1,": ",i.module_name]}),i.description&&t.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:i.description}),t.jsxs("div",{className:"mt-2 flex items-center gap-4 text-sm text-muted-foreground",children:[t.jsxs("span",{children:[i.hours," horas"]}),t.jsx("span",{children:"•"}),t.jsxs("span",{children:["Nivel ",i.level]})]})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(u,{variant:"outline",size:"sm",onClick:()=>x({open:!0,studyPlan:i}),children:"Editar"}),t.jsx(u,{variant:"outline",size:"sm",onClick:()=>f({open:!0,studyPlanId:i.id,nextOrder:i.activities.length,currentTotalWeight:v(i.activities)}),children:t.jsx(U,{className:"h-4 w-4"})}),j("eliminar_plan_estudio")&&t.jsx(u,{variant:"outline",size:"sm",className:"text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 hover:text-red-700 dark:hover:text-red-300",onClick:()=>l({open:!0,studyPlan:i}),children:t.jsx(te,{className:"h-4 w-4"})})]})]}),i.activities.length>0?t.jsxs("div",{className:"ml-14 space-y-3",children:[(()=>{const o=Number(v(i.activities))||0,p=d(o);return t.jsxs("div",{className:"rounded-lg border border-border bg-muted p-3",children:[t.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[t.jsx("h4",{className:"text-sm font-semibold text-muted-foreground",children:"Actividades:"}),t.jsxs("div",{className:"flex items-center gap-2",children:[p.status==="complete"?t.jsx(re,{className:"h-4 w-4 text-green-600"}):t.jsx(se,{className:`h-4 w-4 ${p.status==="over"?"text-red-600":"text-amber-600"}`}),t.jsxs("span",{className:`text-sm font-medium ${p.status==="complete"?"text-green-700 dark:text-green-300":p.status==="over"?"text-red-700 dark:text-red-300":"text-amber-700 dark:text-amber-300"}`,children:[o.toFixed(1),"% de 100% — ",p.message]})]})]}),t.jsx("div",{className:"h-2 w-full overflow-hidden rounded-full bg-muted",children:t.jsx("div",{className:`h-full transition-all duration-300 ${p.status==="complete"?"bg-green-500":p.status==="over"?"bg-red-500":"bg-amber-500"}`,style:{width:`${Math.min(o,100)}%`}})}),p.status!=="complete"&&t.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:p.status==="over"?"La suma de pesos excede el 100%. Ajusta los pesos de las actividades.":"La suma de pesos debe ser exactamente 100% para que las calificaciones se calculen correctamente."})]})})(),i.activities.map(o=>t.jsxs("div",{className:"rounded-lg border border-border bg-muted p-4",children:[t.jsxs("div",{className:"mb-3 flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-md bg-purple-100 dark:bg-purple-900/30",children:t.jsx(Le,{className:"h-4 w-4 text-purple-600"})}),t.jsxs("div",{children:[t.jsx("h5",{className:"font-medium text-foreground",children:o.name}),o.description&&t.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:o.description}),t.jsxs("div",{className:"mt-1 flex items-center gap-3 text-xs text-muted-foreground",children:[t.jsxs("span",{children:["Peso: ",o.weight,"%"]}),t.jsx("span",{children:"•"}),t.jsx("span",{className:`rounded-full px-2 py-0.5 ${o.status==="active"?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400":"bg-muted text-muted-foreground"}`,children:o.status==="active"?"Activa":"Inactiva"})]})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(u,{variant:"ghost",size:"sm",onClick:()=>f({open:!0,studyPlanId:i.id,activity:o,currentTotalWeight:v(i.activities,o.id)}),children:"Editar"}),t.jsx(u,{variant:"ghost",size:"sm",onClick:()=>b({open:!0,activityId:o.id,nextOrder:o.evaluation_criteria.length}),children:t.jsx(U,{className:"h-4 w-4"})}),j("eliminar_actividad")&&t.jsx(u,{variant:"ghost",size:"sm",className:"text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 hover:text-red-700 dark:hover:text-red-300",onClick:()=>H({open:!0,activity:o}),children:t.jsx(te,{className:"h-4 w-4"})})]})]}),o.evaluation_criteria.length>0&&t.jsxs("div",{className:"ml-11 space-y-2",children:[t.jsx("h6",{className:"text-xs font-semibold text-muted-foreground",children:"Criterios de Evaluación:"}),o.evaluation_criteria.map(p=>t.jsxs("div",{className:"flex items-center justify-between rounded-md border border-border bg-card p-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Me,{className:"h-4 w-4 text-amber-600"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-foreground",children:p.name}),p.description&&t.jsx("p",{className:"text-xs text-muted-foreground",children:p.description})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("span",{className:"text-sm font-medium text-muted-foreground",children:[p.max_points," pts"]}),t.jsx(u,{variant:"ghost",size:"sm",onClick:()=>b({open:!0,activityId:o.id,criteria:p}),children:"Editar"}),j("eliminar_criterio_evaluacion")&&t.jsx(u,{variant:"ghost",size:"sm",className:"text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 hover:text-red-700 dark:hover:text-red-300",onClick:()=>M({open:!0,criteria:p}),children:t.jsx(te,{className:"h-4 w-4"})})]})]},p.id))]})]},o.id))]}):t.jsxs("div",{className:"ml-14 rounded-lg border-2 border-dashed border-border bg-muted p-6 text-center",children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"No hay actividades en este módulo"}),t.jsxs(u,{variant:"outline",size:"sm",className:"mt-3",onClick:()=>f({open:!0,studyPlanId:i.id,nextOrder:0,currentTotalWeight:0}),children:[t.jsx(U,{className:"mr-2 h-4 w-4"}),"Agregar Primera Actividad"]})]})]},i.id))}):t.jsxs("div",{className:"rounded-xl border-2 border-dashed border-border bg-card p-12 text-center",children:[t.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-muted",children:t.jsx(he,{className:"h-8 w-8 text-muted-foreground"})}),t.jsx("h3",{className:"mb-2 text-xl font-semibold text-foreground",children:"No hay módulos en este programa"}),t.jsx("p",{className:"mb-6 text-muted-foreground",children:"Comienza agregando el primer módulo al plan de estudios"}),t.jsxs(u,{onClick:()=>x({open:!0}),children:[t.jsx(U,{className:"mr-2 h-5 w-5"}),"Agregar Primer Módulo"]})]})]})]}),t.jsx(He,{open:y.open,onOpenChange:i=>x({open:i,studyPlan:void 0}),programId:e.id,studyPlan:y.studyPlan}),n.studyPlanId&&t.jsx(Ue,{open:n.open,onOpenChange:i=>f({open:i,studyPlanId:void 0,activity:void 0,currentTotalWeight:void 0}),studyPlanId:n.studyPlanId,activity:n.activity,nextOrder:n.nextOrder,currentTotalWeight:n.currentTotalWeight}),c.activityId&&t.jsx(Be,{open:c.open,onOpenChange:i=>b({open:i,activityId:void 0,criteria:void 0}),activityId:c.activityId,criteria:c.criteria,nextOrder:c.nextOrder}),t.jsx(G,{open:m.open,onOpenChange:i=>l({open:i,studyPlan:void 0}),children:t.jsxs(O,{children:[t.jsxs(R,{children:[t.jsx(V,{children:"Eliminar Módulo"}),t.jsxs(J,{children:['¿Estás seguro de que deseas eliminar el módulo "',m.studyPlan?.module_name,'"? Esta acción eliminará también todas las actividades y criterios de evaluación asociados. Esta acción no se puede deshacer.']})]}),t.jsxs(K,{children:[t.jsx(X,{children:"Cancelar"}),t.jsx(Y,{onClick:Se,className:"bg-red-600 hover:bg-red-700",children:"Eliminar"})]})]})}),t.jsx(G,{open:L.open,onOpenChange:i=>H({open:i,activity:void 0}),children:t.jsxs(O,{children:[t.jsxs(R,{children:[t.jsx(V,{children:"Eliminar Actividad"}),t.jsxs(J,{children:['¿Estás seguro de que deseas eliminar la actividad "',L.activity?.name,'"? Esta acción eliminará también todos los criterios de evaluación asociados. Esta acción no se puede deshacer.']})]}),t.jsxs(K,{children:[t.jsx(X,{children:"Cancelar"}),t.jsx(Y,{onClick:_e,className:"bg-red-600 hover:bg-red-700",children:"Eliminar"})]})]})}),t.jsx(G,{open:h.open,onOpenChange:i=>M({open:i,criteria:void 0}),children:t.jsxs(O,{children:[t.jsxs(R,{children:[t.jsx(V,{children:"Eliminar Criterio de Evaluación"}),t.jsxs(J,{children:['¿Estás seguro de que deseas eliminar el criterio "',h.criteria?.name,'"? Esta acción no se puede deshacer.']})]}),t.jsxs(K,{children:[t.jsx(X,{children:"Cancelar"}),t.jsx(Y,{onClick:De,className:"bg-red-600 hover:bg-red-700",children:"Eliminar"})]})]})}),t.jsx(G,{open:z,onOpenChange:N,children:t.jsxs(O,{children:[t.jsxs(R,{children:[t.jsx(V,{children:"Establecer todos los criterios a 10 puntos"}),t.jsx(J,{children:"¿Estás seguro de que deseas cambiar la puntuación máxima de todos los criterios de evaluación de este programa a 10 puntos? Esta acción afectará a todos los módulos y actividades del programa."})]}),t.jsxs(K,{children:[t.jsx(X,{children:"Cancelar"}),t.jsx(Y,{onClick:Te,children:"Confirmar"})]})]})})]})}export{Qt as default};
