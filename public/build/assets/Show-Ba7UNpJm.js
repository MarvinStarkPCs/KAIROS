import{u as se,r as S,j as e,b as Ee,H as Pe,L as ue,a as G}from"./app-D720TaZI.js";import{B as h}from"./button-DTndidD-.js";import{A as U,a as B,b as pe}from"./alert-Cx5chaz6.js";import{p as xe}from"./program_academy-IHQIcmQm.js";import{a as Q,q}from"./wayfinder-Bf9OnZdi.js";import{A as _e}from"./app-layout-C4FSMOBz.js";import{D as ie,a as ae,b as de,c as le,d as oe,f as ne}from"./dialog-Bpm3u9Nd.js";import{I as z}from"./input-DZl8FfGZ.js";import{L as g}from"./label-DN54Xbnq.js";import{T as ce}from"./textarea-CguF6yEY.js";import{C as te}from"./circle-check-BtDJBn0b.js";import{T as re}from"./triangle-alert-BqeN2Smu.js";import{c as je}from"./createLucideIcon-DigUFbuC.js";import{A as O,b as R,c as V,d as J,e as K,f as X,g as Y,h as Z}from"./alert-dialog-CL97MrAS.js";import{A as De}from"./arrow-left-z1B-m-Mg.js";import{P as H}from"./plus-B4SJkf_G.js";import{B as he,L as Se}from"./list-checks-4enJSgAL.js";import{T as ee}from"./trash-2-BZcqulA4.js";import{A as Fe}from"./book-open-BpmjL7wC.js";/* empty css            */import"./utils-DmkSgyWg.js";import"./index-GLpayk7y.js";import"./index-D2YKrHzH.js";import"./index-BWfE0pDH.js";import"./index-DLllxVLY.js";import"./index-BLOBkqYP.js";import"./index-Dkc4isJQ.js";import"./app-header-vikwbJch.js";import"./chevron-right-Dk-laIOK.js";import"./index-C5M1fw6K.js";import"./index-CLa6oRL-.js";import"./index-D12nj1Ca.js";import"./graduation-cap-jnrT4xS4.js";import"./users-CA7DN7ey.js";import"./credit-card-DETocYyF.js";import"./calendar-BGhziAFb.js";import"./file-text-DYVWjvgD.js";import"./lock-C6Oi9uBw.js";import"./shield-FiGpr67-.js";import"./chevron-down-BCN9SoXG.js";import"./loader-circle-D86hfN0t.js";import"./mail-BBkbB-Pa.js";import"./toaster-CJPkqyoj.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],me=je("Info",Qe);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],Te=je("WandSparkles",qe),N=(t,r)=>({url:N.url(t,r),method:"post"});N.definition={methods:["post"],url:"/programas_academicos/{program}/study-plans"};N.url=(t,r)=>{(typeof t=="string"||typeof t=="number")&&(t={program:t}),typeof t=="object"&&!Array.isArray(t)&&"id"in t&&(t={program:t.id}),Array.isArray(t)&&(t={program:t[0]}),t=Q(t);const d={program:typeof t.program=="object"?t.program.id:t.program};return N.definition.url.replace("{program}",d.program.toString()).replace(/\/+$/,"")+q(r)};N.post=(t,r)=>({url:N.url(t,r),method:"post"});const fe=(t,r)=>({action:N.url(t,r),method:"post"});fe.post=(t,r)=>({action:N.url(t,r),method:"post"});N.form=fe;const A=(t,r)=>({url:A.url(t,r),method:"put"});A.definition={methods:["put"],url:"/study-plans/{studyPlan}"};A.url=(t,r)=>{(typeof t=="string"||typeof t=="number")&&(t={studyPlan:t}),typeof t=="object"&&!Array.isArray(t)&&"id"in t&&(t={studyPlan:t.id}),Array.isArray(t)&&(t={studyPlan:t[0]}),t=Q(t);const d={studyPlan:typeof t.studyPlan=="object"?t.studyPlan.id:t.studyPlan};return A.definition.url.replace("{studyPlan}",d.studyPlan.toString()).replace(/\/+$/,"")+q(r)};A.put=(t,r)=>({url:A.url(t,r),method:"put"});const ve=(t,r)=>({action:A.url(t,{[r?.mergeQuery?"mergeQuery":"query"]:{_method:"PUT",...r?.query??r?.mergeQuery??{}}}),method:"post"});ve.put=(t,r)=>({action:A.url(t,{[r?.mergeQuery?"mergeQuery":"query"]:{_method:"PUT",...r?.query??r?.mergeQuery??{}}}),method:"post"});A.form=ve;const k=(t,r)=>({url:k.url(t,r),method:"delete"});k.definition={methods:["delete"],url:"/study-plans/{studyPlan}"};k.url=(t,r)=>{(typeof t=="string"||typeof t=="number")&&(t={studyPlan:t}),typeof t=="object"&&!Array.isArray(t)&&"id"in t&&(t={studyPlan:t.id}),Array.isArray(t)&&(t={studyPlan:t[0]}),t=Q(t);const d={studyPlan:typeof t.studyPlan=="object"?t.studyPlan.id:t.studyPlan};return k.definition.url.replace("{studyPlan}",d.studyPlan.toString()).replace(/\/+$/,"")+q(r)};k.delete=(t,r)=>({url:k.url(t,r),method:"delete"});const ye=(t,r)=>({action:k.url(t,{[r?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...r?.query??r?.mergeQuery??{}}}),method:"post"});ye.delete=(t,r)=>({action:k.url(t,{[r?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...r?.query??r?.mergeQuery??{}}}),method:"post"});k.form=ye;const w=(t,r)=>({url:w.url(t,r),method:"post"});w.definition={methods:["post"],url:"/study-plans/{studyPlan}/activities"};w.url=(t,r)=>{(typeof t=="string"||typeof t=="number")&&(t={studyPlan:t}),typeof t=="object"&&!Array.isArray(t)&&"id"in t&&(t={studyPlan:t.id}),Array.isArray(t)&&(t={studyPlan:t[0]}),t=Q(t);const d={studyPlan:typeof t.studyPlan=="object"?t.studyPlan.id:t.studyPlan};return w.definition.url.replace("{studyPlan}",d.studyPlan.toString()).replace(/\/+$/,"")+q(r)};w.post=(t,r)=>({url:w.url(t,r),method:"post"});const be=(t,r)=>({action:w.url(t,r),method:"post"});be.post=(t,r)=>({action:w.url(t,r),method:"post"});w.form=be;const C=(t,r)=>({url:C.url(t,r),method:"put"});C.definition={methods:["put"],url:"/activities/{activity}"};C.url=(t,r)=>{(typeof t=="string"||typeof t=="number")&&(t={activity:t}),typeof t=="object"&&!Array.isArray(t)&&"id"in t&&(t={activity:t.id}),Array.isArray(t)&&(t={activity:t[0]}),t=Q(t);const d={activity:typeof t.activity=="object"?t.activity.id:t.activity};return C.definition.url.replace("{activity}",d.activity.toString()).replace(/\/+$/,"")+q(r)};C.put=(t,r)=>({url:C.url(t,r),method:"put"});const ge=(t,r)=>({action:C.url(t,{[r?.mergeQuery?"mergeQuery":"query"]:{_method:"PUT",...r?.query??r?.mergeQuery??{}}}),method:"post"});ge.put=(t,r)=>({action:C.url(t,{[r?.mergeQuery?"mergeQuery":"query"]:{_method:"PUT",...r?.query??r?.mergeQuery??{}}}),method:"post"});C.form=ge;const E=(t,r)=>({url:E.url(t,r),method:"delete"});E.definition={methods:["delete"],url:"/activities/{activity}"};E.url=(t,r)=>{(typeof t=="string"||typeof t=="number")&&(t={activity:t}),typeof t=="object"&&!Array.isArray(t)&&"id"in t&&(t={activity:t.id}),Array.isArray(t)&&(t={activity:t[0]}),t=Q(t);const d={activity:typeof t.activity=="object"?t.activity.id:t.activity};return E.definition.url.replace("{activity}",d.activity.toString()).replace(/\/+$/,"")+q(r)};E.delete=(t,r)=>({url:E.url(t,r),method:"delete"});const Ne=(t,r)=>({action:E.url(t,{[r?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...r?.query??r?.mergeQuery??{}}}),method:"post"});Ne.delete=(t,r)=>({action:E.url(t,{[r?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...r?.query??r?.mergeQuery??{}}}),method:"post"});E.form=Ne;const P=(t,r)=>({url:P.url(t,r),method:"post"});P.definition={methods:["post"],url:"/activities/{activity}/criteria"};P.url=(t,r)=>{(typeof t=="string"||typeof t=="number")&&(t={activity:t}),typeof t=="object"&&!Array.isArray(t)&&"id"in t&&(t={activity:t.id}),Array.isArray(t)&&(t={activity:t[0]}),t=Q(t);const d={activity:typeof t.activity=="object"?t.activity.id:t.activity};return P.definition.url.replace("{activity}",d.activity.toString()).replace(/\/+$/,"")+q(r)};P.post=(t,r)=>({url:P.url(t,r),method:"post"});const Ae=(t,r)=>({action:P.url(t,r),method:"post"});Ae.post=(t,r)=>({action:P.url(t,r),method:"post"});P.form=Ae;const _=(t,r)=>({url:_.url(t,r),method:"put"});_.definition={methods:["put"],url:"/criteria/{criteria}"};_.url=(t,r)=>{(typeof t=="string"||typeof t=="number")&&(t={criteria:t}),typeof t=="object"&&!Array.isArray(t)&&"id"in t&&(t={criteria:t.id}),Array.isArray(t)&&(t={criteria:t[0]}),t=Q(t);const d={criteria:typeof t.criteria=="object"?t.criteria.id:t.criteria};return _.definition.url.replace("{criteria}",d.criteria.toString()).replace(/\/+$/,"")+q(r)};_.put=(t,r)=>({url:_.url(t,r),method:"put"});const ke=(t,r)=>({action:_.url(t,{[r?.mergeQuery?"mergeQuery":"query"]:{_method:"PUT",...r?.query??r?.mergeQuery??{}}}),method:"post"});ke.put=(t,r)=>({action:_.url(t,{[r?.mergeQuery?"mergeQuery":"query"]:{_method:"PUT",...r?.query??r?.mergeQuery??{}}}),method:"post"});_.form=ke;const D=(t,r)=>({url:D.url(t,r),method:"delete"});D.definition={methods:["delete"],url:"/criteria/{criteria}"};D.url=(t,r)=>{(typeof t=="string"||typeof t=="number")&&(t={criteria:t}),typeof t=="object"&&!Array.isArray(t)&&"id"in t&&(t={criteria:t.id}),Array.isArray(t)&&(t={criteria:t[0]}),t=Q(t);const d={criteria:typeof t.criteria=="object"?t.criteria.id:t.criteria};return D.definition.url.replace("{criteria}",d.criteria.toString()).replace(/\/+$/,"")+q(r)};D.delete=(t,r)=>({url:D.url(t,r),method:"delete"});const we=(t,r)=>({action:D.url(t,{[r?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...r?.query??r?.mergeQuery??{}}}),method:"post"});we.delete=(t,r)=>({action:D.url(t,{[r?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...r?.query??r?.mergeQuery??{}}}),method:"post"});D.form=we;const F={store:N,update:A,destroy:k,storeActivity:w,updateActivity:C,destroyActivity:E,storeCriteria:P,updateCriteria:_,destroyCriteria:D};function $e({open:t,onOpenChange:r,programId:d,studyPlan:s}){const f=!!s,{data:y,setData:u,post:n,put:j,processing:v,errors:a,reset:c}=se({module_name:s?.module_name||"",description:s?.description||"",hours:s?.hours||1,level:s?.level||1});S.useEffect(()=>{s?u({module_name:s.module_name,description:s.description||"",hours:s.hours,level:s.level}):c()},[s,t]);const b=m=>{m.preventDefault(),f?j(F.update({studyPlan:s.id}).url,{preserveScroll:!0,onSuccess:()=>{r(!1),c()}}):n(F.store({program:d}).url,{preserveScroll:!0,onSuccess:()=>{r(!1),c()}})};return e.jsx(ie,{open:t,onOpenChange:r,children:e.jsx(ae,{className:"sm:max-w-[500px]",children:e.jsxs("form",{onSubmit:b,children:[e.jsxs(de,{children:[e.jsx(le,{children:f?"Editar Módulo":"Agregar Módulo"}),e.jsx(oe,{children:f?"Actualiza la información del módulo del plan de estudios.":"Agrega un nuevo módulo al plan de estudios del programa."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"module_name",children:"Nombre del Módulo *"}),e.jsx(z,{id:"module_name",value:y.module_name,onChange:m=>u("module_name",m.target.value),placeholder:"Ej: Introducción a la Programación",className:a.module_name?"border-red-500":""}),a.module_name&&e.jsx("p",{className:"text-sm text-red-600",children:a.module_name})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"description",children:"Descripción"}),e.jsx(ce,{id:"description",value:y.description,onChange:m=>u("description",m.target.value),placeholder:"Describe el contenido y objetivos del módulo",rows:3,className:a.description?"border-red-500":""}),a.description&&e.jsx("p",{className:"text-sm text-red-600",children:a.description})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"hours",children:"Horas *"}),e.jsx(z,{id:"hours",type:"number",min:"1",value:y.hours,onChange:m=>u("hours",parseInt(m.target.value)||1),className:a.hours?"border-red-500":""}),a.hours&&e.jsx("p",{className:"text-sm text-red-600",children:a.hours})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"level",children:"Nivel *"}),e.jsx(z,{id:"level",type:"number",min:"1",value:y.level,onChange:m=>u("level",parseInt(m.target.value)||1),className:a.level?"border-red-500":""}),a.level&&e.jsx("p",{className:"text-sm text-red-600",children:a.level})]})]})]}),e.jsxs(ne,{children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>r(!1),disabled:v,children:"Cancelar"}),e.jsx(h,{type:"submit",disabled:v,children:v?"Guardando...":f?"Actualizar":"Crear"})]})]})})})}function Ie({open:t,onOpenChange:r,studyPlanId:d,activity:s,nextOrder:f=0,currentTotalWeight:y=0}){const u=!!s,n=Number(y)||0,j=Math.max(0,100-n),{data:v,setData:a,post:c,put:b,processing:m,errors:l,reset:T}=se({name:s?.name||"",description:s?.description||"",order:s?.order??f,weight:s?.weight||0,status:s?.status||"active"});S.useEffect(()=>{s?a({name:s.name,description:s.description||"",order:s.order,weight:s.weight,status:s.status}):(T(),a("order",f))},[s,t,f]);const W=p=>{p.preventDefault(),u?b(F.updateActivity({activity:s.id}).url,{preserveScroll:!0,onSuccess:()=>{r(!1),T()}}):c(F.storeActivity({studyPlan:d}).url,{preserveScroll:!0,onSuccess:()=>{r(!1),T()}})};return e.jsx(ie,{open:t,onOpenChange:r,children:e.jsx(ae,{className:"sm:max-w-[500px]",children:e.jsxs("form",{onSubmit:W,children:[e.jsxs(de,{children:[e.jsx(le,{children:u?"Editar Actividad":"Agregar Actividad"}),e.jsx(oe,{children:u?"Actualiza la información de la actividad.":"Agrega una nueva actividad al módulo del plan de estudios."})]}),(()=>{const p=Number(v.weight)||0,$=n+p,M=$===100,I=$>100;return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:`rounded-lg border p-3 ${M?"border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-950/30":I?"border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-950/30":"border-amber-200 dark:border-amber-800 bg-amber-50 dark:bg-amber-950/30"}`,children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[M?e.jsx(te,{className:"h-4 w-4 text-green-600"}):I?e.jsx(re,{className:"h-4 w-4 text-red-600"}):e.jsx(me,{className:"h-4 w-4 text-amber-600"}),e.jsx("span",{className:`text-sm font-medium ${M?"text-green-800 dark:text-green-200":I?"text-red-800 dark:text-red-200":"text-amber-800 dark:text-amber-200"}`,children:"Estado del módulo"})]})}),e.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-2 text-center text-xs",children:[e.jsxs("div",{className:"rounded bg-white/60 p-2",children:[e.jsxs("div",{className:"font-semibold text-muted-foreground",children:[n.toFixed(1),"%"]}),e.jsx("div",{className:"text-muted-foreground",children:"Asignado"})]}),e.jsxs("div",{className:"rounded bg-white/60 p-2",children:[e.jsxs("div",{className:`font-semibold ${j>0?"text-amber-700 dark:text-amber-300":"text-green-700 dark:text-green-300"}`,children:[j.toFixed(1),"%"]}),e.jsx("div",{className:"text-muted-foreground",children:"Disponible"})]}),e.jsxs("div",{className:"rounded bg-white/60 p-2",children:[e.jsxs("div",{className:`font-semibold ${M?"text-green-700 dark:text-green-300":I?"text-red-700 dark:text-red-300":"text-muted-foreground"}`,children:[$.toFixed(1),"%"]}),e.jsx("div",{className:"text-muted-foreground",children:"Proyectado"})]})]}),e.jsx("div",{className:"mt-2 h-2 w-full overflow-hidden rounded-full bg-muted",children:e.jsxs("div",{className:"flex h-full",children:[e.jsx("div",{className:"bg-blue-400 transition-all duration-300",style:{width:`${Math.min(n,100)}%`}}),e.jsx("div",{className:`transition-all duration-300 ${I?"bg-red-500":"bg-green-500"}`,style:{width:`${Math.min(p,100-Math.min(n,100))}%`}})]})}),e.jsxs("div",{className:"mt-1 flex justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Otras actividades: ",n.toFixed(1),"%"]}),e.jsxs("span",{children:["Esta actividad: ",p,"%"]})]})]}),I&&e.jsxs(U,{className:"border-red-300 dark:border-red-700 bg-red-50 dark:bg-red-950/30",children:[e.jsx(re,{className:"h-4 w-4 text-red-600"}),e.jsxs(B,{className:"text-red-700 dark:text-red-300 text-xs",children:["La suma total (",$.toFixed(1),"%) excede el 100%. Reduce el peso a máximo ",e.jsxs("strong",{children:[j.toFixed(1),"%"]}),"."]})]}),M&&e.jsxs(U,{className:"border-green-300 dark:border-green-700 bg-green-50 dark:bg-green-950/30",children:[e.jsx(te,{className:"h-4 w-4 text-green-600"}),e.jsx(B,{className:"text-green-700 dark:text-green-300 text-xs",children:"¡Perfecto! La suma total es exactamente 100%."})]})]})})(),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"name",children:"Nombre de la Actividad *"}),e.jsx(z,{id:"name",value:v.name,onChange:p=>a("name",p.target.value),placeholder:"Ej: Proyecto Final",className:l.name?"border-red-500":""}),l.name&&e.jsx("p",{className:"text-sm text-red-600",children:l.name})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"description",children:"Descripción"}),e.jsx(ce,{id:"description",value:v.description,onChange:p=>a("description",p.target.value),placeholder:"Describe la actividad y sus objetivos",rows:3,className:l.description?"border-red-500":""}),l.description&&e.jsx("p",{className:"text-sm text-red-600",children:l.description})]}),e.jsx("div",{className:"grid gap-4",children:e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"weight",children:"Peso (%) *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(z,{id:"weight",type:"number",min:"0",max:"100",step:"0.01",value:v.weight,onChange:p=>a("weight",parseFloat(p.target.value)||0),className:`flex-1 ${l.weight?"border-red-500":""}`}),j>0&&e.jsxs(h,{type:"button",variant:"outline",size:"sm",className:"shrink-0 text-xs",onClick:()=>a("weight",Math.round(j*100)/100),title:`Usar peso restante: ${j.toFixed(1)}%`,children:[e.jsx(Te,{className:"mr-1 h-3 w-3"}),j.toFixed(1),"%"]})]}),l.weight&&e.jsx("p",{className:"text-sm text-red-600",children:l.weight}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["% de la nota final del módulo",j>0&&v.weight===0&&e.jsx("span",{className:"ml-1 text-amber-600",children:"(Haz clic en el botón para usar el restante)"})]})]})}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"status",children:"Estado *"}),e.jsxs("select",{id:"status",value:v.status,onChange:p=>a("status",p.target.value),className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm text-foreground ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[e.jsx("option",{value:"active",children:"Activa"}),e.jsx("option",{value:"inactive",children:"Inactiva"})]}),l.status&&e.jsx("p",{className:"text-sm text-red-600",children:l.status})]})]}),e.jsxs(ne,{children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>r(!1),disabled:m,children:"Cancelar"}),e.jsx(h,{type:"submit",disabled:m,children:m?"Guardando...":u?"Actualizar":"Crear"})]})]})})})}function Le({open:t,onOpenChange:r,activityId:d,criteria:s,nextOrder:f=0}){const y=!!s,{data:u,setData:n,post:j,put:v,processing:a,errors:c,reset:b}=se({name:s?.name||"",description:s?.description||"",max_points:s?.max_points||10,order:s?.order??f});S.useEffect(()=>{s?n({name:s.name,description:s.description||"",max_points:s.max_points,order:s.order}):(b(),n("order",f))},[s,t,f]);const m=l=>{l.preventDefault(),y?v(F.updateCriteria({criteria:s.id}).url,{preserveScroll:!0,onSuccess:()=>{r(!1),b()}}):j(F.storeCriteria({activity:d}).url,{preserveScroll:!0,onSuccess:()=>{r(!1),b()}})};return e.jsx(ie,{open:t,onOpenChange:r,children:e.jsx(ae,{className:"sm:max-w-[500px]",children:e.jsxs("form",{onSubmit:m,children:[e.jsxs(de,{children:[e.jsx(le,{children:y?"Editar Criterio de Evaluación":"Agregar Criterio de Evaluación"}),e.jsx(oe,{children:y?"Actualiza la información del criterio de evaluación.":"Agrega un nuevo criterio de evaluación a la actividad."})]}),e.jsxs(U,{className:"border-amber-200 dark:border-amber-800 bg-amber-50 dark:bg-amber-950/30",children:[e.jsx(me,{className:"h-4 w-4 text-amber-600"}),e.jsx(pe,{className:"text-amber-800 dark:text-amber-200",children:"Sistema de Puntos"}),e.jsx(B,{className:"text-amber-700 dark:text-amber-300",children:e.jsxs("ul",{className:"mt-1 list-disc space-y-1 pl-4 text-xs",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Puntuación Máxima:"})," Es el número máximo de puntos que un estudiante puede obtener en este criterio."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Cálculo de nota:"})," La nota del criterio se calcula como: (puntos obtenidos / puntuación máxima) × 100."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Ejemplo:"})," Si el máximo es 10 pts y el estudiante obtiene 8 pts, su nota en este criterio será 80%."]})]})})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"name",children:"Nombre del Criterio *"}),e.jsx(z,{id:"name",value:u.name,onChange:l=>n("name",l.target.value),placeholder:"Ej: Calidad del código",className:c.name?"border-red-500":""}),c.name&&e.jsx("p",{className:"text-sm text-red-600",children:c.name})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"description",children:"Descripción"}),e.jsx(ce,{id:"description",value:u.description,onChange:l=>n("description",l.target.value),placeholder:"Describe qué se evaluará en este criterio",rows:3,className:c.description?"border-red-500":""}),c.description&&e.jsx("p",{className:"text-sm text-red-600",children:c.description})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"max_points",children:"Puntuación Máxima *"}),e.jsx(z,{id:"max_points",type:"number",min:"0",step:"0.01",value:u.max_points,onChange:l=>n("max_points",parseFloat(l.target.value)||0),className:c.max_points?"border-red-500":""}),c.max_points&&e.jsx("p",{className:"text-sm text-red-600",children:c.max_points}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Puntos máximos a obtener"})]})]}),e.jsxs(ne,{children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>r(!1),disabled:a,children:"Cancelar"}),e.jsx(h,{type:"submit",disabled:a,children:a?"Guardando...":y?"Actualizar":"Crear"})]})]})})})}function Pt({program:t,studyPlans:r}){const{auth:d}=Ee().props,s=d?.permissions??[],f=i=>s.includes(i),[y,u]=S.useState({open:!1}),[n,j]=S.useState({open:!1}),v=(i,L)=>i.filter(o=>o.id!==L).reduce((o,x)=>o+(Number(x.weight)||0),0),a=i=>{const L=Number(i)||0;return L===100?{status:"complete",color:"green",message:"Completo"}:L>100?{status:"over",color:"red",message:`Excede por ${(L-100).toFixed(1)}%`}:{status:"incomplete",color:"amber",message:`Faltan ${(100-L).toFixed(1)}%`}},[c,b]=S.useState({open:!1}),[m,l]=S.useState({open:!1}),[T,W]=S.useState({open:!1}),[p,$]=S.useState({open:!1}),M=()=>{m.studyPlan&&G.delete(F.destroy(m.studyPlan.id).url,{preserveScroll:!0,onSuccess:()=>l({open:!1})})},I=()=>{T.activity&&G.delete(F.destroyActivity(T.activity.id).url,{preserveScroll:!0,onSuccess:()=>W({open:!1})})},Ce=()=>{p.criteria&&G.delete(F.destroyCriteria(p.criteria.id).url,{preserveScroll:!0,onSuccess:()=>$({open:!1})})};return e.jsxs(_e,{children:[e.jsx(Pe,{title:`${t.name} - Plan de Estudios`}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs(ue,{href:xe.index().url,className:"mb-3 inline-flex items-center text-sm text-muted-foreground hover:text-foreground",children:[e.jsx(De,{className:"mr-1 h-4 w-4"}),"Volver a programas"]}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:t.name}),t.description&&e.jsx("p",{className:"mt-2 text-muted-foreground",children:t.description}),e.jsxs("div",{className:"mt-3 flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("span",{children:[t.duration_months," meses"]}),e.jsx("span",{children:"•"}),e.jsx("span",{className:`rounded-full px-2.5 py-0.5 text-xs font-medium ${t.status==="active"?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400":"bg-muted text-muted-foreground"}`,children:t.status==="active"?"Activo":"Inactivo"})]})]}),e.jsx(ue,{href:xe.edit({program:t.id}).url,children:e.jsx(h,{variant:"outline",children:"Editar Programa"})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Plan de Estudios"}),e.jsxs(h,{onClick:()=>u({open:!0}),children:[e.jsx(H,{className:"mr-2 h-4 w-4"}),"Agregar Módulo"]})]}),e.jsxs(U,{className:"border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-950/30",children:[e.jsx(me,{className:"h-4 w-4 text-blue-600"}),e.jsx(pe,{className:"text-blue-800 dark:text-blue-200",children:"Sistema de Evaluación: Puntos y Porcentajes"}),e.jsx(B,{className:"text-blue-700 dark:text-blue-300",children:e.jsxs("div",{className:"mt-2 grid gap-3 text-sm md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-md bg-white/60 p-3",children:[e.jsx("strong",{className:"text-blue-900 dark:text-blue-100",children:"Peso de Actividades (%):"}),e.jsxs("ul",{className:"mt-1 list-disc pl-4 text-xs",children:[e.jsx("li",{children:"Cada actividad tiene un peso porcentual dentro del módulo"}),e.jsxs("li",{children:["La suma de todos los pesos debe ser ",e.jsx("strong",{children:"100%"})]}),e.jsx("li",{children:"Ejemplo: Tarea 30% + Examen 40% + Proyecto 30% = 100%"})]})]}),e.jsxs("div",{className:"rounded-md bg-white/60 p-3",children:[e.jsx("strong",{className:"text-blue-900 dark:text-blue-100",children:"Puntos de Criterios:"}),e.jsxs("ul",{className:"mt-1 list-disc pl-4 text-xs",children:[e.jsx("li",{children:"Cada criterio tiene una puntuación máxima (ej: 10 pts)"}),e.jsx("li",{children:"El estudiante recibe puntos según su desempeño"}),e.jsx("li",{children:"La nota se calcula: (obtenidos / máximo) × peso de actividad"})]})]})]})})]}),r.length>0?e.jsx("div",{className:"space-y-4",children:r.map((i,L)=>e.jsxs("div",{className:"rounded-xl border border-border bg-card p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4 flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-blue-100 dark:bg-blue-900/30",children:e.jsx(he,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-foreground",children:["Módulo ",L+1,": ",i.module_name]}),i.description&&e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:i.description}),e.jsxs("div",{className:"mt-2 flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("span",{children:[i.hours," horas"]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Nivel ",i.level]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{variant:"outline",size:"sm",onClick:()=>u({open:!0,studyPlan:i}),children:"Editar"}),e.jsx(h,{variant:"outline",size:"sm",onClick:()=>j({open:!0,studyPlanId:i.id,nextOrder:i.activities.length,currentTotalWeight:v(i.activities)}),children:e.jsx(H,{className:"h-4 w-4"})}),f("eliminar_plan_estudio")&&e.jsx(h,{variant:"outline",size:"sm",className:"text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 hover:text-red-700 dark:hover:text-red-300",onClick:()=>l({open:!0,studyPlan:i}),children:e.jsx(ee,{className:"h-4 w-4"})})]})]}),i.activities.length>0?e.jsxs("div",{className:"ml-14 space-y-3",children:[(()=>{const o=Number(v(i.activities))||0,x=a(o);return e.jsxs("div",{className:"rounded-lg border border-border bg-muted p-3",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-semibold text-muted-foreground",children:"Actividades:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[x.status==="complete"?e.jsx(te,{className:"h-4 w-4 text-green-600"}):e.jsx(re,{className:`h-4 w-4 ${x.status==="over"?"text-red-600":"text-amber-600"}`}),e.jsxs("span",{className:`text-sm font-medium ${x.status==="complete"?"text-green-700 dark:text-green-300":x.status==="over"?"text-red-700 dark:text-red-300":"text-amber-700 dark:text-amber-300"}`,children:[o.toFixed(1),"% de 100% — ",x.message]})]})]}),e.jsx("div",{className:"h-2 w-full overflow-hidden rounded-full bg-muted",children:e.jsx("div",{className:`h-full transition-all duration-300 ${x.status==="complete"?"bg-green-500":x.status==="over"?"bg-red-500":"bg-amber-500"}`,style:{width:`${Math.min(o,100)}%`}})}),x.status!=="complete"&&e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:x.status==="over"?"La suma de pesos excede el 100%. Ajusta los pesos de las actividades.":"La suma de pesos debe ser exactamente 100% para que las calificaciones se calculen correctamente."})]})})(),i.activities.map(o=>e.jsxs("div",{className:"rounded-lg border border-border bg-muted p-4",children:[e.jsxs("div",{className:"mb-3 flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-md bg-purple-100 dark:bg-purple-900/30",children:e.jsx(Se,{className:"h-4 w-4 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-foreground",children:o.name}),o.description&&e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:o.description}),e.jsxs("div",{className:"mt-1 flex items-center gap-3 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Peso: ",o.weight,"%"]}),e.jsx("span",{children:"•"}),e.jsx("span",{className:`rounded-full px-2 py-0.5 ${o.status==="active"?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400":"bg-muted text-muted-foreground"}`,children:o.status==="active"?"Activa":"Inactiva"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>j({open:!0,studyPlanId:i.id,activity:o,currentTotalWeight:v(i.activities,o.id)}),children:"Editar"}),e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>b({open:!0,activityId:o.id,nextOrder:o.evaluation_criteria.length}),children:e.jsx(H,{className:"h-4 w-4"})}),f("eliminar_actividad")&&e.jsx(h,{variant:"ghost",size:"sm",className:"text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 hover:text-red-700 dark:hover:text-red-300",onClick:()=>W({open:!0,activity:o}),children:e.jsx(ee,{className:"h-4 w-4"})})]})]}),o.evaluation_criteria.length>0&&e.jsxs("div",{className:"ml-11 space-y-2",children:[e.jsx("h6",{className:"text-xs font-semibold text-muted-foreground",children:"Criterios de Evaluación:"}),o.evaluation_criteria.map(x=>e.jsxs("div",{className:"flex items-center justify-between rounded-md border border-border bg-card p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"h-4 w-4 text-amber-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:x.name}),x.description&&e.jsx("p",{className:"text-xs text-muted-foreground",children:x.description})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm font-medium text-muted-foreground",children:[x.max_points," pts"]}),e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>b({open:!0,activityId:o.id,criteria:x}),children:"Editar"}),f("eliminar_criterio_evaluacion")&&e.jsx(h,{variant:"ghost",size:"sm",className:"text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 hover:text-red-700 dark:hover:text-red-300",onClick:()=>$({open:!0,criteria:x}),children:e.jsx(ee,{className:"h-4 w-4"})})]})]},x.id))]})]},o.id))]}):e.jsxs("div",{className:"ml-14 rounded-lg border-2 border-dashed border-border bg-muted p-6 text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"No hay actividades en este módulo"}),e.jsxs(h,{variant:"outline",size:"sm",className:"mt-3",onClick:()=>j({open:!0,studyPlanId:i.id,nextOrder:0,currentTotalWeight:0}),children:[e.jsx(H,{className:"mr-2 h-4 w-4"}),"Agregar Primera Actividad"]})]})]},i.id))}):e.jsxs("div",{className:"rounded-xl border-2 border-dashed border-border bg-card p-12 text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-muted",children:e.jsx(he,{className:"h-8 w-8 text-muted-foreground"})}),e.jsx("h3",{className:"mb-2 text-xl font-semibold text-foreground",children:"No hay módulos en este programa"}),e.jsx("p",{className:"mb-6 text-muted-foreground",children:"Comienza agregando el primer módulo al plan de estudios"}),e.jsxs(h,{onClick:()=>u({open:!0}),children:[e.jsx(H,{className:"mr-2 h-5 w-5"}),"Agregar Primer Módulo"]})]})]})]}),e.jsx($e,{open:y.open,onOpenChange:i=>u({open:i,studyPlan:void 0}),programId:t.id,studyPlan:y.studyPlan}),n.studyPlanId&&e.jsx(Ie,{open:n.open,onOpenChange:i=>j({open:i,studyPlanId:void 0,activity:void 0,currentTotalWeight:void 0}),studyPlanId:n.studyPlanId,activity:n.activity,nextOrder:n.nextOrder,currentTotalWeight:n.currentTotalWeight}),c.activityId&&e.jsx(Le,{open:c.open,onOpenChange:i=>b({open:i,activityId:void 0,criteria:void 0}),activityId:c.activityId,criteria:c.criteria,nextOrder:c.nextOrder}),e.jsx(O,{open:m.open,onOpenChange:i=>l({open:i,studyPlan:void 0}),children:e.jsxs(R,{children:[e.jsxs(V,{children:[e.jsx(J,{children:"Eliminar Módulo"}),e.jsxs(K,{children:['¿Estás seguro de que deseas eliminar el módulo "',m.studyPlan?.module_name,'"? Esta acción eliminará también todas las actividades y criterios de evaluación asociados. Esta acción no se puede deshacer.']})]}),e.jsxs(X,{children:[e.jsx(Y,{children:"Cancelar"}),e.jsx(Z,{onClick:M,className:"bg-red-600 hover:bg-red-700",children:"Eliminar"})]})]})}),e.jsx(O,{open:T.open,onOpenChange:i=>W({open:i,activity:void 0}),children:e.jsxs(R,{children:[e.jsxs(V,{children:[e.jsx(J,{children:"Eliminar Actividad"}),e.jsxs(K,{children:['¿Estás seguro de que deseas eliminar la actividad "',T.activity?.name,'"? Esta acción eliminará también todos los criterios de evaluación asociados. Esta acción no se puede deshacer.']})]}),e.jsxs(X,{children:[e.jsx(Y,{children:"Cancelar"}),e.jsx(Z,{onClick:I,className:"bg-red-600 hover:bg-red-700",children:"Eliminar"})]})]})}),e.jsx(O,{open:p.open,onOpenChange:i=>$({open:i,criteria:void 0}),children:e.jsxs(R,{children:[e.jsxs(V,{children:[e.jsx(J,{children:"Eliminar Criterio de Evaluación"}),e.jsxs(K,{children:['¿Estás seguro de que deseas eliminar el criterio "',p.criteria?.name,'"? Esta acción no se puede deshacer.']})]}),e.jsxs(X,{children:[e.jsx(Y,{children:"Cancelar"}),e.jsx(Z,{onClick:Ce,className:"bg-red-600 hover:bg-red-700",children:"Eliminar"})]})]})})]})}export{Pt as default};
