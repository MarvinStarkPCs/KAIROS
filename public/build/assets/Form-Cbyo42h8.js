import{r as g,u as w,j as e,H as C,L as j}from"./app-B-gf--_t.js";import{B as v}from"./button-DTUf-G6D.js";import{I as m}from"./input-CTu6QkH6.js";import{L as i}from"./label-KAX_2qcR.js";import{T as P}from"./textarea-BBKmZhVT.js";import{A as E}from"./app-layout-DCfsguUo.js";import{I as d}from"./input-error-BfPDWsL_.js";import{A as F}from"./arrow-left-COnhC6c-.js";import{S}from"./app-header-C7WnRrDD.js";import{C as f}from"./check-D-BBakgQ.js";import{S as L}from"./save-tTiNnXcL.js";import"./app-ByrExa3J.js";import"./index-Bw9BVP0i.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./index-DPi3QwXA.js";import"./index-ZKCUC6w_.js";import"./index-86_gkdgf.js";import"./index-BE6TIB6q.js";import"./createLucideIcon-BKgpMFfl.js";import"./index-gJzyg25X.js";import"./toaster-B6w1HnuI.js";import"./graduation-cap-B9BAa-o7.js";import"./index-IvkJj8jp.js";import"./index-CbRbsemT.js";import"./wayfinder-Bf9OnZdi.js";import"./index-D0SF2iEG.js";import"./user-9gpTgHHE.js";import"./users-zOAYG_oC.js";import"./credit-card-CtoVMbCz.js";import"./calendar-DTT_Gcgg.js";import"./file-text-Ms1_89oi.js";import"./lock-CmYtdoIE.js";import"./shield-BDPpEQT_.js";import"./mail-Cj9TAJd0.js";function ue({payment:s,enrollments:c}){const[n,u]=g.useState(""),[l,p]=g.useState(s?.enrollment_id&&c.find(t=>t.id===s.enrollment_id)||null),{data:r,setData:a,post:_,put:b,processing:x,errors:o}=w({student_id:s?.student_id||"",program_id:s?.program_id||"",enrollment_id:s?.enrollment_id||"",concept:s?.concept||"",payment_type:s?.payment_type||"single",amount:s?.amount||"",due_date:s?.due_date||"",status:s?.status||"pending",payment_method:s?.payment_method||"",reference_number:s?.reference_number||"",notes:s?.notes||""}),y=t=>{p(t),u(""),a({...r,student_id:t.student_id,program_id:t.program_id,enrollment_id:t.id})},N=t=>{t.preventDefault(),s?.id?b(`/pagos/${s.id}`):_("/pagos")},h=c.filter(t=>t.student_name.toLowerCase().includes(n.toLowerCase())||t.student_email.toLowerCase().includes(n.toLowerCase())||t.program_name.toLowerCase().includes(n.toLowerCase()));return e.jsxs(E,{children:[e.jsx(C,{title:s?"Editar Pago":"Registrar Pago"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs(j,{href:"/pagos",className:"mb-2 flex items-center text-sm text-gray-600 hover:text-gray-900",children:[e.jsx(F,{className:"mr-1 h-4 w-4"}),"Volver a pagos"]}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:s?"Editar Pago":"Registrar Pago"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Selecciona un estudiante inscrito para registrar el pago"})]})}),e.jsxs("form",{onSubmit:N,className:"rounded-xl border border-gray-200 bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(i,{htmlFor:"student-search",children:"Buscar Estudiante Inscrito *"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"}),e.jsx(m,{id:"student-search",type:"text",value:n,onChange:t=>u(t.target.value),placeholder:"Buscar por nombre, email o programa...",className:"pl-10"})]}),n&&e.jsx("div",{className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md border border-gray-200 bg-white shadow-lg",children:h.length>0?h.map(t=>e.jsxs("button",{type:"button",onClick:()=>y(t),className:"flex w-full items-start gap-3 px-4 py-3 text-left hover:bg-gray-50",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.student_name}),e.jsx("div",{className:"text-sm text-gray-500",children:t.student_email}),e.jsx("div",{className:"mt-1 inline-flex items-center rounded-full bg-blue-100 px-2 py-0.5 text-xs font-medium text-blue-700",children:t.program_name})]}),l?.id===t.id&&e.jsx(f,{className:"h-5 w-5 text-green-600"})]},t.id)):e.jsx("div",{className:"px-4 py-3 text-sm text-gray-500",children:"No se encontraron estudiantes inscritos"})}),l&&!n&&e.jsx("div",{className:"mt-2 rounded-lg border border-green-200 bg-green-50 p-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"font-medium text-green-900",children:l.student_name})]}),e.jsxs("div",{className:"ml-6 mt-1 text-sm text-green-700",children:["Programa: ",l.program_name]})]}),e.jsx("button",{type:"button",onClick:()=>{p(null),a({...r,student_id:"",program_id:"",enrollment_id:""})},className:"text-sm text-green-700 hover:text-green-900",children:"Cambiar"})]})})]}),e.jsx(d,{message:o.student_id||o.enrollment_id})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(i,{htmlFor:"concept",children:"Concepto del Pago *"}),e.jsx(m,{id:"concept",type:"text",value:r.concept,onChange:t=>a("concept",t.target.value),placeholder:"Ej: Mensualidad Enero 2025",required:!0}),e.jsx(d,{message:o.concept})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"payment_type",children:"Tipo de Pago *"}),e.jsxs("select",{id:"payment_type",value:r.payment_type,onChange:t=>a("payment_type",t.target.value),className:"mt-1 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm",children:[e.jsx("option",{value:"single",children:"Pago Único"}),e.jsx("option",{value:"partial",children:"Permite Abonos Parciales"})]}),e.jsx(d,{message:o.payment_type})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"amount",children:"Monto *"}),e.jsx(m,{id:"amount",type:"number",step:"0.01",value:r.amount,onChange:t=>a("amount",t.target.value),placeholder:"0.00",required:!0}),e.jsx(d,{message:o.amount})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"due_date",children:"Fecha de Vencimiento *"}),e.jsx(m,{id:"due_date",type:"date",value:r.due_date,onChange:t=>a("due_date",t.target.value),required:!0}),e.jsx(d,{message:o.due_date})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"status",children:"Estado *"}),e.jsxs("select",{id:"status",value:r.status,onChange:t=>a("status",t.target.value),className:"mt-1 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm",children:[e.jsx("option",{value:"pending",children:"Pendiente"}),e.jsx("option",{value:"completed",children:"Completado"}),e.jsx("option",{value:"overdue",children:"Vencido"}),e.jsx("option",{value:"cancelled",children:"Cancelado"})]}),e.jsx(d,{message:o.status})]}),r.status==="completed"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"payment_method",children:"Método de Pago"}),e.jsxs("select",{id:"payment_method",value:r.payment_method,onChange:t=>a("payment_method",t.target.value),className:"mt-1 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm",children:[e.jsx("option",{value:"",children:"Seleccionar"}),e.jsx("option",{value:"cash",children:"Efectivo"}),e.jsx("option",{value:"transfer",children:"Transferencia"}),e.jsx("option",{value:"credit_card",children:"Tarjeta de Crédito"})]}),e.jsx(d,{message:o.payment_method})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"reference_number",children:"Número de Referencia"}),e.jsx(m,{id:"reference_number",type:"text",value:r.reference_number,onChange:t=>a("reference_number",t.target.value),placeholder:"Número de comprobante"}),e.jsx(d,{message:o.reference_number})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(i,{htmlFor:"notes",children:"Notas"}),e.jsx(P,{id:"notes",value:r.notes,onChange:t=>a("notes",t.target.value),placeholder:"Observaciones adicionales...",rows:3}),e.jsx(d,{message:o.notes})]})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-end gap-3",children:[e.jsx(j,{href:"/pagos",children:e.jsx(v,{type:"button",variant:"outline",children:"Cancelar"})}),e.jsxs(v,{type:"submit",disabled:x||!l,children:[e.jsx(L,{className:"mr-2 h-4 w-4"}),x?"Guardando...":s?"Actualizar Pago":"Registrar Pago"]})]})]})]})]})}export{ue as default};
