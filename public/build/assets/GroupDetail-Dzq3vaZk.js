import{r as h,j as e,H as D,L as E,a as U}from"./app-BM0pG2K-.js";import{A as V}from"./app-layout-BjpU8ztl.js";import{B as o}from"./button-BtPQLgvd.js";import{C as j,b as p,c as g,d as T,a as N}from"./card-BQW5J6xq.js";import{B as n}from"./badge-DhtLSkPy.js";import{T as J,a as X,b as C,c as S}from"./tabs-BoHuXj4P.js";import{D as q,a as K,b as Q,c as W,d as Y}from"./dialog-BqsMCmD5.js";import{I as c}from"./app-header-cwaq-Tzd.js";import{C as $}from"./clock-D-avsIE2.js";import{M as Z}from"./map-pin-DYgfv8GE.js";import{C as ee}from"./clipboard-check-ZgUeMQcI.js";import{U as se}from"./users-7lztWReb.js";import{G as ae}from"./graduation-cap-CBLUEHTy.js";import{C as te}from"./calendar-CMD_C6w3.js";import{E as re}from"./eye-Ddg5pr6X.js";import{C as z}from"./circle-check-big-BdF5B3zz.js";import{C as B}from"./circle-alert-BbVC_MWa.js";import{C as H}from"./circle-x-i1siB6kU.js";import{C as ie}from"./chevron-right-CSI4tqQj.js";/* empty css            */import"./utils-Bx_P6K9N.js";import"./index-ClymHhac.js";import"./index-uCtcDc-w.js";import"./createLucideIcon-BTWQ-ZwJ.js";import"./index-C7FLMnpn.js";import"./index-B5Z9C6CJ.js";import"./index-DqYA8G-1.js";import"./toaster-BQaot-6m.js";import"./index-DPFnJWts.js";import"./index-Bz9564uu.js";import"./index-CLa6oRL-.js";import"./wayfinder-Bf9OnZdi.js";import"./index-B4i4Sow2.js";import"./credit-card-B_zWbJ9G.js";import"./file-text-Bx2SdM7g.js";import"./lock-BX7cIt7B.js";import"./shield-CsHRZJ-g.js";import"./loader-circle-DY8ckhBZ.js";import"./mail-ij4C9UCm.js";function Ve({schedule:i,students:x,activities:u,classDates:A}){const[v,k]=h.useState({}),[P,f]=h.useState({}),[l,L]=h.useState(null),[t,b]=h.useState(null),F=s=>{L(s);const a={},r={};x.forEach(d=>{d.attendance_by_date[s]&&(a[d.id]=d.attendance_by_date[s].status,r[d.id]=d.attendance_by_date[s].notes||"")}),k(a),f(r)},y=(s,a)=>{k(r=>({...r,[s]:a})),a==="present"&&f(r=>({...r,[s]:""}))},G=(s,a)=>{f(r=>({...r,[s]:a}))},M=()=>{if(!l)return;const s=Object.entries(v).map(([a,r])=>({student_id:parseInt(a),status:r,notes:P[parseInt(a)]||""}));if(s.length===0){alert("Debes marcar al menos un estudiante");return}U.post(`/profesor/grupo/${i.id}/asistencia`,{class_date:l,attendances:s})},R=s=>{switch(s){case"present":return e.jsx(z,{className:"w-4 h-4 text-green-500"});case"late":return e.jsx(B,{className:"w-4 h-4 text-yellow-500"});case"absent":return e.jsx(H,{className:"w-4 h-4 text-red-500"});default:return e.jsx($,{className:"w-4 h-4 text-gray-400"})}},I=s=>{switch(s){case"present":return e.jsx(n,{className:"bg-green-500",children:"Presente"});case"late":return e.jsx(n,{className:"bg-yellow-500",children:"Tarde"});case"absent":return e.jsx(n,{variant:"destructive",children:"Ausente"});default:return e.jsx(n,{variant:"outline",children:"Sin marcar"})}},m=s=>new Date(s).toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"numeric"}),_=A.filter(s=>s.is_past||s.is_today),w=A.filter(s=>!s.is_past&&!s.is_today);return e.jsxs(V,{variant:"sidebar",title:`${i.program.name} - Portal Profesor`,children:[e.jsx(D,{title:`${i.program.name} - Portal Profesor`}),e.jsxs("div",{className:"px-6 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:i.program.name}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-gray-600",children:[e.jsx(n,{style:{backgroundColor:i.program.color},className:"text-white",children:i.days_of_week}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(c,{iconNode:$,className:"w-4 h-4 mr-1"}),i.start_time," - ",i.end_time]}),i.location&&e.jsxs("span",{className:"flex items-center",children:[e.jsx(c,{iconNode:Z,className:"w-4 h-4 mr-1"}),i.location]})]})]}),e.jsx(E,{href:"/profesor/mis-grupos",children:e.jsx(o,{variant:"outline",children:"Volver"})})]})}),e.jsxs(J,{defaultValue:"attendance",className:"space-y-6",children:[e.jsxs(X,{className:"grid w-full grid-cols-3",children:[e.jsxs(C,{value:"attendance",children:[e.jsx(c,{iconNode:ee,className:"w-4 h-4 mr-2"}),"Asistencia"]}),e.jsxs(C,{value:"students",children:[e.jsx(c,{iconNode:se,className:"w-4 h-4 mr-2"}),"Estudiantes (",x.length,")"]}),e.jsxs(C,{value:"activities",children:[e.jsx(c,{iconNode:ae,className:"w-4 h-4 mr-2"}),"Actividades (",u.length,")"]})]}),e.jsx(S,{value:"attendance",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(j,{className:"lg:col-span-1",children:[e.jsxs(p,{children:[e.jsx(g,{className:"text-lg",children:"Fechas de Clase"}),e.jsx(T,{children:"Selecciona una fecha para marcar asistencia"})]}),e.jsx(N,{className:"max-h-[500px] overflow-y-auto",children:_.length===0&&w.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No hay fechas de clase configuradas"}):e.jsxs("div",{className:"space-y-2",children:[_.map(s=>e.jsx("div",{onClick:()=>F(s.date),className:`p-3 rounded-lg border cursor-pointer transition-colors ${l===s.date?"border-[#7a9b3c] bg-[#7a9b3c]/10":"hover:bg-gray-50"} ${s.is_today?"border-blue-500 border-2":""}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium flex items-center gap-2",children:[s.day_name,s.is_today&&e.jsx(n,{className:"bg-blue-500 text-xs",children:"Hoy"})]}),e.jsx("div",{className:"text-sm text-gray-500",children:m(s.date)})]}),e.jsxs("div",{className:"text-right",children:[s.marked_count>0?e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsxs("span",{className:"text-green-600",children:[s.present_count,"P"]}),e.jsxs("span",{className:"text-yellow-600",children:[s.late_count,"T"]}),e.jsxs("span",{className:"text-red-600",children:[s.absent_count,"A"]})]}):e.jsx(n,{variant:"outline",className:"text-xs",children:"Sin marcar"}),e.jsxs("div",{className:"text-xs text-gray-400",children:[s.marked_count,"/",s.total_students]})]})]})},s.date)),w.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-gray-400 uppercase mt-4 mb-2",children:"Próximas clases"}),w.map(s=>e.jsx("div",{className:"p-3 rounded-lg border bg-gray-50 opacity-60",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.day_name}),e.jsx("div",{className:"text-sm text-gray-500",children:m(s.date)})]}),e.jsx(n,{variant:"outline",className:"text-xs",children:"Próxima"})]})},s.date))]})]})})]}),e.jsxs(j,{className:"lg:col-span-2",children:[e.jsxs(p,{children:[e.jsx(g,{className:"text-lg",children:l?`Asistencia - ${m(l)}`:"Marcar Asistencia"}),e.jsx(T,{children:l?"Marca la asistencia de cada estudiante":"Selecciona una fecha de la lista para marcar asistencia"})]}),e.jsx(N,{children:l?x.length===0?e.jsx("div",{className:"text-center py-12 text-gray-500",children:"No hay estudiantes inscritos"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-3 mb-6 max-h-[400px] overflow-y-auto",children:x.map(s=>{const a=v[s.id]||s.attendance_by_date[l]?.status,r=P[s.id]??s.attendance_by_date[l]?.notes??"",d=a==="late"||a==="absent";return e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(o,{variant:"ghost",size:"sm",onClick:()=>b(s),className:"p-1",children:e.jsx(re,{className:"w-4 h-4 text-gray-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:s.name}),e.jsx("p",{className:"text-xs text-gray-500",children:s.email})]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(o,{size:"sm",variant:a==="present"?"default":"outline",onClick:()=>y(s.id,"present"),className:`px-2 ${a==="present"?"bg-green-600 hover:bg-green-700":""}`,title:"Presente",children:e.jsx(c,{iconNode:z,className:"w-4 h-4"})}),e.jsx(o,{size:"sm",variant:a==="late"?"default":"outline",onClick:()=>y(s.id,"late"),className:`px-2 ${a==="late"?"bg-yellow-600 hover:bg-yellow-700":""}`,title:"Tarde",children:e.jsx(c,{iconNode:B,className:"w-4 h-4"})}),e.jsx(o,{size:"sm",variant:a==="absent"?"default":"outline",onClick:()=>y(s.id,"absent"),className:`px-2 ${a==="absent"?"bg-red-600 hover:bg-red-700":""}`,title:"Ausente",children:e.jsx(c,{iconNode:H,className:"w-4 h-4"})})]})]}),d&&e.jsx("div",{className:"mt-2 ml-10",children:e.jsx("input",{type:"text",placeholder:a==="late"?"Justificación de tardanza (ej: tráfico, cita médica...)":"Razón de la ausencia...",value:r,onChange:O=>G(s.id,O.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#7a9b3c] focus:border-transparent"})})]},s.id)})}),e.jsx(o,{onClick:M,className:"w-full bg-[#7a9b3c] hover:bg-[#6a8a2c]",disabled:Object.keys(v).length===0,children:"Guardar Asistencia"})]}):e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(te,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Selecciona una fecha de clase para marcar asistencia"})]})})]})]})}),e.jsx(S,{value:"students",children:e.jsxs(j,{children:[e.jsx(p,{children:e.jsx(g,{children:"Lista de Estudiantes"})}),e.jsx(N,{children:x.length===0?e.jsx("div",{className:"text-center py-12 text-gray-500",children:"No hay estudiantes inscritos en este grupo"}):e.jsx("div",{className:"space-y-3",children:x.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50 cursor-pointer",onClick:()=>b(s),children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.email})]})}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-700",children:[s.progress_stats.progress_percentage,"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Avance"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-700",children:[s.progress_stats.average_grade,"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Promedio"})]}),e.jsx(ie,{className:"w-5 h-5 text-gray-400"})]})]},s.id))})})]})}),e.jsx(S,{value:"activities",children:e.jsxs(j,{children:[e.jsx(p,{children:e.jsx(g,{children:"Actividades para Evaluar"})}),e.jsx(N,{children:u.length===0?e.jsx("div",{className:"text-center py-12 text-gray-500",children:"No hay actividades configuradas para este programa"}):e.jsx("div",{className:"space-y-4",children:u.map(s=>e.jsxs("div",{className:"p-4 border rounded-lg hover:bg-gray-50",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.description}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(n,{variant:"outline",children:s.study_plan.module_name}),e.jsxs(n,{variant:"secondary",children:["Peso: ",s.weight,"%"]})]})]})}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Criterios de Evaluación:"}),e.jsx("ul",{className:"space-y-1",children:s.evaluation_criteria.map(a=>e.jsxs("li",{className:"text-sm text-gray-600 flex items-center",children:[e.jsx("span",{className:"w-2 h-2 bg-[#7a9b3c] rounded-full mr-2"}),a.name," (",a.max_points," puntos)"]},a.id))})]}),e.jsx(E,{href:`/profesor/grupo/${i.id}/actividad/${s.id}/evaluar`,children:e.jsx(o,{className:"w-full bg-[#7a9b3c] hover:bg-[#6a8a2c]",children:"Evaluar Estudiantes"})})]},s.id))})})]})})]})]}),e.jsx(q,{open:!!t,onOpenChange:()=>b(null),children:e.jsxs(K,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Q,{children:[e.jsx(W,{children:t?.name}),e.jsx(Y,{children:t?.email})]}),t&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Resumen de Asistencia"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.attendance_stats.present}),e.jsx("div",{className:"text-xs text-green-700",children:"Presente"})]}),e.jsxs("div",{className:"text-center p-3 bg-yellow-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:t.attendance_stats.late}),e.jsx("div",{className:"text-xs text-yellow-700",children:"Tarde"})]}),e.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:t.attendance_stats.absent}),e.jsx("div",{className:"text-xs text-red-700",children:"Ausente"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Historial de Asistencias"}),e.jsx("div",{className:"space-y-2 max-h-[300px] overflow-y-auto",children:_.map(s=>{const a=t.attendance_by_date[s.date];return e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[R(a?.status||""),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.day_name}),e.jsx("div",{className:"text-sm text-gray-500",children:m(s.date)})]})]}),I(a?.status||"")]}),a?.notes&&e.jsxs("div",{className:"mt-2 ml-7 text-sm text-gray-600 bg-gray-50 rounded p-2",children:[e.jsx("span",{className:"font-medium",children:"Nota: "}),a.notes]})]},s.date)})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Avance Académico"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-sm text-blue-600",children:"Progreso"}),e.jsxs("div",{className:"text-3xl font-bold text-blue-700",children:[t.progress_stats.progress_percentage,"%"]}),e.jsxs("div",{className:"text-xs text-blue-600",children:[t.progress_stats.evaluated_activities," de ",t.progress_stats.total_activities," actividades"]})]}),e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-sm text-green-600",children:"Promedio"}),e.jsxs("div",{className:"text-3xl font-bold text-green-700",children:[t.progress_stats.average_grade,"%"]}),e.jsx("div",{className:"text-xs text-green-600",children:"Calificación general"})]})]})]})]})]})})]})}export{Ve as default};
