import{j as e,r as n,F as g,H as S}from"./app-C8NcURSt.js";import{S as T,H as A}from"./layout-BqamoonR.js";import{a as _,B as x}from"./button-BHGJkybb.js";import{C as M,a as F,b as z,c as V,d as D}from"./card-DF2Ou2Ve.js";import{c as H,d as I,b as R,e as O,f as E}from"./index-CcE2XHjo.js";import{c as b}from"./utils-CBfrqCZ4.js";import{C as L}from"./circle-alert-BgtBPPkV.js";import{c as f}from"./createLucideIcon-D7RG60cb.js";import{E as $}from"./eye-off-DtSbvO9B.js";import{E as B}from"./eye-DPH7J8H1.js";import{I as P}from"./input-error-qGEWMI0S.js";import{D as G,b as q,c as K,d as Q,e as X}from"./dialog-B6mRUTKu.js";import{I as J,K as U,O as j,a as W,b as Y,u as Z}from"./use-two-factor-auth-DFOXhW5b.js";import{L as y}from"./loader-circle-CzFullQW.js";import{C as ee}from"./check-B36XRWFm.js";import{B as N}from"./badge-DXrmhbZb.js";import{A as ae}from"./app-layout-BWNSTnzo.js";import"./app-C-LPVYHj.js";import"./heading-DbX30iW9.js";import"./index-D84Mxgab.js";import"./index-Ev69Uu53.js";import"./wayfinder-FFrBTblC.js";import"./index-CGinIBRf.js";import"./app-header-CG1ssGlZ.js";import"./index-uKwbV_sB.js";import"./index-YEfPdCwI.js";import"./house-CZWOuWy8.js";import"./lock-DmLn8291.js";import"./shield-CVSj8g86.js";import"./music-BgCfYSmJ.js";import"./mail-CK-onULp.js";import"./toaster-2b9FfqPb.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],te=f("Copy",se);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["circle",{cx:"12",cy:"16",r:"1",key:"1au0dj"}],["rect",{x:"3",y:"10",width:"18",height:"12",rx:"2",key:"6s8ecr"}],["path",{d:"M7 10V7a5 5 0 0 1 10 0v3",key:"1pqi11"}]],ie=f("LockKeyhole",re);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],ce=f("RefreshCw",ne);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]],le=f("ScanLine",oe);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m4.243 5.21 14.39 12.472",key:"1c9a7c"}]],ue=f("ShieldBan",de);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],C=f("ShieldCheck",me),xe=_("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-background text-foreground",destructive:"text-destructive-foreground [&>svg]:text-current *:data-[slot=alert-description]:text-destructive-foreground/80"}},defaultVariants:{variant:"default"}});function pe({className:s,variant:a,...r}){return e.jsx("div",{"data-slot":"alert",role:"alert",className:b(xe({variant:a}),s),...r})}function fe({className:s,...a}){return e.jsx("div",{"data-slot":"alert-title",className:b("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",s),...a})}function he({className:s,...a}){return e.jsx("div",{"data-slot":"alert-description",className:b("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",s),...a})}function w({errors:s,title:a}){return e.jsxs(pe,{variant:"destructive",children:[e.jsx(L,{}),e.jsx(fe,{children:a||"Algo salió mal."}),e.jsx(he,{children:e.jsx("ul",{className:"list-inside list-disc text-sm",children:Array.from(new Set(s)).map((r,t)=>e.jsx("li",{children:r},t))})})]})}function ge({recoveryCodesList:s,fetchRecoveryCodes:a,errors:r}){const[t,i]=n.useState(!1),c=n.useRef(null),o=s.length>0&&t,d=n.useCallback(async()=>{!t&&!s.length&&await a(),i(!t),t||setTimeout(()=>{c.current?.scrollIntoView({behavior:"smooth",block:"nearest"})})},[t,s.length,a]);n.useEffect(()=>{s.length||a()},[s.length,a]);const m=t?$:B;return e.jsxs(M,{children:[e.jsxs(F,{children:[e.jsxs(z,{className:"flex gap-3",children:[e.jsx(ie,{className:"size-4","aria-hidden":"true"}),"Códigos de Recuperación 2FA"]}),e.jsx(V,{children:"Los códigos de recuperación te permiten recuperar el acceso si pierdes tu dispositivo 2FA. Guárdalos en un gestor de contraseñas seguro."})]}),e.jsxs(D,{children:[e.jsxs("div",{className:"flex flex-col gap-3 select-none sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs(x,{onClick:d,className:"w-fit","aria-expanded":t,"aria-controls":"recovery-codes-section",children:[e.jsx(m,{className:"size-4","aria-hidden":"true"}),t?"Ocultar":"Ver"," Códigos de Recuperación"]}),o&&e.jsx(g,{...H.form(),options:{preserveScroll:!0},onSuccess:a,children:({processing:l})=>e.jsxs(x,{variant:"secondary",type:"submit",disabled:l,"aria-describedby":"regenerate-warning",children:[e.jsx(ce,{})," Regenerar Códigos"]})})]}),e.jsx("div",{id:"recovery-codes-section",className:`relative overflow-hidden transition-all duration-300 ${t?"h-auto opacity-100":"h-0 opacity-0"}`,"aria-hidden":!t,children:e.jsx("div",{className:"mt-3 space-y-3",children:r?.length?e.jsx(w,{errors:r}):e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:c,className:"grid gap-1 rounded-lg bg-muted p-4 font-mono text-sm",role:"list","aria-label":"Códigos de recuperación",children:s.length?s.map((l,u)=>e.jsx("div",{role:"listitem",className:"select-text",children:l},u)):e.jsx("div",{className:"space-y-2","aria-label":"Cargando códigos de recuperación",children:Array.from({length:8},(l,u)=>e.jsx("div",{className:"h-4 animate-pulse rounded bg-muted-foreground/20","aria-hidden":"true"},u))})}),e.jsx("div",{className:"text-xs text-muted-foreground select-none",children:e.jsxs("p",{id:"regenerate-warning",children:["Cada código de recuperación puede ser usado una vez para acceder a tu cuenta y será eliminado después de su uso. Si necesitas más, haz clic en"," ",e.jsx("span",{className:"font-bold",children:"Regenerar Códigos"})," ","arriba."]})})]})})})]})]})}function je(){const[s,a]=n.useState(null),r=n.useCallback(async t=>{if(!navigator?.clipboard)return console.warn("Clipboard not supported"),!1;try{return await navigator.clipboard.writeText(t),a(t),!0}catch(i){return console.warn("Copy failed",i),a(null),!1}},[]);return[s,r]}function be(){return e.jsx("div",{className:"mb-3 rounded-full border border-border bg-card p-0.5 shadow-sm",children:e.jsxs("div",{className:"relative overflow-hidden rounded-full border border-border bg-muted p-2.5",children:[e.jsx("div",{className:"absolute inset-0 grid grid-cols-5 opacity-50",children:Array.from({length:5},(s,a)=>e.jsx("div",{className:"border-r border-border last:border-r-0"},`col-${a+1}`))}),e.jsx("div",{className:"absolute inset-0 grid grid-rows-5 opacity-50",children:Array.from({length:5},(s,a)=>e.jsx("div",{className:"border-b border-border last:border-b-0"},`row-${a+1}`))}),e.jsx(le,{className:"relative z-20 size-6 text-foreground"})]})})}function ve({qrCodeSvg:s,manualSetupKey:a,buttonText:r,onNextStep:t,errors:i}){const[c,o]=je(),d=c===a?ee:te;return e.jsx(e.Fragment,{children:i?.length?e.jsx(w,{errors:i}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mx-auto flex max-w-md overflow-hidden",children:e.jsx("div",{className:"mx-auto aspect-square w-64 rounded-lg border border-border",children:e.jsx("div",{className:"z-10 flex h-full w-full items-center justify-center p-5",children:s?e.jsx("div",{dangerouslySetInnerHTML:{__html:s}}):e.jsx(y,{className:"flex size-4 animate-spin"})})})}),e.jsx("div",{className:"flex w-full space-x-5",children:e.jsx(x,{className:"w-full",onClick:t,children:r})}),e.jsxs("div",{className:"relative flex w-full items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 top-1/2 h-px w-full bg-border"}),e.jsx("span",{className:"relative bg-card px-2 py-1",children:"o ingresa el código manualmente"})]}),e.jsx("div",{className:"flex w-full space-x-2",children:e.jsx("div",{className:"flex w-full items-stretch overflow-hidden rounded-xl border border-border",children:a?e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",readOnly:!0,value:a,className:"h-full w-full bg-background p-3 text-foreground outline-none"}),e.jsx("button",{onClick:()=>o(a),className:"border-l border-border px-3 hover:bg-muted",children:e.jsx(d,{className:"w-4"})})]}):e.jsx("div",{className:"flex h-full w-full items-center justify-center bg-muted p-3",children:e.jsx(y,{className:"size-4 animate-spin"})})})})]})})}function ye({onClose:s,onBack:a}){const[r,t]=n.useState(""),i=n.useRef(null);return n.useEffect(()=>{setTimeout(()=>{i.current?.querySelector("input")?.focus()},0)},[]),e.jsx(g,{...I.form(),onSuccess:()=>s(),resetOnError:!0,resetOnSuccess:!0,children:({processing:c,errors:o})=>e.jsx(e.Fragment,{children:e.jsxs("div",{ref:i,className:"relative w-full space-y-3",children:[e.jsxs("div",{className:"flex w-full flex-col items-center space-y-3 py-2",children:[e.jsx(J,{id:"otp",name:"code",maxLength:j,onChange:t,disabled:c,pattern:U,children:e.jsx(W,{children:Array.from({length:j},(d,m)=>e.jsx(Y,{index:m},m))})}),e.jsx(P,{message:o?.confirmTwoFactorAuthentication?.code})]}),e.jsxs("div",{className:"flex w-full space-x-5",children:[e.jsx(x,{type:"button",variant:"outline",className:"flex-1",onClick:a,disabled:c,children:"Atrás"}),e.jsx(x,{type:"submit",className:"flex-1",disabled:c||r.length<j,children:"Confirmar"})]})]})})})}function Ne({isOpen:s,onClose:a,requiresConfirmation:r,twoFactorEnabled:t,qrCodeSvg:i,manualSetupKey:c,clearSetupData:o,fetchSetupData:d,errors:m}){const[l,u]=n.useState(!1),p=n.useMemo(()=>t?{title:"Autenticación de Dos Factores Habilitada",description:"La autenticación de dos factores ahora está habilitada. Escanea el código QR o ingresa la clave de configuración en tu aplicación de autenticación.",buttonText:"Cerrar"}:l?{title:"Verificar Código de Autenticación",description:"Ingresa el código de 6 dígitos de tu aplicación de autenticación",buttonText:"Continuar"}:{title:"Habilitar Autenticación de Dos Factores",description:"Para finalizar la habilitación de la autenticación de dos factores, escanea el código QR o ingresa la clave de configuración en tu aplicación de autenticación",buttonText:"Continuar"},[t,l]),h=n.useCallback(()=>{if(r){u(!0);return}o(),a()},[r,o,a]),v=n.useCallback(()=>{u(!1),t&&o()},[t,o]);return n.useEffect(()=>{if(!s){v();return}i||d()},[s,i,d,v]),e.jsx(G,{open:s,onOpenChange:k=>!k&&a(),children:e.jsxs(q,{className:"sm:max-w-md",children:[e.jsxs(K,{className:"flex items-center justify-center",children:[e.jsx(be,{}),e.jsx(Q,{children:p.title}),e.jsx(X,{className:"text-center",children:p.description})]}),e.jsx("div",{className:"flex flex-col items-center space-y-5",children:l?e.jsx(ye,{onClose:a,onBack:()=>u(!1)}):e.jsx(ve,{qrCodeSvg:i,manualSetupKey:c,buttonText:p.buttonText,onNextStep:h,errors:m})})]})})}const Ce=[{title:"Autenticación de Dos Factores",href:R.url()}];function sa({requiresConfirmation:s=!1,twoFactorEnabled:a=!1}){const{qrCodeSvg:r,hasSetupData:t,manualSetupKey:i,clearSetupData:c,fetchSetupData:o,recoveryCodesList:d,fetchRecoveryCodes:m,errors:l}=Z(),[u,p]=n.useState(!1);return e.jsxs(ae,{breadcrumbs:Ce,children:[e.jsx(S,{title:"Autenticación de Dos Factores"}),e.jsx(T,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(A,{title:"Autenticación de Dos Factores",description:"Administra la configuración de autenticación de dos factores"}),a?e.jsxs("div",{className:"flex flex-col items-start justify-start space-y-4",children:[e.jsx(N,{variant:"default",children:"Habilitada"}),e.jsx("p",{className:"text-muted-foreground",children:"Con la autenticación de dos factores habilitada, se te solicitará un código seguro y aleatorio durante el inicio de sesión, el cual puedes obtener desde la aplicación compatible con TOTP en tu teléfono."}),e.jsx(ge,{recoveryCodesList:d,fetchRecoveryCodes:m,errors:l}),e.jsx("div",{className:"relative inline",children:e.jsx(g,{...O.form(),children:({processing:h})=>e.jsxs(x,{variant:"destructive",type:"submit",disabled:h,children:[e.jsx(ue,{})," Deshabilitar 2FA"]})})})]}):e.jsxs("div",{className:"flex flex-col items-start justify-start space-y-4",children:[e.jsx(N,{variant:"destructive",children:"Deshabilitada"}),e.jsx("p",{className:"text-muted-foreground",children:"Cuando habilites la autenticación de dos factores, se te solicitará un código seguro durante el inicio de sesión. Este código puede obtenerse desde una aplicación compatible con TOTP en tu teléfono."}),e.jsx("div",{children:t?e.jsxs(x,{onClick:()=>p(!0),children:[e.jsx(C,{}),"Continuar Configuración"]}):e.jsx(g,{...E.form(),onSuccess:()=>p(!0),children:({processing:h})=>e.jsxs(x,{type:"submit",disabled:h,children:[e.jsx(C,{}),"Habilitar 2FA"]})})})]}),e.jsx(Ne,{isOpen:u,onClose:()=>p(!1),requiresConfirmation:s,twoFactorEnabled:a,qrCodeSvg:r,manualSetupKey:i,clearSetupData:c,fetchSetupData:o,errors:l})]})})]})}export{sa as default};
