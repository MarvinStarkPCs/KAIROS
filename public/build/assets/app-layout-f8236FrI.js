import{r as s,j as c,b as M,a as j}from"./app-LRvzDW_r.js";import{u as O,a as $,c as L}from"./utils-XjUnNJi1.js";import{c as V,a as b}from"./index-CjjoNhbL.js";import{c as S,A as W,D as q,C as U,R as Y,a as X}from"./index-Bx2mhv6c.js";import{P as z}from"./index-CNgS4BR-.js";import{P as J}from"./index-De946CLJ.js";import{M as Q,f as Z}from"./app-header-DOQVwca2.js";import{t as ee,T as te}from"./toaster-D3IbIHo9.js";const P=768;function ne(){const[t,n]=s.useState();return s.useEffect(()=>{const e=window.matchMedia(`(max-width: ${P-1}px)`),r=()=>{n(window.innerWidth<P)};return e.addEventListener("change",r),n(window.innerWidth<P),()=>e.removeEventListener("change",r)},[]),!!t}var[w,Fe]=V("Tooltip",[S]),_=S(),D="TooltipProvider",re=700,I="tooltip.open",[oe,k]=w(D),N=t=>{const{__scopeTooltip:n,delayDuration:e=re,skipDelayDuration:r=300,disableHoverableContent:o=!1,children:a}=t,i=s.useRef(!0),f=s.useRef(!1),l=s.useRef(0);return s.useEffect(()=>{const d=l.current;return()=>window.clearTimeout(d)},[]),c.jsx(oe,{scope:n,isOpenDelayedRef:i,delayDuration:e,onOpen:s.useCallback(()=>{window.clearTimeout(l.current),i.current=!1},[]),onClose:s.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.current=!0,r)},[r]),isPointerInTransitRef:f,onPointerInTransitChange:s.useCallback(d=>{f.current=d},[]),disableHoverableContent:o,children:a})};N.displayName=D;var H="Tooltip",[$e,E]=w(H),A="TooltipTrigger",se=s.forwardRef((t,n)=>{const{__scopeTooltip:e,...r}=t,o=E(A,e),a=k(A,e),i=_(e),f=s.useRef(null),l=O(n,f,o.onTriggerChange),d=s.useRef(!1),u=s.useRef(!1),v=s.useCallback(()=>d.current=!1,[]);return s.useEffect(()=>()=>document.removeEventListener("pointerup",v),[v]),c.jsx(W,{asChild:!0,...i,children:c.jsx(J.button,{"aria-describedby":o.open?o.contentId:void 0,"data-state":o.stateAttribute,...r,ref:l,onPointerMove:b(t.onPointerMove,p=>{p.pointerType!=="touch"&&!u.current&&!a.isPointerInTransitRef.current&&(o.onTriggerEnter(),u.current=!0)}),onPointerLeave:b(t.onPointerLeave,()=>{o.onTriggerLeave(),u.current=!1}),onPointerDown:b(t.onPointerDown,()=>{o.open&&o.onClose(),d.current=!0,document.addEventListener("pointerup",v,{once:!0})}),onFocus:b(t.onFocus,()=>{d.current||o.onOpen()}),onBlur:b(t.onBlur,o.onClose),onClick:b(t.onClick,o.onClose)})})});se.displayName=A;var ae="TooltipPortal",[Ve,ie]=w(ae,{forceMount:void 0}),C="TooltipContent",ce=s.forwardRef((t,n)=>{const e=ie(C,t.__scopeTooltip),{forceMount:r=e.forceMount,side:o="top",...a}=t,i=E(C,t.__scopeTooltip);return c.jsx(z,{present:r||i.open,children:i.disableHoverableContent?c.jsx(B,{side:o,...a,ref:n}):c.jsx(le,{side:o,...a,ref:n})})}),le=s.forwardRef((t,n)=>{const e=E(C,t.__scopeTooltip),r=k(C,t.__scopeTooltip),o=s.useRef(null),a=O(n,o),[i,f]=s.useState(null),{trigger:l,onClose:d}=e,u=o.current,{onPointerInTransitChange:v}=r,p=s.useCallback(()=>{f(null),v(!1)},[v]),y=s.useCallback((h,g)=>{const T=h.currentTarget,x={x:h.clientX,y:h.clientY},m=ve(x,T.getBoundingClientRect()),R=xe(x,m),K=he(g.getBoundingClientRect()),F=ge([...R,...K]);f(F),v(!0)},[v]);return s.useEffect(()=>()=>p(),[p]),s.useEffect(()=>{if(l&&u){const h=T=>y(T,u),g=T=>y(T,l);return l.addEventListener("pointerleave",h),u.addEventListener("pointerleave",g),()=>{l.removeEventListener("pointerleave",h),u.removeEventListener("pointerleave",g)}}},[l,u,y,p]),s.useEffect(()=>{if(i){const h=g=>{const T=g.target,x={x:g.clientX,y:g.clientY},m=l?.contains(T)||u?.contains(T),R=!me(x,i);m?p():R&&(p(),d())};return document.addEventListener("pointermove",h),()=>document.removeEventListener("pointermove",h)}},[l,u,i,d,p]),c.jsx(B,{...t,ref:a})}),[ue,de]=w(H,{isInside:!1}),pe=$("TooltipContent"),B=s.forwardRef((t,n)=>{const{__scopeTooltip:e,children:r,"aria-label":o,onEscapeKeyDown:a,onPointerDownOutside:i,...f}=t,l=E(C,e),d=_(e),{onClose:u}=l;return s.useEffect(()=>(document.addEventListener(I,u),()=>document.removeEventListener(I,u)),[u]),s.useEffect(()=>{if(l.trigger){const v=p=>{p.target?.contains(l.trigger)&&u()};return window.addEventListener("scroll",v,{capture:!0}),()=>window.removeEventListener("scroll",v,{capture:!0})}},[l.trigger,u]),c.jsx(q,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:a,onPointerDownOutside:i,onFocusOutside:v=>v.preventDefault(),onDismiss:u,children:c.jsxs(U,{"data-state":l.stateAttribute,...d,...f,ref:n,style:{...f.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[c.jsx(pe,{children:r}),c.jsx(ue,{scope:e,isInside:!0,children:c.jsx(Y,{id:l.contentId,role:"tooltip",children:o||r})})]})})});ce.displayName=C;var G="TooltipArrow",fe=s.forwardRef((t,n)=>{const{__scopeTooltip:e,...r}=t,o=_(e);return de(G,e).isInside?null:c.jsx(X,{...o,...r,ref:n})});fe.displayName=G;function ve(t,n){const e=Math.abs(n.top-t.y),r=Math.abs(n.bottom-t.y),o=Math.abs(n.right-t.x),a=Math.abs(n.left-t.x);switch(Math.min(e,r,o,a)){case a:return"left";case o:return"right";case e:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function xe(t,n,e=5){const r=[];switch(n){case"top":r.push({x:t.x-e,y:t.y+e},{x:t.x+e,y:t.y+e});break;case"bottom":r.push({x:t.x-e,y:t.y-e},{x:t.x+e,y:t.y-e});break;case"left":r.push({x:t.x+e,y:t.y-e},{x:t.x+e,y:t.y+e});break;case"right":r.push({x:t.x-e,y:t.y-e},{x:t.x-e,y:t.y+e});break}return r}function he(t){const{top:n,right:e,bottom:r,left:o}=t;return[{x:o,y:n},{x:e,y:n},{x:e,y:r},{x:o,y:r}]}function me(t,n){const{x:e,y:r}=t;let o=!1;for(let a=0,i=n.length-1;a<n.length;i=a++){const f=n[a],l=n[i],d=f.x,u=f.y,v=l.x,p=l.y;u>r!=p>r&&e<(v-d)*(r-u)/(p-u)+d&&(o=!o)}return o}function ge(t){const n=t.slice();return n.sort((e,r)=>e.x<r.x?-1:e.x>r.x?1:e.y<r.y?-1:e.y>r.y?1:0),ye(n)}function ye(t){if(t.length<=1)return t.slice();const n=[];for(let r=0;r<t.length;r++){const o=t[r];for(;n.length>=2;){const a=n[n.length-1],i=n[n.length-2];if((a.x-i.x)*(o.y-i.y)>=(a.y-i.y)*(o.x-i.x))n.pop();else break}n.push(o)}n.pop();const e=[];for(let r=t.length-1;r>=0;r--){const o=t[r];for(;e.length>=2;){const a=e[e.length-1],i=e[e.length-2];if((a.x-i.x)*(o.y-i.y)>=(a.y-i.y)*(o.x-i.x))e.pop();else break}e.push(o)}return e.pop(),n.length===1&&e.length===1&&n[0].x===e[0].x&&n[0].y===e[0].y?n:n.concat(e)}var Te=N;function be({delayDuration:t=0,...n}){return c.jsx(Te,{"data-slot":"tooltip-provider",delayDuration:t,...n})}const Ce="sidebar_state",we=3600*24*7,Ee="16rem",Re="3rem",Pe="b",Ae=s.createContext(null);function _e({defaultOpen:t=!0,open:n,onOpenChange:e,className:r,style:o,children:a,...i}){const f=ne(),[l,d]=s.useState(!1),[u,v]=s.useState(t),p=n??u,y=s.useCallback(x=>{const m=typeof x=="function"?x(p):x;e?e(m):v(m),document.cookie=`${Ce}=${m}; path=/; max-age=${we}`},[e,p]),h=s.useCallback(()=>f?d(x=>!x):y(x=>!x),[f,y,d]);s.useEffect(()=>{const x=m=>{m.key===Pe&&(m.metaKey||m.ctrlKey)&&(m.preventDefault(),h())};return window.addEventListener("keydown",x),()=>window.removeEventListener("keydown",x)},[h]);const g=p?"expanded":"collapsed",T=s.useMemo(()=>({state:g,open:p,setOpen:y,isMobile:f,openMobile:l,setOpenMobile:d,toggleSidebar:h}),[g,p,y,f,l,d,h]);return c.jsx(Ae.Provider,{value:T,children:c.jsx(be,{delayDuration:0,children:c.jsx("div",{"data-slot":"sidebar-wrapper",style:{"--sidebar-width":Ee,"--sidebar-width-icon":Re,...o},className:L("group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full",r),...i,children:a})})})}function je({className:t,...n}){return c.jsx("main",{"data-slot":"sidebar-inset",className:L("bg-background relative flex max-w-full min-h-svh flex-1 flex-col","peer-data-[variant=inset]:min-h-[calc(100svh-(--spacing(4)))] md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-0",t),...n})}function Ie({variant:t="header",children:n,...e}){return t==="sidebar"?c.jsx(je,{...e,children:n}):c.jsx("main",{className:"flex h-full w-full flex-1 flex-col bg-background p-6",...e,children:n})}function Me({children:t,variant:n="header"}){const e=M().props.sidebarOpen;return n==="header"?c.jsx("div",{className:"flex min-h-screen w-full flex-col",children:t}):c.jsx(_e,{defaultOpen:e,children:t})}function Oe(){const t=M(),{auth:n}=t.props,e=n.unreadMessages||0,r=s.useRef(null),o=s.useRef(!0);return s.useEffect(()=>{const a=setInterval(()=>{j.reload({only:["auth"],preserveScroll:!0,preserveState:!0})},5e3);return()=>clearInterval(a)},[]),s.useEffect(()=>{if(o.current){r.current=e,o.current=!1,console.log("Initial unread count:",e);return}if(r.current!==null&&e>r.current){const a=e-r.current;console.log("New messages detected:",a,"Previous:",r.current,"Current:",e),ee.info(a===1?"Tienes un nuevo mensaje":`Tienes ${a} mensajes nuevos`,{icon:c.jsx(Q,{className:"h-4 w-4"}),duration:5e3,action:{label:"Ver",onClick:()=>j.visit("/comunicacion")}})}r.current=e},[e]),null}function Le({children:t,breadcrumbs:n}){return c.jsxs(Me,{children:[c.jsx(Z,{breadcrumbs:n}),c.jsx(Ie,{children:t}),c.jsx(te,{}),c.jsx(Oe,{})]})}const We=({children:t,breadcrumbs:n,...e})=>c.jsx(Le,{breadcrumbs:n,...e,children:t});export{We as A};
