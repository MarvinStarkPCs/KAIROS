import{r as d,a as _,j as e,H as se}from"./app-_rOQn_46.js";import{A as re}from"./app-layout-CLhCFhGY.js";import{H as ae}from"./heading-Beyxv07U.js";import{B as u}from"./button-Cwjg0RKq.js";import{I as S}from"./input-C_eRjc1n.js";import{X,S as de,A as b,a as C,b as N}from"./app-header-uhUDMoS0.js";import{B as le}from"./badge-CxkKJAJ8.js";import{D as oe,a as ne,b as ie,c as ce,d as me}from"./dialog-DY_ZgsD6.js";import{S as T,a as A,b as E,c as P,d as l}from"./select-fBj-5ZE1.js";import{C as q}from"./check-DD34Qu--.js";import{C as D}from"./clock-92yNzH6p.js";import{T as xe}from"./trending-up-DHKvHuhP.js";import{F as ue}from"./filter-BrnGtBRn.js";import{D as he}from"./download-BVSzuHpF.js";import{C as ge}from"./calendar-DwYwQP4N.js";import{E as pe}from"./eye-HnW50b-k.js";import{C as fe}from"./chevron-left-D4ydDAw0.js";import{C as je}from"./chevron-right-KvpbVvzH.js";import{T as be}from"./triangle-alert-ncTQFx2-.js";import{F as Ne}from"./file-text-CqZet-U8.js";/* empty css            */import"./utils-CHYGzkwl.js";import"./index-kZXzX9CC.js";import"./index-C0WYYgI1.js";import"./createLucideIcon-BTUecZaa.js";import"./index-DhMGY2fr.js";import"./index-LDKjRhno.js";import"./index-86eqSqYr.js";import"./toaster-DF114ULM.js";import"./index-HbNiKBAr.js";import"./index-B4ow9L1E.js";import"./index-CLa6oRL-.js";import"./wayfinder-Bf9OnZdi.js";import"./index-D12nj1Ca.js";import"./book-open-d3nfV-Db.js";import"./graduation-cap-h2z_kizA.js";import"./users-CU2UoBYp.js";import"./credit-card-CtYZ3YyT.js";import"./lock-BoKNE-VZ.js";import"./shield-DI4dg6mj.js";import"./chevron-down-gmsC21Id.js";import"./loader-circle-eUOhA3c_.js";import"./mail-DuzhTNEq.js";function ct({asistenciaHoy:p={total:0,presentes:0,porcentaje:"0%"},ausencias:G=0,tardanzas:K=0,promedioMensual:Q="0%",asistencias:r,alertas:I=[],filters:o,programs:W=[],professors:Y=[]}){const[n,B]=d.useState(o?.search||""),[i,H]=d.useState(o?.status||""),[c,$]=d.useState(o?.program_id||""),[m,F]=d.useState(o?.professor_id||""),[h,z]=d.useState(o?.date_from||""),[g,R]=d.useState(o?.date_to||""),[v,Z]=d.useState(!1),[a,V]=d.useState(null);d.useEffect(()=>{const t=setTimeout(()=>{n!==(o?.search||"")&&x({search:n})},500);return()=>clearTimeout(t)},[n]);const x=(t={})=>{const s={},j=t.search!==void 0?t.search:n,w=t.status!==void 0?t.status:i,y=t.program_id!==void 0?t.program_id:c,k=t.professor_id!==void 0?t.professor_id:m,U=t.date_from!==void 0?t.date_from:h,O=t.date_to!==void 0?t.date_to:g;j&&(s.search=j),w&&w!=="all"&&(s.status=w),y&&y!=="all"&&(s.program_id=y),k&&k!=="all"&&(s.professor_id=k),U&&(s.date_from=U),O&&(s.date_to=O),_.get("/asistencia",s,{preserveState:!0,preserveScroll:!0})},ee=()=>{B(""),H(""),$(""),F(""),z(""),R(""),_.get("/asistencia")},J=t=>{const s={page:t.toString()};n&&(s.search=n),i&&i!=="all"&&(s.status=i),c&&c!=="all"&&(s.program_id=c),m&&m!=="all"&&(s.professor_id=m),h&&(s.date_from=h),g&&(s.date_to=g),_.get("/asistencia",s,{preserveState:!0,preserveScroll:!0})},L=t=>{switch(t){case"presente":return{bg:"bg-green-100 dark:bg-green-900/30",text:"text-green-700 dark:text-green-300",icon:q,label:"Presente"};case"ausente":return{bg:"bg-red-100 dark:bg-red-900/30",text:"text-red-700 dark:text-red-300",icon:X,label:"Ausente"};case"tardanza":return{bg:"bg-yellow-100 dark:bg-yellow-900/30",text:"text-yellow-700 dark:text-yellow-300",icon:D,label:"Tarde"};case"justificado":return{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-700 dark:text-blue-300",icon:Ne,label:"Justificado"};default:return{bg:"bg-muted",text:"text-muted-foreground",icon:D,label:"Pendiente"}}},te=t=>{switch(t){case"critico":return{bg:"bg-red-50 dark:bg-red-950/30",border:"border-red-200 dark:border-red-800",text:"text-red-700 dark:text-red-300",badge:"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-200"};case"atencion":return{bg:"bg-yellow-50 dark:bg-yellow-950/30",border:"border-yellow-200 dark:border-yellow-800",text:"text-yellow-700 dark:text-yellow-300",badge:"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-200"};case"seguimiento":return{bg:"bg-blue-50 dark:bg-blue-950/30",border:"border-blue-200 dark:border-blue-800",text:"text-blue-700 dark:text-blue-300",badge:"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200"};default:return{bg:"bg-muted",border:"border-border",text:"text-muted-foreground",badge:"bg-muted text-foreground"}}},f=t=>t.split(" ").map(s=>s[0]).join("").toUpperCase().slice(0,2),M=i&&i!=="all"||c&&c!=="all"||m&&m!=="all"||h||g;return e.jsxs(re,{children:[e.jsx(se,{title:"Control de Asistencia"}),e.jsx(ae,{title:"Control de Asistencia",description:"Registro y seguimiento de asistencia estudiantil"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-card rounded-lg p-6 shadow-sm border border-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Asistencia Hoy"}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center",children:e.jsx(q,{className:"w-5 h-5 text-green-600"})})]}),e.jsxs("div",{className:"text-3xl font-bold text-foreground mb-2",children:[p.presentes,"/",p.total]}),e.jsxs("div",{className:"text-xs text-green-600 font-medium mb-2",children:[p.porcentaje," de asistencia"]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"bg-green-500 h-full rounded-full transition-all duration-500",style:{width:p.porcentaje}})})]}),e.jsxs("div",{className:"bg-card rounded-lg p-6 shadow-sm border border-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Ausencias"}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center",children:e.jsx(X,{className:"w-5 h-5 text-red-600"})})]}),e.jsx("div",{className:"text-3xl font-bold text-foreground mb-2",children:G}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Sin justificar"}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Hoy"})]}),e.jsxs("div",{className:"bg-card rounded-lg p-6 shadow-sm border border-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Tardanzas"}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-yellow-100 dark:bg-yellow-900/30 flex items-center justify-center",children:e.jsx(D,{className:"w-5 h-5 text-yellow-600"})})]}),e.jsx("div",{className:"text-3xl font-bold text-foreground mb-2",children:K}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Hoy"}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Estudiantes"})]}),e.jsxs("div",{className:"bg-card rounded-lg p-6 shadow-sm border border-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Promedio Mensual"}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center",children:e.jsx(xe,{className:"w-5 h-5 text-blue-600"})})]}),e.jsx("div",{className:"text-3xl font-bold text-foreground mb-2",children:Q}),e.jsx("div",{className:"text-xs text-green-600 font-medium",children:"Este mes"})]})]}),e.jsxs("div",{className:"bg-card rounded-lg shadow-sm mb-6 p-4",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(de,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(S,{type:"text",placeholder:"Buscar por nombre o email del estudiante...",value:n,onChange:t=>B(t.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(u,{variant:v?"default":"outline",onClick:()=>Z(!v),className:"flex items-center gap-2",children:[e.jsx(ue,{className:"w-4 h-4"}),"Filtros",M&&e.jsx(le,{className:"bg-red-500 text-white ml-1",children:"!"})]}),M&&e.jsx(u,{variant:"ghost",onClick:ee,children:"Limpiar"}),e.jsxs(u,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(he,{className:"w-4 h-4"}),"Exportar"]})]})]}),v&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mt-4 pt-4 border-t",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-1",children:"Estado"}),e.jsxs(T,{value:i,onValueChange:t=>{H(t),x({status:t})},children:[e.jsx(A,{children:e.jsx(E,{placeholder:"Todos los estados"})}),e.jsxs(P,{children:[e.jsx(l,{value:"all",children:"Todos los estados"}),e.jsx(l,{value:"present",children:"Presente"}),e.jsx(l,{value:"late",children:"Tarde"}),e.jsx(l,{value:"absent",children:"Ausente"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-1",children:"Programa"}),e.jsxs(T,{value:c,onValueChange:t=>{$(t),x({program_id:t})},children:[e.jsx(A,{children:e.jsx(E,{placeholder:"Todos los programas"})}),e.jsxs(P,{children:[e.jsx(l,{value:"all",children:"Todos los programas"}),W.map(t=>e.jsx(l,{value:t.id.toString(),children:t.name},t.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-1",children:"Profesor"}),e.jsxs(T,{value:m,onValueChange:t=>{F(t),x({professor_id:t})},children:[e.jsx(A,{children:e.jsx(E,{placeholder:"Todos los profesores"})}),e.jsxs(P,{children:[e.jsx(l,{value:"all",children:"Todos los profesores"}),Y.map(t=>e.jsx(l,{value:t.id.toString(),children:t.name},t.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-1",children:"Desde"}),e.jsx(S,{type:"date",value:h,onChange:t=>{z(t.target.value),x({date_from:t.target.value})}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-1",children:"Hasta"}),e.jsx(S,{type:"date",value:g,onChange:t=>{R(t.target.value),x({date_to:t.target.value})}})]})]})]}),e.jsxs("div",{className:"bg-card rounded-lg shadow-sm mb-6 overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-800 text-white p-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Historial de Asistencias"}),e.jsxs("div",{className:"text-sm text-gray-300",children:[r?.total||0," registros encontrados"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted border-b border-border",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:"Fecha"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:"Estudiante"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:"Programa"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:"Profesor"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:"Estado"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:"Justificación"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:"Acciones"})]})}),e.jsx("tbody",{className:"bg-card divide-y divide-border",children:r?.data?.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-12 text-center text-muted-foreground",children:"No se encontraron registros de asistencia"})}):r?.data?.map(t=>{const s=L(t.estado),j=s.icon;return e.jsxs("tr",{className:"hover:bg-muted",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ge,{className:"w-4 h-4 text-muted-foreground mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-foreground",children:t.fecha_formato}),e.jsx("div",{className:"text-xs text-muted-foreground",children:t.hora})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs(b,{className:"h-9 w-9 mr-3",children:[e.jsx(C,{src:t.estudiante.avatar}),e.jsx(N,{className:"bg-[#7a9b3c] text-white text-xs",children:f(t.estudiante.nombre)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-foreground",children:t.estudiante.nombre}),e.jsx("div",{className:"text-xs text-muted-foreground",children:t.estudiante.email})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"inline-block w-2 h-2 rounded-full mr-2",style:{backgroundColor:t.programa.color}}),e.jsx("span",{className:"text-sm text-foreground",children:t.programa.nombre})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs(b,{className:"h-7 w-7 mr-2",children:[e.jsx(C,{src:t.profesor.avatar}),e.jsx(N,{className:"bg-gray-400 text-white text-xs",children:f(t.profesor.nombre)})]}),e.jsx("span",{className:"text-sm text-foreground",children:t.profesor.nombre})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium ${s.bg} ${s.text}`,children:[e.jsx(j,{className:"w-3 h-3 mr-1"}),s.label]})}),e.jsx("td",{className:"px-6 py-4",children:t.notas?e.jsx("div",{className:"max-w-xs",children:e.jsx("p",{className:"text-sm text-muted-foreground truncate",title:t.notas,children:t.notas})}):e.jsx("span",{className:"text-sm text-muted-foreground",children:"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:e.jsx(u,{size:"sm",variant:"ghost",onClick:()=>V(t),children:e.jsx(pe,{className:"w-4 h-4 text-blue-600"})})})]},t.id)})})]})}),r?.last_page>1&&e.jsxs("div",{className:"px-6 py-4 border-t border-border flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Mostrando ",r.from," a ",r.to," de ",r.total," registros"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{variant:"outline",size:"sm",onClick:()=>J(r.current_page-1),disabled:r.current_page===1,children:e.jsx(fe,{className:"w-4 h-4"})}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Página ",r.current_page," de ",r.last_page]}),e.jsx(u,{variant:"outline",size:"sm",onClick:()=>J(r.current_page+1),disabled:r.current_page===r.last_page,children:e.jsx(je,{className:"w-4 h-4"})})]})]})]}),I.length>0&&e.jsxs("div",{className:"bg-card rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(be,{className:"w-5 h-5 text-orange-600"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Estudiantes con Alertas"})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:I.map(t=>{const s=te(t.tipo);return e.jsx("div",{className:`rounded-lg p-4 border ${s.bg} ${s.border}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs(b,{className:"h-10 w-10",children:[e.jsx(C,{src:t.estudiante.avatar}),e.jsx(N,{className:"bg-gray-400 text-white text-xs",children:f(t.estudiante.nombre)})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-foreground",children:t.estudiante.nombre}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t.estudiante.clase})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${s.badge}`,children:t.tipo==="critico"?"Crítico":t.tipo==="atencion"?"Atención":"Seguimiento"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:t.mensaje})]})]})},t.id)})})]}),e.jsx(oe,{open:!!a,onOpenChange:()=>V(null),children:e.jsxs(ne,{className:"max-w-lg",children:[e.jsxs(ie,{children:[e.jsx(ce,{children:"Detalle de Asistencia"}),e.jsx(me,{children:"Información completa del registro de asistencia"})]}),a&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted rounded-lg",children:[e.jsx(b,{className:"h-12 w-12",children:e.jsx(N,{className:"bg-[#7a9b3c] text-white",children:f(a.estudiante.nombre)})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-foreground",children:a.estudiante.nombre}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.estudiante.email})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground uppercase",children:"Fecha"}),e.jsx("p",{className:"font-medium",children:a.fecha_formato})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground uppercase",children:"Hora de clase"}),e.jsx("p",{className:"font-medium",children:a.hora})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground uppercase",children:"Programa"}),e.jsx("p",{className:"font-medium",children:a.programa.nombre})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground uppercase",children:"Profesor"}),e.jsx("p",{className:"font-medium",children:a.profesor.nombre})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground uppercase",children:"Estado"}),e.jsx("div",{className:"mt-1",children:(()=>{const t=L(a.estado),s=t.icon;return e.jsxs("span",{className:`inline-flex items-center px-3 py-1.5 rounded-full text-sm font-medium ${t.bg} ${t.text}`,children:[e.jsx(s,{className:"w-4 h-4 mr-1"}),t.label]})})()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground uppercase",children:"Justificación / Notas"}),a.notas?e.jsx("div",{className:"mt-1 p-3 bg-yellow-50 dark:bg-yellow-950/30 border border-yellow-200 dark:border-yellow-800 rounded-lg",children:e.jsx("p",{className:"text-sm text-foreground",children:a.notas})}):e.jsx("p",{className:"mt-1 text-muted-foreground italic",children:"Sin justificación registrada"})]}),e.jsxs("div",{className:"pt-3 border-t text-xs text-muted-foreground",children:[e.jsxs("p",{children:["Registrado por: ",a.registrado_por]}),e.jsxs("p",{children:["Fecha de registro: ",a.created_at]})]})]})]})})]})}export{ct as default};
