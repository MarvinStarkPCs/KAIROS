import{r as l,a as S,j as e,H as te}from"./app-DQdfAIrT.js";import{A as ae}from"./app-layout-4clgNQ85.js";import{H as re}from"./heading-CxiBdtUP.js";import{B as h}from"./button-VerjejBs.js";import{I as C}from"./input-j1xB4kZV.js";import{X,S as le,A as f,a as T,b as N}from"./app-header-BJ6Qh71R.js";import{B as de}from"./badge-D23JO_t_.js";import{D as ie,a as ce,b as oe,c as ne,d as xe}from"./dialog-Cz5AvGta.js";import{S as A,a as k,b as E,c as P,d}from"./select-BLHirN0A.js";import{C as q}from"./check-Bw5X6T2g.js";import{C as D}from"./clock-DUL3GtND.js";import{T as me}from"./trending-up-DPrquOAm.js";import{F as he}from"./filter-ha--0tlg.js";import{D as ge}from"./download-DTZSOHv_.js";import{C as pe}from"./calendar-YX0MwFSw.js";import{E as je}from"./eye-jtjOBm3q.js";import{C as ue}from"./chevron-left-FmUg31xs.js";import{C as be}from"./chevron-right-Bj574-qT.js";import{T as fe}from"./triangle-alert-0XJMW1br.js";import{F as Ne}from"./file-text-CdhlA8Sa.js";import"./app-C-cf51TB.js";import"./utils-CBfrqCZ4.js";import"./index-CfWGIfzM.js";import"./index-C7yH7irC.js";import"./index-DgJsnbTO.js";import"./createLucideIcon-FBGZZ2XP.js";import"./index-C47Lcm81.js";import"./index-IgmI3j8n.js";import"./index-BzC76F-K.js";import"./toaster-B_zTenYs.js";import"./index-CdJFUDDL.js";import"./index-Q9OWOLmH.js";import"./index-BGHOW37F.js";import"./wayfinder-Bf9OnZdi.js";import"./index-DvImgo4L.js";import"./graduation-cap-BqNDqZIZ.js";import"./users-D1XkPNsH.js";import"./credit-card-BIFgk_mu.js";import"./lock-Bhi6MTHY.js";import"./shield-DJVllbGN.js";import"./mail-C6vpu2CA.js";function cs({asistenciaHoy:j={total:0,presentes:0,porcentaje:"0%"},ausencias:G=0,tardanzas:K=0,promedioMensual:Q="0%",asistencias:a,alertas:I=[],filters:i,programs:W=[],professors:Y=[]}){const[c,B]=l.useState(i?.search||""),[o,H]=l.useState(i?.status||""),[n,$]=l.useState(i?.program_id||""),[x,F]=l.useState(i?.professor_id||""),[g,z]=l.useState(i?.date_from||""),[p,R]=l.useState(i?.date_to||""),[y,Z]=l.useState(!1),[r,V]=l.useState(null);l.useEffect(()=>{const s=setTimeout(()=>{c!==(i?.search||"")&&m({search:c})},500);return()=>clearTimeout(s)},[c]);const m=(s={})=>{const t={},b=s.search!==void 0?s.search:c,v=s.status!==void 0?s.status:o,w=s.program_id!==void 0?s.program_id:n,_=s.professor_id!==void 0?s.professor_id:x,U=s.date_from!==void 0?s.date_from:g,O=s.date_to!==void 0?s.date_to:p;b&&(t.search=b),v&&v!=="all"&&(t.status=v),w&&w!=="all"&&(t.program_id=w),_&&_!=="all"&&(t.professor_id=_),U&&(t.date_from=U),O&&(t.date_to=O),S.get("/asistencia",t,{preserveState:!0,preserveScroll:!0})},ee=()=>{B(""),H(""),$(""),F(""),z(""),R(""),S.get("/asistencia")},J=s=>{const t={page:s.toString()};c&&(t.search=c),o&&o!=="all"&&(t.status=o),n&&n!=="all"&&(t.program_id=n),x&&x!=="all"&&(t.professor_id=x),g&&(t.date_from=g),p&&(t.date_to=p),S.get("/asistencia",t,{preserveState:!0,preserveScroll:!0})},L=s=>{switch(s){case"presente":return{bg:"bg-green-100",text:"text-green-700",icon:q,label:"Presente"};case"ausente":return{bg:"bg-red-100",text:"text-red-700",icon:X,label:"Ausente"};case"tardanza":return{bg:"bg-yellow-100",text:"text-yellow-700",icon:D,label:"Tarde"};case"justificado":return{bg:"bg-blue-100",text:"text-blue-700",icon:Ne,label:"Justificado"};default:return{bg:"bg-gray-100",text:"text-gray-700",icon:D,label:"Pendiente"}}},se=s=>{switch(s){case"critico":return{bg:"bg-red-50",border:"border-red-200",text:"text-red-700",badge:"bg-red-100 text-red-800"};case"atencion":return{bg:"bg-yellow-50",border:"border-yellow-200",text:"text-yellow-700",badge:"bg-yellow-100 text-yellow-800"};case"seguimiento":return{bg:"bg-blue-50",border:"border-blue-200",text:"text-blue-700",badge:"bg-blue-100 text-blue-800"};default:return{bg:"bg-gray-50",border:"border-gray-200",text:"text-gray-700",badge:"bg-gray-100 text-gray-800"}}},u=s=>s.split(" ").map(t=>t[0]).join("").toUpperCase().slice(0,2),M=o&&o!=="all"||n&&n!=="all"||x&&x!=="all"||g||p;return e.jsxs(ae,{children:[e.jsx(te,{title:"Control de Asistencia"}),e.jsx(re,{title:"Control de Asistencia",description:"Registro y seguimiento de asistencia estudiantil"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Asistencia Hoy"}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-green-100 flex items-center justify-center",children:e.jsx(q,{className:"w-5 h-5 text-green-600"})})]}),e.jsxs("div",{className:"text-3xl font-bold text-gray-900 mb-2",children:[j.presentes,"/",j.total]}),e.jsxs("div",{className:"text-xs text-green-600 font-medium mb-2",children:[j.porcentaje," de asistencia"]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"bg-green-500 h-full rounded-full transition-all duration-500",style:{width:j.porcentaje}})})]}),e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Ausencias"}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx(X,{className:"w-5 h-5 text-red-600"})})]}),e.jsx("div",{className:"text-3xl font-bold text-gray-900 mb-2",children:G}),e.jsx("div",{className:"text-xs text-gray-500",children:"Sin justificar"}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Hoy"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Tardanzas"}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-yellow-100 flex items-center justify-center",children:e.jsx(D,{className:"w-5 h-5 text-yellow-600"})})]}),e.jsx("div",{className:"text-3xl font-bold text-gray-900 mb-2",children:K}),e.jsx("div",{className:"text-xs text-gray-500",children:"Hoy"}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Estudiantes"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Promedio Mensual"}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx(me,{className:"w-5 h-5 text-blue-600"})})]}),e.jsx("div",{className:"text-3xl font-bold text-gray-900 mb-2",children:Q}),e.jsx("div",{className:"text-xs text-green-600 font-medium",children:"Este mes"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm mb-6 p-4",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(C,{type:"text",placeholder:"Buscar por nombre o email del estudiante...",value:c,onChange:s=>B(s.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(h,{variant:y?"default":"outline",onClick:()=>Z(!y),className:"flex items-center gap-2",children:[e.jsx(he,{className:"w-4 h-4"}),"Filtros",M&&e.jsx(de,{className:"bg-red-500 text-white ml-1",children:"!"})]}),M&&e.jsx(h,{variant:"ghost",onClick:ee,children:"Limpiar"}),e.jsxs(h,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4"}),"Exportar"]})]})]}),y&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mt-4 pt-4 border-t",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado"}),e.jsxs(A,{value:o,onValueChange:s=>{H(s),m({status:s})},children:[e.jsx(k,{children:e.jsx(E,{placeholder:"Todos los estados"})}),e.jsxs(P,{children:[e.jsx(d,{value:"all",children:"Todos los estados"}),e.jsx(d,{value:"present",children:"Presente"}),e.jsx(d,{value:"late",children:"Tarde"}),e.jsx(d,{value:"absent",children:"Ausente"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Programa"}),e.jsxs(A,{value:n,onValueChange:s=>{$(s),m({program_id:s})},children:[e.jsx(k,{children:e.jsx(E,{placeholder:"Todos los programas"})}),e.jsxs(P,{children:[e.jsx(d,{value:"all",children:"Todos los programas"}),W.map(s=>e.jsx(d,{value:s.id.toString(),children:s.name},s.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Profesor"}),e.jsxs(A,{value:x,onValueChange:s=>{F(s),m({professor_id:s})},children:[e.jsx(k,{children:e.jsx(E,{placeholder:"Todos los profesores"})}),e.jsxs(P,{children:[e.jsx(d,{value:"all",children:"Todos los profesores"}),Y.map(s=>e.jsx(d,{value:s.id.toString(),children:s.name},s.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Desde"}),e.jsx(C,{type:"date",value:g,onChange:s=>{z(s.target.value),m({date_from:s.target.value})}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hasta"}),e.jsx(C,{type:"date",value:p,onChange:s=>{R(s.target.value),m({date_to:s.target.value})}})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm mb-6 overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-800 text-white p-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Historial de Asistencias"}),e.jsxs("div",{className:"text-sm text-gray-300",children:[a?.total||0," registros encontrados"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Fecha"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Estudiante"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Programa"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Profesor"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Estado"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Justificación"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Acciones"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a?.data?.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-500",children:"No se encontraron registros de asistencia"})}):a?.data?.map(s=>{const t=L(s.estado),b=t.icon;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(pe,{className:"w-4 h-4 text-gray-400 mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.fecha_formato}),e.jsx("div",{className:"text-xs text-gray-500",children:s.hora})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs(f,{className:"h-9 w-9 mr-3",children:[e.jsx(T,{src:s.estudiante.avatar}),e.jsx(N,{className:"bg-[#7a9b3c] text-white text-xs",children:u(s.estudiante.nombre)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.estudiante.nombre}),e.jsx("div",{className:"text-xs text-gray-500",children:s.estudiante.email})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"inline-block w-2 h-2 rounded-full mr-2",style:{backgroundColor:s.programa.color}}),e.jsx("span",{className:"text-sm text-gray-900",children:s.programa.nombre})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs(f,{className:"h-7 w-7 mr-2",children:[e.jsx(T,{src:s.profesor.avatar}),e.jsx(N,{className:"bg-gray-400 text-white text-xs",children:u(s.profesor.nombre)})]}),e.jsx("span",{className:"text-sm text-gray-900",children:s.profesor.nombre})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium ${t.bg} ${t.text}`,children:[e.jsx(b,{className:"w-3 h-3 mr-1"}),t.label]})}),e.jsx("td",{className:"px-6 py-4",children:s.notas?e.jsx("div",{className:"max-w-xs",children:e.jsx("p",{className:"text-sm text-gray-700 truncate",title:s.notas,children:s.notas})}):e.jsx("span",{className:"text-sm text-gray-400",children:"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:e.jsx(h,{size:"sm",variant:"ghost",onClick:()=>V(s),children:e.jsx(je,{className:"w-4 h-4 text-blue-600"})})})]},s.id)})})]})}),a?.last_page>1&&e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Mostrando ",a.from," a ",a.to," de ",a.total," registros"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{variant:"outline",size:"sm",onClick:()=>J(a.current_page-1),disabled:a.current_page===1,children:e.jsx(ue,{className:"w-4 h-4"})}),e.jsxs("span",{className:"text-sm text-gray-700",children:["Página ",a.current_page," de ",a.last_page]}),e.jsx(h,{variant:"outline",size:"sm",onClick:()=>J(a.current_page+1),disabled:a.current_page===a.last_page,children:e.jsx(be,{className:"w-4 h-4"})})]})]})]}),I.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(fe,{className:"w-5 h-5 text-orange-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Estudiantes con Alertas"})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:I.map(s=>{const t=se(s.tipo);return e.jsx("div",{className:`rounded-lg p-4 border ${t.bg} ${t.border}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs(f,{className:"h-10 w-10",children:[e.jsx(T,{src:s.estudiante.avatar}),e.jsx(N,{className:"bg-gray-400 text-white text-xs",children:u(s.estudiante.nombre)})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:s.estudiante.nombre}),e.jsx("p",{className:"text-xs text-gray-600",children:s.estudiante.clase})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${t.badge}`,children:s.tipo==="critico"?"Crítico":s.tipo==="atencion"?"Atención":"Seguimiento"})]}),e.jsx("p",{className:"text-sm text-gray-700 mt-2",children:s.mensaje})]})]})},s.id)})})]}),e.jsx(ie,{open:!!r,onOpenChange:()=>V(null),children:e.jsxs(ce,{className:"max-w-lg",children:[e.jsxs(oe,{children:[e.jsx(ne,{children:"Detalle de Asistencia"}),e.jsx(xe,{children:"Información completa del registro de asistencia"})]}),r&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx(f,{className:"h-12 w-12",children:e.jsx(N,{className:"bg-[#7a9b3c] text-white",children:u(r.estudiante.nombre)})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:r.estudiante.nombre}),e.jsx("p",{className:"text-sm text-gray-500",children:r.estudiante.email})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 uppercase",children:"Fecha"}),e.jsx("p",{className:"font-medium",children:r.fecha_formato})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 uppercase",children:"Hora de clase"}),e.jsx("p",{className:"font-medium",children:r.hora})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 uppercase",children:"Programa"}),e.jsx("p",{className:"font-medium",children:r.programa.nombre})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 uppercase",children:"Profesor"}),e.jsx("p",{className:"font-medium",children:r.profesor.nombre})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 uppercase",children:"Estado"}),e.jsx("div",{className:"mt-1",children:(()=>{const s=L(r.estado),t=s.icon;return e.jsxs("span",{className:`inline-flex items-center px-3 py-1.5 rounded-full text-sm font-medium ${s.bg} ${s.text}`,children:[e.jsx(t,{className:"w-4 h-4 mr-1"}),s.label]})})()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 uppercase",children:"Justificación / Notas"}),r.notas?e.jsx("div",{className:"mt-1 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-gray-800",children:r.notas})}):e.jsx("p",{className:"mt-1 text-gray-400 italic",children:"Sin justificación registrada"})]}),e.jsxs("div",{className:"pt-3 border-t text-xs text-gray-500",children:[e.jsxs("p",{children:["Registrado por: ",r.registrado_por]}),e.jsxs("p",{children:["Fecha de registro: ",r.created_at]})]})]})]})})]})}export{cs as default};
