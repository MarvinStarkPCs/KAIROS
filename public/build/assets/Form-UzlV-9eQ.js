import{r as g,u as w,j as e,H as C,L as j}from"./app-C8NcURSt.js";import{B as v}from"./button-BHGJkybb.js";import{I as m}from"./input-CnyLQRSQ.js";import{L as o}from"./label-CowgzNXD.js";import{T as P}from"./textarea-C7NG7dV9.js";import{A as E}from"./app-layout-BWNSTnzo.js";import{I as n}from"./input-error-qGEWMI0S.js";import{A as F}from"./arrow-left-DdXykmq1.js";import{S}from"./app-header-CG1ssGlZ.js";import{C as f}from"./check-B36XRWFm.js";import{S as L}from"./save-Db4EzG5X.js";import"./app-C-LPVYHj.js";import"./utils-CBfrqCZ4.js";import"./index-D84Mxgab.js";import"./index-Ev69Uu53.js";import"./index-uKwbV_sB.js";import"./createLucideIcon-D7RG60cb.js";import"./toaster-2b9FfqPb.js";import"./index-YEfPdCwI.js";import"./wayfinder-FFrBTblC.js";import"./house-CZWOuWy8.js";import"./lock-DmLn8291.js";import"./shield-CVSj8g86.js";import"./music-BgCfYSmJ.js";import"./mail-CK-onULp.js";function se({payment:s,enrollments:c}){const[i,u]=g.useState(""),[l,x]=g.useState(s?.enrollment_id&&c.find(t=>t.id===s.enrollment_id)||null),{data:r,setData:a,post:_,put:b,processing:p,errors:d}=w({student_id:s?.student_id||"",program_id:s?.program_id||"",enrollment_id:s?.enrollment_id||"",concept:s?.concept||"",payment_type:s?.payment_type||"single",amount:s?.amount||"",due_date:s?.due_date||"",status:s?.status||"pending",payment_method:s?.payment_method||"",reference_number:s?.reference_number||"",notes:s?.notes||""}),y=t=>{x(t),u(""),a({...r,student_id:t.student_id,program_id:t.program_id,enrollment_id:t.id})},N=t=>{t.preventDefault(),s?.id?b(`/pagos/${s.id}`):_("/pagos")},h=c.filter(t=>t.student_name.toLowerCase().includes(i.toLowerCase())||t.student_email.toLowerCase().includes(i.toLowerCase())||t.program_name.toLowerCase().includes(i.toLowerCase()));return e.jsxs(E,{children:[e.jsx(C,{title:s?"Editar Pago":"Registrar Pago"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs(j,{href:"/pagos",className:"mb-2 flex items-center text-sm text-gray-600 hover:text-gray-900",children:[e.jsx(F,{className:"mr-1 h-4 w-4"}),"Volver a pagos"]}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:s?"Editar Pago":"Registrar Pago"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Selecciona un estudiante inscrito para registrar el pago"})]})}),e.jsxs("form",{onSubmit:N,className:"rounded-xl border border-gray-200 bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(o,{htmlFor:"student-search",children:"Buscar Estudiante Inscrito *"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"}),e.jsx(m,{id:"student-search",type:"text",value:i,onChange:t=>u(t.target.value),placeholder:"Buscar por nombre, email o programa...",className:"pl-10"})]}),i&&e.jsx("div",{className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md border border-gray-200 bg-white shadow-lg",children:h.length>0?h.map(t=>e.jsxs("button",{type:"button",onClick:()=>y(t),className:"flex w-full items-start gap-3 px-4 py-3 text-left hover:bg-gray-50",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.student_name}),e.jsx("div",{className:"text-sm text-gray-500",children:t.student_email}),e.jsx("div",{className:"mt-1 inline-flex items-center rounded-full bg-blue-100 px-2 py-0.5 text-xs font-medium text-blue-700",children:t.program_name})]}),l?.id===t.id&&e.jsx(f,{className:"h-5 w-5 text-green-600"})]},t.id)):e.jsx("div",{className:"px-4 py-3 text-sm text-gray-500",children:"No se encontraron estudiantes inscritos"})}),l&&!i&&e.jsx("div",{className:"mt-2 rounded-lg border border-green-200 bg-green-50 p-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"font-medium text-green-900",children:l.student_name})]}),e.jsxs("div",{className:"ml-6 mt-1 text-sm text-green-700",children:["Programa: ",l.program_name]})]}),e.jsx("button",{type:"button",onClick:()=>{x(null),a({...r,student_id:"",program_id:"",enrollment_id:""})},className:"text-sm text-green-700 hover:text-green-900",children:"Cambiar"})]})})]}),e.jsx(n,{message:d.student_id||d.enrollment_id})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(o,{htmlFor:"concept",children:"Concepto del Pago *"}),e.jsx(m,{id:"concept",type:"text",value:r.concept,onChange:t=>a("concept",t.target.value),placeholder:"Ej: Mensualidad Enero 2025",required:!0}),e.jsx(n,{message:d.concept})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"payment_type",children:"Tipo de Pago *"}),e.jsxs("select",{id:"payment_type",value:r.payment_type,onChange:t=>a("payment_type",t.target.value),className:"mt-1 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm",children:[e.jsx("option",{value:"single",children:"Pago Único"}),e.jsx("option",{value:"partial",children:"Permite Abonos Parciales"})]}),e.jsx(n,{message:d.payment_type})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"amount",children:"Monto *"}),e.jsx(m,{id:"amount",type:"number",step:"0.01",value:r.amount,onChange:t=>a("amount",t.target.value),placeholder:"0.00",required:!0}),e.jsx(n,{message:d.amount})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"due_date",children:"Fecha de Vencimiento *"}),e.jsx(m,{id:"due_date",type:"date",value:r.due_date,onChange:t=>a("due_date",t.target.value),required:!0}),e.jsx(n,{message:d.due_date})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"status",children:"Estado *"}),e.jsxs("select",{id:"status",value:r.status,onChange:t=>a("status",t.target.value),className:"mt-1 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm",children:[e.jsx("option",{value:"pending",children:"Pendiente"}),e.jsx("option",{value:"completed",children:"Completado"}),e.jsx("option",{value:"overdue",children:"Vencido"}),e.jsx("option",{value:"cancelled",children:"Cancelado"})]}),e.jsx(n,{message:d.status})]}),r.status==="completed"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"payment_method",children:"Método de Pago"}),e.jsxs("select",{id:"payment_method",value:r.payment_method,onChange:t=>a("payment_method",t.target.value),className:"mt-1 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm",children:[e.jsx("option",{value:"",children:"Seleccionar"}),e.jsx("option",{value:"cash",children:"Efectivo"}),e.jsx("option",{value:"transfer",children:"Transferencia"}),e.jsx("option",{value:"credit_card",children:"Tarjeta de Crédito"})]}),e.jsx(n,{message:d.payment_method})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"reference_number",children:"Número de Referencia"}),e.jsx(m,{id:"reference_number",type:"text",value:r.reference_number,onChange:t=>a("reference_number",t.target.value),placeholder:"Número de comprobante"}),e.jsx(n,{message:d.reference_number})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(o,{htmlFor:"notes",children:"Notas"}),e.jsx(P,{id:"notes",value:r.notes,onChange:t=>a("notes",t.target.value),placeholder:"Observaciones adicionales...",rows:3}),e.jsx(n,{message:d.notes})]})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-end gap-3",children:[e.jsx(j,{href:"/pagos",children:e.jsx(v,{type:"button",variant:"outline",children:"Cancelar"})}),e.jsxs(v,{type:"submit",disabled:p||!l,children:[e.jsx(L,{className:"mr-2 h-4 w-4"}),p?"Guardando...":s?"Actualizar Pago":"Registrar Pago"]})]})]})]})]})}export{se as default};
