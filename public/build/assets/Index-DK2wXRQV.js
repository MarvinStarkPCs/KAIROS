import{r as h,j as e,H as w,L as o,a as c}from"./app-C2ts3GcV.js";import{B as r}from"./button-P4M4MpFt.js";import{L as x}from"./label-DWbcc18A.js";import{A as C}from"./app-layout-D6QQx-Rn.js";import{A as _,a as k,b as D,c as S,d as P,e as A,f as L,g as E}from"./alert-dialog-Dx8ByB5N.js";import{P as F}from"./plus-pRjl_RRH.js";import{F as z}from"./filter-DyVDHySc.js";import{S as $}from"./app-header-5lzEDeTU.js";import{c as I}from"./createLucideIcon-SiHI-uXJ.js";import{C as M}from"./credit-card-DxyncC19.js";import{D as T}from"./dollar-sign-CodDB72l.js";import{R as B}from"./refresh-cw-ByosMMt0.js";import{E as O}from"./eye-D5dxMJB-.js";import{S as R}from"./square-pen-BZjZQNx3.js";import{T as V}from"./trash-2-BTfW4vSI.js";import{C as g}from"./circle-x-BrG4AwSH.js";import{C as H}from"./clock-DTp_7bBO.js";import{C as q}from"./circle-check-big-DPTJKexD.js";import"./app-xOGZR_tH.js";import"./utils-CBfrqCZ4.js";import"./index-CB__l4Qg.js";import"./index-CzU6gSnE.js";import"./index-CmzMyFM4.js";import"./toaster-D0e9s6eE.js";import"./index-YEfPdCwI.js";import"./wayfinder-FFrBTblC.js";import"./house-B4308BBV.js";import"./lock-DhmqEOm4.js";import"./shield-BkS-nLpi.js";import"./music-CBXlPozq.js";import"./mail-DpxonfP2.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],G=I("List",W);function Ce({payments:m,students:u,programs:j,filters:i}){const[l,d]=h.useState({open:!1,paymentId:null}),[t,n]=h.useState({status:i.status||"",student_id:i.student_id||"",program_id:i.program_id||""}),f=()=>{c.get("/pagos/list",t,{preserveState:!0})},N=()=>{l.paymentId&&c.delete(`/pagos/${l.paymentId}`,{onSuccess:()=>{d({open:!1,paymentId:null})}})},b=s=>{c.post(`/pagos/${s}/check-wompi`,{},{preserveScroll:!0})},y=s=>{const a={completed:{bg:"bg-green-100",text:"text-green-700",label:"Completado",icon:q},pending:{bg:"bg-yellow-100",text:"text-yellow-700",label:"Pendiente",icon:H},overdue:{bg:"bg-red-100",text:"text-red-700",label:"Vencido",icon:g},cancelled:{bg:"bg-gray-100",text:"text-gray-700",label:"Cancelado",icon:g}};return a[s]||a.pending};return e.jsxs(C,{children:[e.jsx(w,{title:"Pagos"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Pagos"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Gestiona mensualidades, cuotas y abonos"})]}),e.jsx(o,{href:"/pagos/create",children:e.jsxs(r,{className:"flex items-center space-x-2",children:[e.jsx(F,{className:"h-5 w-5"}),e.jsx("span",{children:"Registrar Pago"})]})})]}),e.jsxs("div",{className:"rounded-xl border border-gray-200 bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx(z,{className:"h-5 w-5 text-gray-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Filtros"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"status",children:"Estado"}),e.jsxs("select",{id:"status",value:t.status,onChange:s=>n({...t,status:s.target.value}),className:"mt-1 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm",children:[e.jsx("option",{value:"",children:"Todos"}),e.jsx("option",{value:"pending",children:"Pendiente"}),e.jsx("option",{value:"completed",children:"Completado"}),e.jsx("option",{value:"overdue",children:"Vencido"}),e.jsx("option",{value:"cancelled",children:"Cancelado"})]})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"student",children:"Estudiante"}),e.jsxs("select",{id:"student",value:t.student_id,onChange:s=>n({...t,student_id:Number(s.target.value)||""}),className:"mt-1 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm",children:[e.jsx("option",{value:"",children:"Todos"}),u.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"program",children:"Programa"}),e.jsxs("select",{id:"program",value:t.program_id,onChange:s=>n({...t,program_id:Number(s.target.value)||""}),className:"mt-1 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm",children:[e.jsx("option",{value:"",children:"Todos"}),j.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs(r,{onClick:f,className:"w-full",children:[e.jsx($,{className:"mr-2 h-4 w-4"}),"Filtrar"]})})]})]}),e.jsx("div",{className:"rounded-xl border border-gray-200 bg-white shadow-sm",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"border-b border-gray-200 bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-700",children:"Estudiante"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-700",children:"Concepto"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-700",children:"Tipo/Progreso"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-700",children:"Monto"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-700",children:"Vencimiento"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-700",children:"Estado"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium uppercase text-gray-700",children:"Acciones"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:m.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-500",children:"No se encontraron pagos"})}):m.data.map(s=>{const a=y(s.status),v=a.icon,p=s.original_amount?s.paid_amount/s.original_amount*100:0;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"font-medium text-gray-900",children:s.student.name})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-gray-700",children:s.concept}),s.program&&e.jsx("div",{className:"text-xs text-gray-500",children:s.program.name})]}),e.jsxs("td",{className:"px-6 py-4",children:[s.payment_type==="installment"&&e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-blue-100 px-2 py-1 text-xs font-medium text-blue-700",children:[e.jsx(G,{className:"h-3 w-3"}),"Cuota ",s.installment_number,"/",s.total_installments]}),s.payment_type==="partial"&&s.has_transactions&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-purple-100 px-2 py-1 text-xs font-medium text-purple-700",children:[e.jsx(M,{className:"h-3 w-3"}),"Con abonos"]}),e.jsxs("div",{className:"w-32",children:[e.jsx("div",{className:"h-2 rounded-full bg-gray-200",children:e.jsx("div",{className:"h-2 rounded-full bg-purple-600",style:{width:`${p}%`}})}),e.jsxs("div",{className:"mt-0.5 text-xs text-gray-600",children:[p.toFixed(0),"% pagado"]})]})]}),s.payment_type==="single"&&e.jsx("span",{className:"text-xs text-gray-500",children:"Pago único"})]}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsxs("div",{className:"flex items-center gap-1 font-semibold text-gray-900",children:[e.jsx(T,{className:"h-4 w-4"}),s.amount.toLocaleString("es-CO")]}),s.pending_balance>0&&s.status!=="completed"&&e.jsxs("div",{className:"text-xs text-orange-600",children:["Pendiente: $",s.pending_balance.toLocaleString("es-CO")]})]}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:new Date(s.due_date).toLocaleDateString("es-CO")}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-2.5 py-1 text-xs font-medium ${a.bg} ${a.text}`,children:[e.jsx(v,{className:"h-3 w-3"}),a.label]})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[s.wompi_transaction_id&&s.status==="pending"&&e.jsx(r,{variant:"outline",size:"sm",className:"text-blue-600 hover:bg-blue-50",onClick:()=>b(s.id),title:"Verificar estado en Wompi",children:e.jsx(B,{className:"h-4 w-4"})}),e.jsx(o,{href:`/pagos/${s.id}`,children:e.jsx(r,{variant:"outline",size:"sm",children:e.jsx(O,{className:"h-4 w-4"})})}),e.jsx(o,{href:`/pagos/${s.id}/edit`,children:e.jsx(r,{variant:"outline",size:"sm",children:e.jsx(R,{className:"h-4 w-4"})})}),e.jsx(r,{variant:"outline",size:"sm",className:"text-red-600 hover:bg-red-50",onClick:()=>d({open:!0,paymentId:s.id}),children:e.jsx(V,{className:"h-4 w-4"})})]})})]},s.id)})})]})})})]}),e.jsx(_,{open:l.open,onOpenChange:s=>d({...l,open:s}),children:e.jsxs(k,{children:[e.jsxs(D,{children:[e.jsx(S,{children:"¿Estás seguro?"}),e.jsx(P,{children:"Esta acción no se puede deshacer. El pago será eliminado permanentemente."})]}),e.jsxs(A,{children:[e.jsx(L,{children:"Cancelar"}),e.jsx(E,{onClick:N,className:"bg-red-600 hover:bg-red-700",children:"Eliminar"})]})]})})]})}export{Ce as default};
