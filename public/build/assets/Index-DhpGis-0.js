import{a as p,j as e,H as v,L as o,r as h}from"./app-DFBT0azW.js";import{B as l}from"./index-DehGEpQx.js";import{L as c}from"./label-OxNrlTew.js";import{A as w}from"./app-layout-DVEKxbsu.js";import{T as C,A as _,a as D,b as k,c as S,d as P,e as A,f as L,g as E}from"./alert-dialog-Cm66vyTR.js";import{P as F}from"./plus-CPkHfWQV.js";import{F as z}from"./filter-BYpLrSlb.js";import{S as I,h as M}from"./app-header-DIu5u_Zm.js";import{c as T}from"./createLucideIcon-zHIoEuSV.js";import{D as $}from"./dollar-sign-CbnA00rQ.js";import{E as B}from"./eye-BhGJ75i8.js";import{S as O}from"./square-pen-RLx1W3tC.js";import{C as g}from"./circle-x-DvHC-yPo.js";import{C as H}from"./clock-B0sOucJ2.js";import{C as V}from"./circle-check-big-B8LrTISI.js";import"./app-DjIkNMfJ.js";import"./index-CFOi4EbZ.js";import"./toaster-CLpaThE9.js";import"./index-YEfPdCwI.js";import"./wayfinder-FFrBTblC.js";import"./lock-DjrKSKxD.js";import"./shield-DTWI9F_S.js";import"./music-Da2i6bHM.js";import"./mail-nna26qYp.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],R=T("List",q);function ge({payments:x,students:u,programs:j,filters:i}){const[r,d]=p.useState({open:!1,paymentId:null}),[t,n]=p.useState({status:i.status||"",student_id:i.student_id||"",program_id:i.program_id||""}),f=()=>{h.get("/pagos/list",t,{preserveState:!0})},N=()=>{r.paymentId&&h.delete(`/pagos/${r.paymentId}`,{onSuccess:()=>{d({open:!1,paymentId:null})}})},b=s=>{const a={completed:{bg:"bg-green-100",text:"text-green-700",label:"Completado",icon:V},pending:{bg:"bg-yellow-100",text:"text-yellow-700",label:"Pendiente",icon:H},overdue:{bg:"bg-red-100",text:"text-red-700",label:"Vencido",icon:g},cancelled:{bg:"bg-gray-100",text:"text-gray-700",label:"Cancelado",icon:g}};return a[s]||a.pending};return e.jsxs(w,{children:[e.jsx(v,{title:"Pagos"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Pagos"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Gestiona mensualidades, cuotas y abonos"})]}),e.jsx(o,{href:"/pagos/create",children:e.jsxs(l,{className:"flex items-center space-x-2",children:[e.jsx(F,{className:"h-5 w-5"}),e.jsx("span",{children:"Registrar Pago"})]})})]}),e.jsxs("div",{className:"rounded-xl border border-gray-200 bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx(z,{className:"h-5 w-5 text-gray-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Filtros"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"status",children:"Estado"}),e.jsxs("select",{id:"status",value:t.status,onChange:s=>n({...t,status:s.target.value}),className:"mt-1 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm",children:[e.jsx("option",{value:"",children:"Todos"}),e.jsx("option",{value:"pending",children:"Pendiente"}),e.jsx("option",{value:"completed",children:"Completado"}),e.jsx("option",{value:"overdue",children:"Vencido"}),e.jsx("option",{value:"cancelled",children:"Cancelado"})]})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"student",children:"Estudiante"}),e.jsxs("select",{id:"student",value:t.student_id,onChange:s=>n({...t,student_id:Number(s.target.value)||""}),className:"mt-1 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm",children:[e.jsx("option",{value:"",children:"Todos"}),u.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"program",children:"Programa"}),e.jsxs("select",{id:"program",value:t.program_id,onChange:s=>n({...t,program_id:Number(s.target.value)||""}),className:"mt-1 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm",children:[e.jsx("option",{value:"",children:"Todos"}),j.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs(l,{onClick:f,className:"w-full",children:[e.jsx(I,{className:"mr-2 h-4 w-4"}),"Filtrar"]})})]})]}),e.jsx("div",{className:"rounded-xl border border-gray-200 bg-white shadow-sm",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"border-b border-gray-200 bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-700",children:"Estudiante"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-700",children:"Concepto"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-700",children:"Tipo/Progreso"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-700",children:"Monto"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-700",children:"Vencimiento"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-700",children:"Estado"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium uppercase text-gray-700",children:"Acciones"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:x.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-500",children:"No se encontraron pagos"})}):x.data.map(s=>{const a=b(s.status),y=a.icon,m=s.original_amount?s.paid_amount/s.original_amount*100:0;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"font-medium text-gray-900",children:s.student.name})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-gray-700",children:s.concept}),s.program&&e.jsx("div",{className:"text-xs text-gray-500",children:s.program.name})]}),e.jsxs("td",{className:"px-6 py-4",children:[s.payment_type==="installment"&&e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-blue-100 px-2 py-1 text-xs font-medium text-blue-700",children:[e.jsx(R,{className:"h-3 w-3"}),"Cuota ",s.installment_number,"/",s.total_installments]}),s.payment_type==="partial"&&s.has_transactions&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-purple-100 px-2 py-1 text-xs font-medium text-purple-700",children:[e.jsx(M,{className:"h-3 w-3"}),"Con abonos"]}),e.jsxs("div",{className:"w-32",children:[e.jsx("div",{className:"h-2 rounded-full bg-gray-200",children:e.jsx("div",{className:"h-2 rounded-full bg-purple-600",style:{width:`${m}%`}})}),e.jsxs("div",{className:"mt-0.5 text-xs text-gray-600",children:[m.toFixed(0),"% pagado"]})]})]}),s.payment_type==="single"&&e.jsx("span",{className:"text-xs text-gray-500",children:"Pago único"})]}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsxs("div",{className:"flex items-center gap-1 font-semibold text-gray-900",children:[e.jsx($,{className:"h-4 w-4"}),s.amount.toLocaleString("es-CO")]}),s.pending_balance>0&&s.status!=="completed"&&e.jsxs("div",{className:"text-xs text-orange-600",children:["Pendiente: $",s.pending_balance.toLocaleString("es-CO")]})]}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:new Date(s.due_date).toLocaleDateString("es-CO")}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-2.5 py-1 text-xs font-medium ${a.bg} ${a.text}`,children:[e.jsx(y,{className:"h-3 w-3"}),a.label]})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(o,{href:`/pagos/${s.id}`,children:e.jsx(l,{variant:"outline",size:"sm",children:e.jsx(B,{className:"h-4 w-4"})})}),e.jsx(o,{href:`/pagos/${s.id}/edit`,children:e.jsx(l,{variant:"outline",size:"sm",children:e.jsx(O,{className:"h-4 w-4"})})}),e.jsx(l,{variant:"outline",size:"sm",className:"text-red-600 hover:bg-red-50",onClick:()=>d({open:!0,paymentId:s.id}),children:e.jsx(C,{className:"h-4 w-4"})})]})})]},s.id)})})]})})})]}),e.jsx(_,{open:r.open,onOpenChange:s=>d({...r,open:s}),children:e.jsxs(D,{children:[e.jsxs(k,{children:[e.jsx(S,{children:"¿Estás seguro?"}),e.jsx(P,{children:"Esta acción no se puede deshacer. El pago será eliminado permanentemente."})]}),e.jsxs(A,{children:[e.jsx(L,{children:"Cancelar"}),e.jsx(E,{onClick:N,className:"bg-red-600 hover:bg-red-700",children:"Eliminar"})]})]})})]})}export{ge as default};
