import{u as re,r as F,j as e,b as Pe,H as _e,L as ue,a as G}from"./app-05ShooGQ.js";import{B as h}from"./button-BD8539R6.js";import{A as U,a as B,b as pe}from"./alert-RTt--WVX.js";import{p as xe}from"./program_academy-IHQIcmQm.js";import{a as Q,q}from"./wayfinder-Bf9OnZdi.js";import{A as De}from"./app-layout-CR3KzzE7.js";import{D as ie,a as ae,b as le,c as de,d as ne,f as oe}from"./dialog-B3X4U4z-.js";import{I as z}from"./input-DWBzlYOO.js";import{L as b}from"./label-BuRjJQVS.js";import{T as ce}from"./textarea-Dtf_NSR0.js";import{C as te}from"./circle-check-9IBLsJji.js";import{T as se}from"./triangle-alert-33If-vp1.js";import{c as ye}from"./createLucideIcon-jgmphIs6.js";import{A as O,b as R,c as V,d as J,e as K,f as X,g as Y,h as Z}from"./alert-dialog-Dv3xDcZy.js";import{A as Se}from"./arrow-left-BELGf3DJ.js";import{P as H}from"./plus-fdTDKsoE.js";import{B as he,L as Fe}from"./list-checks-CZ3arZ4g.js";import{T as ee}from"./trash-2-Biu56-3K.js";import{A as ke}from"./book-open-OnlFKIlA.js";/* empty css            */import"./utils-QIaTb7Ic.js";import"./index-NETZMin-.js";import"./index-D5cJpMRO.js";import"./index-DpNXXy9o.js";import"./index-BxkeiSwP.js";import"./index-YFaldniu.js";import"./index-DJ9QZhGu.js";import"./app-header-DhUaObwM.js";import"./chevron-right-OTkE61dJ.js";import"./index-DE-kI2jP.js";import"./index-CLa6oRL-.js";import"./index-D12nj1Ca.js";import"./graduation-cap-0xoJFm5c.js";import"./users-BTmOshtK.js";import"./credit-card-BuSrC1Ii.js";import"./calendar-CmeM68J-.js";import"./file-text-DvijEh9m.js";import"./lock-B3HqQlmb.js";import"./shield-DSwyy0H4.js";import"./chevron-down-DwoHTTy4.js";import"./loader-circle-CaH6ryvJ.js";import"./mail-ku6KC86U.js";import"./toaster-c0Tzfo0H.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],me=ye("Info",Qe);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],Te=ye("WandSparkles",qe),N=(t,s)=>({url:N.url(t,s),method:"post"});N.definition={methods:["post"],url:"/programas_academicos/{program}/study-plans"};N.url=(t,s)=>{(typeof t=="string"||typeof t=="number")&&(t={program:t}),typeof t=="object"&&!Array.isArray(t)&&"id"in t&&(t={program:t.id}),Array.isArray(t)&&(t={program:t[0]}),t=Q(t);const l={program:typeof t.program=="object"?t.program.id:t.program};return N.definition.url.replace("{program}",l.program.toString()).replace(/\/+$/,"")+q(s)};N.post=(t,s)=>({url:N.url(t,s),method:"post"});const je=(t,s)=>({action:N.url(t,s),method:"post"});je.post=(t,s)=>({action:N.url(t,s),method:"post"});N.form=je;const A=(t,s)=>({url:A.url(t,s),method:"put"});A.definition={methods:["put"],url:"/study-plans/{studyPlan}"};A.url=(t,s)=>{(typeof t=="string"||typeof t=="number")&&(t={studyPlan:t}),typeof t=="object"&&!Array.isArray(t)&&"id"in t&&(t={studyPlan:t.id}),Array.isArray(t)&&(t={studyPlan:t[0]}),t=Q(t);const l={studyPlan:typeof t.studyPlan=="object"?t.studyPlan.id:t.studyPlan};return A.definition.url.replace("{studyPlan}",l.studyPlan.toString()).replace(/\/+$/,"")+q(s)};A.put=(t,s)=>({url:A.url(t,s),method:"put"});const ve=(t,s)=>({action:A.url(t,{[s?.mergeQuery?"mergeQuery":"query"]:{_method:"PUT",...s?.query??s?.mergeQuery??{}}}),method:"post"});ve.put=(t,s)=>({action:A.url(t,{[s?.mergeQuery?"mergeQuery":"query"]:{_method:"PUT",...s?.query??s?.mergeQuery??{}}}),method:"post"});A.form=ve;const w=(t,s)=>({url:w.url(t,s),method:"delete"});w.definition={methods:["delete"],url:"/study-plans/{studyPlan}"};w.url=(t,s)=>{(typeof t=="string"||typeof t=="number")&&(t={studyPlan:t}),typeof t=="object"&&!Array.isArray(t)&&"id"in t&&(t={studyPlan:t.id}),Array.isArray(t)&&(t={studyPlan:t[0]}),t=Q(t);const l={studyPlan:typeof t.studyPlan=="object"?t.studyPlan.id:t.studyPlan};return w.definition.url.replace("{studyPlan}",l.studyPlan.toString()).replace(/\/+$/,"")+q(s)};w.delete=(t,s)=>({url:w.url(t,s),method:"delete"});const fe=(t,s)=>({action:w.url(t,{[s?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...s?.query??s?.mergeQuery??{}}}),method:"post"});fe.delete=(t,s)=>({action:w.url(t,{[s?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...s?.query??s?.mergeQuery??{}}}),method:"post"});w.form=fe;const C=(t,s)=>({url:C.url(t,s),method:"post"});C.definition={methods:["post"],url:"/study-plans/{studyPlan}/activities"};C.url=(t,s)=>{(typeof t=="string"||typeof t=="number")&&(t={studyPlan:t}),typeof t=="object"&&!Array.isArray(t)&&"id"in t&&(t={studyPlan:t.id}),Array.isArray(t)&&(t={studyPlan:t[0]}),t=Q(t);const l={studyPlan:typeof t.studyPlan=="object"?t.studyPlan.id:t.studyPlan};return C.definition.url.replace("{studyPlan}",l.studyPlan.toString()).replace(/\/+$/,"")+q(s)};C.post=(t,s)=>({url:C.url(t,s),method:"post"});const ge=(t,s)=>({action:C.url(t,s),method:"post"});ge.post=(t,s)=>({action:C.url(t,s),method:"post"});C.form=ge;const E=(t,s)=>({url:E.url(t,s),method:"put"});E.definition={methods:["put"],url:"/activities/{activity}"};E.url=(t,s)=>{(typeof t=="string"||typeof t=="number")&&(t={activity:t}),typeof t=="object"&&!Array.isArray(t)&&"id"in t&&(t={activity:t.id}),Array.isArray(t)&&(t={activity:t[0]}),t=Q(t);const l={activity:typeof t.activity=="object"?t.activity.id:t.activity};return E.definition.url.replace("{activity}",l.activity.toString()).replace(/\/+$/,"")+q(s)};E.put=(t,s)=>({url:E.url(t,s),method:"put"});const be=(t,s)=>({action:E.url(t,{[s?.mergeQuery?"mergeQuery":"query"]:{_method:"PUT",...s?.query??s?.mergeQuery??{}}}),method:"post"});be.put=(t,s)=>({action:E.url(t,{[s?.mergeQuery?"mergeQuery":"query"]:{_method:"PUT",...s?.query??s?.mergeQuery??{}}}),method:"post"});E.form=be;const P=(t,s)=>({url:P.url(t,s),method:"delete"});P.definition={methods:["delete"],url:"/activities/{activity}"};P.url=(t,s)=>{(typeof t=="string"||typeof t=="number")&&(t={activity:t}),typeof t=="object"&&!Array.isArray(t)&&"id"in t&&(t={activity:t.id}),Array.isArray(t)&&(t={activity:t[0]}),t=Q(t);const l={activity:typeof t.activity=="object"?t.activity.id:t.activity};return P.definition.url.replace("{activity}",l.activity.toString()).replace(/\/+$/,"")+q(s)};P.delete=(t,s)=>({url:P.url(t,s),method:"delete"});const Ne=(t,s)=>({action:P.url(t,{[s?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...s?.query??s?.mergeQuery??{}}}),method:"post"});Ne.delete=(t,s)=>({action:P.url(t,{[s?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...s?.query??s?.mergeQuery??{}}}),method:"post"});P.form=Ne;const _=(t,s)=>({url:_.url(t,s),method:"post"});_.definition={methods:["post"],url:"/activities/{activity}/criteria"};_.url=(t,s)=>{(typeof t=="string"||typeof t=="number")&&(t={activity:t}),typeof t=="object"&&!Array.isArray(t)&&"id"in t&&(t={activity:t.id}),Array.isArray(t)&&(t={activity:t[0]}),t=Q(t);const l={activity:typeof t.activity=="object"?t.activity.id:t.activity};return _.definition.url.replace("{activity}",l.activity.toString()).replace(/\/+$/,"")+q(s)};_.post=(t,s)=>({url:_.url(t,s),method:"post"});const Ae=(t,s)=>({action:_.url(t,s),method:"post"});Ae.post=(t,s)=>({action:_.url(t,s),method:"post"});_.form=Ae;const D=(t,s)=>({url:D.url(t,s),method:"put"});D.definition={methods:["put"],url:"/criteria/{criteria}"};D.url=(t,s)=>{(typeof t=="string"||typeof t=="number")&&(t={criteria:t}),typeof t=="object"&&!Array.isArray(t)&&"id"in t&&(t={criteria:t.id}),Array.isArray(t)&&(t={criteria:t[0]}),t=Q(t);const l={criteria:typeof t.criteria=="object"?t.criteria.id:t.criteria};return D.definition.url.replace("{criteria}",l.criteria.toString()).replace(/\/+$/,"")+q(s)};D.put=(t,s)=>({url:D.url(t,s),method:"put"});const we=(t,s)=>({action:D.url(t,{[s?.mergeQuery?"mergeQuery":"query"]:{_method:"PUT",...s?.query??s?.mergeQuery??{}}}),method:"post"});we.put=(t,s)=>({action:D.url(t,{[s?.mergeQuery?"mergeQuery":"query"]:{_method:"PUT",...s?.query??s?.mergeQuery??{}}}),method:"post"});D.form=we;const S=(t,s)=>({url:S.url(t,s),method:"delete"});S.definition={methods:["delete"],url:"/criteria/{criteria}"};S.url=(t,s)=>{(typeof t=="string"||typeof t=="number")&&(t={criteria:t}),typeof t=="object"&&!Array.isArray(t)&&"id"in t&&(t={criteria:t.id}),Array.isArray(t)&&(t={criteria:t[0]}),t=Q(t);const l={criteria:typeof t.criteria=="object"?t.criteria.id:t.criteria};return S.definition.url.replace("{criteria}",l.criteria.toString()).replace(/\/+$/,"")+q(s)};S.delete=(t,s)=>({url:S.url(t,s),method:"delete"});const Ce=(t,s)=>({action:S.url(t,{[s?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...s?.query??s?.mergeQuery??{}}}),method:"post"});Ce.delete=(t,s)=>({action:S.url(t,{[s?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...s?.query??s?.mergeQuery??{}}}),method:"post"});S.form=Ce;const k={store:N,update:A,destroy:w,storeActivity:C,updateActivity:E,destroyActivity:P,storeCriteria:_,updateCriteria:D,destroyCriteria:S};function $e({open:t,onOpenChange:s,programId:l,studyPlan:r}){const j=!!r,{data:f,setData:u,post:o,put:y,processing:v,errors:a,reset:c}=re({module_name:r?.module_name||"",description:r?.description||"",hours:r?.hours||1,level:r?.level||1});F.useEffect(()=>{r?u({module_name:r.module_name,description:r.description||"",hours:r.hours,level:r.level}):c()},[r,t]);const g=m=>{m.preventDefault(),j?y(k.update({studyPlan:r.id}).url,{preserveScroll:!0,onSuccess:()=>{s(!1),c()}}):o(k.store({program:l}).url,{preserveScroll:!0,onSuccess:()=>{s(!1),c()}})};return e.jsx(ie,{open:t,onOpenChange:s,children:e.jsx(ae,{className:"sm:max-w-[500px]",children:e.jsxs("form",{onSubmit:g,children:[e.jsxs(le,{children:[e.jsx(de,{children:j?"Editar Módulo":"Agregar Módulo"}),e.jsx(ne,{children:j?"Actualiza la información del módulo del plan de estudios.":"Agrega un nuevo módulo al plan de estudios del programa."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(b,{htmlFor:"module_name",children:"Nombre del Módulo *"}),e.jsx(z,{id:"module_name",value:f.module_name,onChange:m=>u("module_name",m.target.value),placeholder:"Ej: Introducción a la Programación",className:a.module_name?"border-red-500":""}),a.module_name&&e.jsx("p",{className:"text-sm text-red-600",children:a.module_name})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(b,{htmlFor:"description",children:"Descripción"}),e.jsx(ce,{id:"description",value:f.description,onChange:m=>u("description",m.target.value),placeholder:"Describe el contenido y objetivos del módulo",rows:3,className:a.description?"border-red-500":""}),a.description&&e.jsx("p",{className:"text-sm text-red-600",children:a.description})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(b,{htmlFor:"hours",children:"Horas *"}),e.jsx(z,{id:"hours",type:"number",min:"1",value:f.hours,onChange:m=>u("hours",parseInt(m.target.value)||1),className:a.hours?"border-red-500":""}),a.hours&&e.jsx("p",{className:"text-sm text-red-600",children:a.hours})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(b,{htmlFor:"level",children:"Nivel *"}),e.jsx(z,{id:"level",type:"number",min:"1",value:f.level,onChange:m=>u("level",parseInt(m.target.value)||1),className:a.level?"border-red-500":""}),a.level&&e.jsx("p",{className:"text-sm text-red-600",children:a.level})]})]})]}),e.jsxs(oe,{children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>s(!1),disabled:v,children:"Cancelar"}),e.jsx(h,{type:"submit",disabled:v,children:v?"Guardando...":j?"Actualizar":"Crear"})]})]})})})}function Ie({open:t,onOpenChange:s,studyPlanId:l,activity:r,nextOrder:j=0,currentTotalWeight:f=0}){const u=!!r,o=Number(f)||0,y=Math.max(0,100-o),{data:v,setData:a,post:c,put:g,processing:m,errors:d,reset:T}=re({name:r?.name||"",description:r?.description||"",order:r?.order??j,weight:r?.weight||0,status:r?.status||"active"});F.useEffect(()=>{r?a({name:r.name,description:r.description||"",order:r.order,weight:r.weight,status:r.status}):(T(),a("order",j))},[r,t,j]);const W=p=>{p.preventDefault(),u?g(k.updateActivity({activity:r.id}).url,{preserveScroll:!0,onSuccess:()=>{s(!1),T()}}):c(k.storeActivity({studyPlan:l}).url,{preserveScroll:!0,onSuccess:()=>{s(!1),T()}})};return e.jsx(ie,{open:t,onOpenChange:s,children:e.jsx(ae,{className:"sm:max-w-[500px]",children:e.jsxs("form",{onSubmit:W,children:[e.jsxs(le,{children:[e.jsx(de,{children:u?"Editar Actividad":"Agregar Actividad"}),e.jsx(ne,{children:u?"Actualiza la información de la actividad.":"Agrega una nueva actividad al módulo del plan de estudios."})]}),(()=>{const p=Number(v.weight)||0,$=o+p,M=$===100,I=$>100;return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:`rounded-lg border p-3 ${M?"border-green-200 bg-green-50":I?"border-red-200 bg-red-50":"border-amber-200 bg-amber-50"}`,children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[M?e.jsx(te,{className:"h-4 w-4 text-green-600"}):I?e.jsx(se,{className:"h-4 w-4 text-red-600"}):e.jsx(me,{className:"h-4 w-4 text-amber-600"}),e.jsx("span",{className:`text-sm font-medium ${M?"text-green-800":I?"text-red-800":"text-amber-800"}`,children:"Estado del módulo"})]})}),e.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-2 text-center text-xs",children:[e.jsxs("div",{className:"rounded bg-white/60 p-2",children:[e.jsxs("div",{className:"font-semibold text-gray-700",children:[o.toFixed(1),"%"]}),e.jsx("div",{className:"text-gray-500",children:"Asignado"})]}),e.jsxs("div",{className:"rounded bg-white/60 p-2",children:[e.jsxs("div",{className:`font-semibold ${y>0?"text-amber-700":"text-green-700"}`,children:[y.toFixed(1),"%"]}),e.jsx("div",{className:"text-gray-500",children:"Disponible"})]}),e.jsxs("div",{className:"rounded bg-white/60 p-2",children:[e.jsxs("div",{className:`font-semibold ${M?"text-green-700":I?"text-red-700":"text-gray-700"}`,children:[$.toFixed(1),"%"]}),e.jsx("div",{className:"text-gray-500",children:"Proyectado"})]})]}),e.jsx("div",{className:"mt-2 h-2 w-full overflow-hidden rounded-full bg-gray-200",children:e.jsxs("div",{className:"flex h-full",children:[e.jsx("div",{className:"bg-blue-400 transition-all duration-300",style:{width:`${Math.min(o,100)}%`}}),e.jsx("div",{className:`transition-all duration-300 ${I?"bg-red-500":"bg-green-500"}`,style:{width:`${Math.min(p,100-Math.min(o,100))}%`}})]})}),e.jsxs("div",{className:"mt-1 flex justify-between text-xs text-gray-500",children:[e.jsxs("span",{children:["Otras actividades: ",o.toFixed(1),"%"]}),e.jsxs("span",{children:["Esta actividad: ",p,"%"]})]})]}),I&&e.jsxs(U,{className:"border-red-300 bg-red-50",children:[e.jsx(se,{className:"h-4 w-4 text-red-600"}),e.jsxs(B,{className:"text-red-700 text-xs",children:["La suma total (",$.toFixed(1),"%) excede el 100%. Reduce el peso a máximo ",e.jsxs("strong",{children:[y.toFixed(1),"%"]}),"."]})]}),M&&e.jsxs(U,{className:"border-green-300 bg-green-50",children:[e.jsx(te,{className:"h-4 w-4 text-green-600"}),e.jsx(B,{className:"text-green-700 text-xs",children:"¡Perfecto! La suma total es exactamente 100%."})]})]})})(),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(b,{htmlFor:"name",children:"Nombre de la Actividad *"}),e.jsx(z,{id:"name",value:v.name,onChange:p=>a("name",p.target.value),placeholder:"Ej: Proyecto Final",className:d.name?"border-red-500":""}),d.name&&e.jsx("p",{className:"text-sm text-red-600",children:d.name})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(b,{htmlFor:"description",children:"Descripción"}),e.jsx(ce,{id:"description",value:v.description,onChange:p=>a("description",p.target.value),placeholder:"Describe la actividad y sus objetivos",rows:3,className:d.description?"border-red-500":""}),d.description&&e.jsx("p",{className:"text-sm text-red-600",children:d.description})]}),e.jsx("div",{className:"grid gap-4",children:e.jsxs("div",{className:"grid gap-2",children:[e.jsx(b,{htmlFor:"weight",children:"Peso (%) *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(z,{id:"weight",type:"number",min:"0",max:"100",step:"0.01",value:v.weight,onChange:p=>a("weight",parseFloat(p.target.value)||0),className:`flex-1 ${d.weight?"border-red-500":""}`}),y>0&&e.jsxs(h,{type:"button",variant:"outline",size:"sm",className:"shrink-0 text-xs",onClick:()=>a("weight",Math.round(y*100)/100),title:`Usar peso restante: ${y.toFixed(1)}%`,children:[e.jsx(Te,{className:"mr-1 h-3 w-3"}),y.toFixed(1),"%"]})]}),d.weight&&e.jsx("p",{className:"text-sm text-red-600",children:d.weight}),e.jsxs("p",{className:"text-xs text-gray-500",children:["% de la nota final del módulo",y>0&&v.weight===0&&e.jsx("span",{className:"ml-1 text-amber-600",children:"(Haz clic en el botón para usar el restante)"})]})]})}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(b,{htmlFor:"status",children:"Estado *"}),e.jsxs("select",{id:"status",value:v.status,onChange:p=>a("status",p.target.value),className:"flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-500 focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-gray-950 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[e.jsx("option",{value:"active",children:"Activa"}),e.jsx("option",{value:"inactive",children:"Inactiva"})]}),d.status&&e.jsx("p",{className:"text-sm text-red-600",children:d.status})]})]}),e.jsxs(oe,{children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>s(!1),disabled:m,children:"Cancelar"}),e.jsx(h,{type:"submit",disabled:m,children:m?"Guardando...":u?"Actualizar":"Crear"})]})]})})})}function Le({open:t,onOpenChange:s,activityId:l,criteria:r,nextOrder:j=0}){const f=!!r,{data:u,setData:o,post:y,put:v,processing:a,errors:c,reset:g}=re({name:r?.name||"",description:r?.description||"",max_points:r?.max_points||10,order:r?.order??j});F.useEffect(()=>{r?o({name:r.name,description:r.description||"",max_points:r.max_points,order:r.order}):(g(),o("order",j))},[r,t,j]);const m=d=>{d.preventDefault(),f?v(k.updateCriteria({criteria:r.id}).url,{preserveScroll:!0,onSuccess:()=>{s(!1),g()}}):y(k.storeCriteria({activity:l}).url,{preserveScroll:!0,onSuccess:()=>{s(!1),g()}})};return e.jsx(ie,{open:t,onOpenChange:s,children:e.jsx(ae,{className:"sm:max-w-[500px]",children:e.jsxs("form",{onSubmit:m,children:[e.jsxs(le,{children:[e.jsx(de,{children:f?"Editar Criterio de Evaluación":"Agregar Criterio de Evaluación"}),e.jsx(ne,{children:f?"Actualiza la información del criterio de evaluación.":"Agrega un nuevo criterio de evaluación a la actividad."})]}),e.jsxs(U,{className:"border-amber-200 bg-amber-50",children:[e.jsx(me,{className:"h-4 w-4 text-amber-600"}),e.jsx(pe,{className:"text-amber-800",children:"Sistema de Puntos"}),e.jsx(B,{className:"text-amber-700",children:e.jsxs("ul",{className:"mt-1 list-disc space-y-1 pl-4 text-xs",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Puntuación Máxima:"})," Es el número máximo de puntos que un estudiante puede obtener en este criterio."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Cálculo de nota:"})," La nota del criterio se calcula como: (puntos obtenidos / puntuación máxima) × 100."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Ejemplo:"})," Si el máximo es 10 pts y el estudiante obtiene 8 pts, su nota en este criterio será 80%."]})]})})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(b,{htmlFor:"name",children:"Nombre del Criterio *"}),e.jsx(z,{id:"name",value:u.name,onChange:d=>o("name",d.target.value),placeholder:"Ej: Calidad del código",className:c.name?"border-red-500":""}),c.name&&e.jsx("p",{className:"text-sm text-red-600",children:c.name})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(b,{htmlFor:"description",children:"Descripción"}),e.jsx(ce,{id:"description",value:u.description,onChange:d=>o("description",d.target.value),placeholder:"Describe qué se evaluará en este criterio",rows:3,className:c.description?"border-red-500":""}),c.description&&e.jsx("p",{className:"text-sm text-red-600",children:c.description})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(b,{htmlFor:"max_points",children:"Puntuación Máxima *"}),e.jsx(z,{id:"max_points",type:"number",min:"0",step:"0.01",value:u.max_points,onChange:d=>o("max_points",parseFloat(d.target.value)||0),className:c.max_points?"border-red-500":""}),c.max_points&&e.jsx("p",{className:"text-sm text-red-600",children:c.max_points}),e.jsx("p",{className:"text-xs text-gray-500",children:"Puntos máximos a obtener"})]})]}),e.jsxs(oe,{children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>s(!1),disabled:a,children:"Cancelar"}),e.jsx(h,{type:"submit",disabled:a,children:a?"Guardando...":f?"Actualizar":"Crear"})]})]})})})}function _t({program:t,studyPlans:s}){const{auth:l}=Pe().props,r=l?.permissions??[],j=i=>r.includes(i),[f,u]=F.useState({open:!1}),[o,y]=F.useState({open:!1}),v=(i,L)=>i.filter(n=>n.id!==L).reduce((n,x)=>n+(Number(x.weight)||0),0),a=i=>{const L=Number(i)||0;return L===100?{status:"complete",color:"green",message:"Completo"}:L>100?{status:"over",color:"red",message:`Excede por ${(L-100).toFixed(1)}%`}:{status:"incomplete",color:"amber",message:`Faltan ${(100-L).toFixed(1)}%`}},[c,g]=F.useState({open:!1}),[m,d]=F.useState({open:!1}),[T,W]=F.useState({open:!1}),[p,$]=F.useState({open:!1}),M=()=>{m.studyPlan&&G.delete(k.destroy(m.studyPlan.id).url,{preserveScroll:!0,onSuccess:()=>d({open:!1})})},I=()=>{T.activity&&G.delete(k.destroyActivity(T.activity.id).url,{preserveScroll:!0,onSuccess:()=>W({open:!1})})},Ee=()=>{p.criteria&&G.delete(k.destroyCriteria(p.criteria.id).url,{preserveScroll:!0,onSuccess:()=>$({open:!1})})};return e.jsxs(De,{children:[e.jsx(_e,{title:`${t.name} - Plan de Estudios`}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs(ue,{href:xe.index().url,className:"mb-3 inline-flex items-center text-sm text-gray-600 hover:text-gray-900",children:[e.jsx(Se,{className:"mr-1 h-4 w-4"}),"Volver a programas"]}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:t.name}),t.description&&e.jsx("p",{className:"mt-2 text-gray-600",children:t.description}),e.jsxs("div",{className:"mt-3 flex items-center gap-4 text-sm text-gray-500",children:[e.jsxs("span",{children:[t.duration_months," meses"]}),e.jsx("span",{children:"•"}),e.jsx("span",{className:`rounded-full px-2.5 py-0.5 text-xs font-medium ${t.status==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:t.status==="active"?"Activo":"Inactivo"})]})]}),e.jsx(ue,{href:xe.edit({program:t.id}).url,children:e.jsx(h,{variant:"outline",children:"Editar Programa"})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Plan de Estudios"}),e.jsxs(h,{onClick:()=>u({open:!0}),children:[e.jsx(H,{className:"mr-2 h-4 w-4"}),"Agregar Módulo"]})]}),e.jsxs(U,{className:"border-blue-200 bg-blue-50",children:[e.jsx(me,{className:"h-4 w-4 text-blue-600"}),e.jsx(pe,{className:"text-blue-800",children:"Sistema de Evaluación: Puntos y Porcentajes"}),e.jsx(B,{className:"text-blue-700",children:e.jsxs("div",{className:"mt-2 grid gap-3 text-sm md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-md bg-white/60 p-3",children:[e.jsx("strong",{className:"text-blue-900",children:"Peso de Actividades (%):"}),e.jsxs("ul",{className:"mt-1 list-disc pl-4 text-xs",children:[e.jsx("li",{children:"Cada actividad tiene un peso porcentual dentro del módulo"}),e.jsxs("li",{children:["La suma de todos los pesos debe ser ",e.jsx("strong",{children:"100%"})]}),e.jsx("li",{children:"Ejemplo: Tarea 30% + Examen 40% + Proyecto 30% = 100%"})]})]}),e.jsxs("div",{className:"rounded-md bg-white/60 p-3",children:[e.jsx("strong",{className:"text-blue-900",children:"Puntos de Criterios:"}),e.jsxs("ul",{className:"mt-1 list-disc pl-4 text-xs",children:[e.jsx("li",{children:"Cada criterio tiene una puntuación máxima (ej: 10 pts)"}),e.jsx("li",{children:"El estudiante recibe puntos según su desempeño"}),e.jsx("li",{children:"La nota se calcula: (obtenidos / máximo) × peso de actividad"})]})]})]})})]}),s.length>0?e.jsx("div",{className:"space-y-4",children:s.map((i,L)=>e.jsxs("div",{className:"rounded-xl border border-gray-200 bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4 flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-blue-100",children:e.jsx(he,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Módulo ",L+1,": ",i.module_name]}),i.description&&e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:i.description}),e.jsxs("div",{className:"mt-2 flex items-center gap-4 text-sm text-gray-500",children:[e.jsxs("span",{children:[i.hours," horas"]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Nivel ",i.level]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{variant:"outline",size:"sm",onClick:()=>u({open:!0,studyPlan:i}),children:"Editar"}),e.jsx(h,{variant:"outline",size:"sm",onClick:()=>y({open:!0,studyPlanId:i.id,nextOrder:i.activities.length,currentTotalWeight:v(i.activities)}),children:e.jsx(H,{className:"h-4 w-4"})}),j("eliminar_plan_estudio")&&e.jsx(h,{variant:"outline",size:"sm",className:"text-red-600 hover:bg-red-50 hover:text-red-700",onClick:()=>d({open:!0,studyPlan:i}),children:e.jsx(ee,{className:"h-4 w-4"})})]})]}),i.activities.length>0?e.jsxs("div",{className:"ml-14 space-y-3",children:[(()=>{const n=Number(v(i.activities))||0,x=a(n);return e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-3",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700",children:"Actividades:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[x.status==="complete"?e.jsx(te,{className:"h-4 w-4 text-green-600"}):e.jsx(se,{className:`h-4 w-4 ${x.status==="over"?"text-red-600":"text-amber-600"}`}),e.jsxs("span",{className:`text-sm font-medium ${x.status==="complete"?"text-green-700":x.status==="over"?"text-red-700":"text-amber-700"}`,children:[n.toFixed(1),"% de 100% — ",x.message]})]})]}),e.jsx("div",{className:"h-2 w-full overflow-hidden rounded-full bg-gray-200",children:e.jsx("div",{className:`h-full transition-all duration-300 ${x.status==="complete"?"bg-green-500":x.status==="over"?"bg-red-500":"bg-amber-500"}`,style:{width:`${Math.min(n,100)}%`}})}),x.status!=="complete"&&e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:x.status==="over"?"La suma de pesos excede el 100%. Ajusta los pesos de las actividades.":"La suma de pesos debe ser exactamente 100% para que las calificaciones se calculen correctamente."})]})})(),i.activities.map(n=>e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-4",children:[e.jsxs("div",{className:"mb-3 flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-md bg-purple-100",children:e.jsx(Fe,{className:"h-4 w-4 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-gray-900",children:n.name}),n.description&&e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:n.description}),e.jsxs("div",{className:"mt-1 flex items-center gap-3 text-xs text-gray-500",children:[e.jsxs("span",{children:["Peso: ",n.weight,"%"]}),e.jsx("span",{children:"•"}),e.jsx("span",{className:`rounded-full px-2 py-0.5 ${n.status==="active"?"bg-green-100 text-green-700":"bg-gray-200 text-gray-700"}`,children:n.status==="active"?"Activa":"Inactiva"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>y({open:!0,studyPlanId:i.id,activity:n,currentTotalWeight:v(i.activities,n.id)}),children:"Editar"}),e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>g({open:!0,activityId:n.id,nextOrder:n.evaluation_criteria.length}),children:e.jsx(H,{className:"h-4 w-4"})}),j("eliminar_actividad")&&e.jsx(h,{variant:"ghost",size:"sm",className:"text-red-600 hover:bg-red-50 hover:text-red-700",onClick:()=>W({open:!0,activity:n}),children:e.jsx(ee,{className:"h-4 w-4"})})]})]}),n.evaluation_criteria.length>0&&e.jsxs("div",{className:"ml-11 space-y-2",children:[e.jsx("h6",{className:"text-xs font-semibold text-gray-600",children:"Criterios de Evaluación:"}),n.evaluation_criteria.map(x=>e.jsxs("div",{className:"flex items-center justify-between rounded-md border border-gray-200 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ke,{className:"h-4 w-4 text-amber-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:x.name}),x.description&&e.jsx("p",{className:"text-xs text-gray-600",children:x.description})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[x.max_points," pts"]}),e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>g({open:!0,activityId:n.id,criteria:x}),children:"Editar"}),j("eliminar_criterio_evaluacion")&&e.jsx(h,{variant:"ghost",size:"sm",className:"text-red-600 hover:bg-red-50 hover:text-red-700",onClick:()=>$({open:!0,criteria:x}),children:e.jsx(ee,{className:"h-4 w-4"})})]})]},x.id))]})]},n.id))]}):e.jsxs("div",{className:"ml-14 rounded-lg border-2 border-dashed border-gray-300 bg-gray-50 p-6 text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"No hay actividades en este módulo"}),e.jsxs(h,{variant:"outline",size:"sm",className:"mt-3",onClick:()=>y({open:!0,studyPlanId:i.id,nextOrder:0,currentTotalWeight:0}),children:[e.jsx(H,{className:"mr-2 h-4 w-4"}),"Agregar Primera Actividad"]})]})]},i.id))}):e.jsxs("div",{className:"rounded-xl border-2 border-dashed border-gray-300 bg-white p-12 text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-gray-100",children:e.jsx(he,{className:"h-8 w-8 text-gray-400"})}),e.jsx("h3",{className:"mb-2 text-xl font-semibold text-gray-900",children:"No hay módulos en este programa"}),e.jsx("p",{className:"mb-6 text-gray-600",children:"Comienza agregando el primer módulo al plan de estudios"}),e.jsxs(h,{onClick:()=>u({open:!0}),children:[e.jsx(H,{className:"mr-2 h-5 w-5"}),"Agregar Primer Módulo"]})]})]})]}),e.jsx($e,{open:f.open,onOpenChange:i=>u({open:i,studyPlan:void 0}),programId:t.id,studyPlan:f.studyPlan}),o.studyPlanId&&e.jsx(Ie,{open:o.open,onOpenChange:i=>y({open:i,studyPlanId:void 0,activity:void 0,currentTotalWeight:void 0}),studyPlanId:o.studyPlanId,activity:o.activity,nextOrder:o.nextOrder,currentTotalWeight:o.currentTotalWeight}),c.activityId&&e.jsx(Le,{open:c.open,onOpenChange:i=>g({open:i,activityId:void 0,criteria:void 0}),activityId:c.activityId,criteria:c.criteria,nextOrder:c.nextOrder}),e.jsx(O,{open:m.open,onOpenChange:i=>d({open:i,studyPlan:void 0}),children:e.jsxs(R,{children:[e.jsxs(V,{children:[e.jsx(J,{children:"Eliminar Módulo"}),e.jsxs(K,{children:['¿Estás seguro de que deseas eliminar el módulo "',m.studyPlan?.module_name,'"? Esta acción eliminará también todas las actividades y criterios de evaluación asociados. Esta acción no se puede deshacer.']})]}),e.jsxs(X,{children:[e.jsx(Y,{children:"Cancelar"}),e.jsx(Z,{onClick:M,className:"bg-red-600 hover:bg-red-700",children:"Eliminar"})]})]})}),e.jsx(O,{open:T.open,onOpenChange:i=>W({open:i,activity:void 0}),children:e.jsxs(R,{children:[e.jsxs(V,{children:[e.jsx(J,{children:"Eliminar Actividad"}),e.jsxs(K,{children:['¿Estás seguro de que deseas eliminar la actividad "',T.activity?.name,'"? Esta acción eliminará también todos los criterios de evaluación asociados. Esta acción no se puede deshacer.']})]}),e.jsxs(X,{children:[e.jsx(Y,{children:"Cancelar"}),e.jsx(Z,{onClick:I,className:"bg-red-600 hover:bg-red-700",children:"Eliminar"})]})]})}),e.jsx(O,{open:p.open,onOpenChange:i=>$({open:i,criteria:void 0}),children:e.jsxs(R,{children:[e.jsxs(V,{children:[e.jsx(J,{children:"Eliminar Criterio de Evaluación"}),e.jsxs(K,{children:['¿Estás seguro de que deseas eliminar el criterio "',p.criteria?.name,'"? Esta acción no se puede deshacer.']})]}),e.jsxs(X,{children:[e.jsx(Y,{children:"Cancelar"}),e.jsx(Z,{onClick:Ee,className:"bg-red-600 hover:bg-red-700",children:"Eliminar"})]})]})})]})}export{_t as default};
