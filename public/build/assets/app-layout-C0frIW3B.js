import{r as s,j as c,c as M,a as j}from"./app-H6L2XLiG.js";import{c as O}from"./utils-CBfrqCZ4.js";import{c as $,a as C}from"./index-BulkYsq2.js";import{u as L,a as V}from"./index-DowO3NHJ.js";import{d as S,A as W,D as q,C as U,k as Y,g as X}from"./index-DIsmkSZ7.js";import{P as z}from"./index-BbYiH1pf.js";import{P as J}from"./index-ZZBs93Xw.js";import{M as Q,k as Z}from"./app-header-1vj36u7D.js";import{t as ee,T as te}from"./toaster-DHWn-Mg9.js";const R=768;function re(){const[t,r]=s.useState();return s.useEffect(()=>{const e=window.matchMedia(`(max-width: ${R-1}px)`),n=()=>{r(window.innerWidth<R)};return e.addEventListener("change",n),r(window.innerWidth<R),()=>e.removeEventListener("change",n)},[]),!!t}var[w,$e]=$("Tooltip",[S]),_=S(),D="TooltipProvider",ne=700,I="tooltip.open",[oe,k]=w(D),N=t=>{const{__scopeTooltip:r,delayDuration:e=ne,skipDelayDuration:n=300,disableHoverableContent:o=!1,children:a}=t,i=s.useRef(!0),f=s.useRef(!1),l=s.useRef(0);return s.useEffect(()=>{const d=l.current;return()=>window.clearTimeout(d)},[]),c.jsx(oe,{scope:r,isOpenDelayedRef:i,delayDuration:e,onOpen:s.useCallback(()=>{window.clearTimeout(l.current),i.current=!1},[]),onClose:s.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.current=!0,n)},[n]),isPointerInTransitRef:f,onPointerInTransitChange:s.useCallback(d=>{f.current=d},[]),disableHoverableContent:o,children:a})};N.displayName=D;var H="Tooltip",[Ve,E]=w(H),A="TooltipTrigger",se=s.forwardRef((t,r)=>{const{__scopeTooltip:e,...n}=t,o=E(A,e),a=k(A,e),i=_(e),f=s.useRef(null),l=L(r,f,o.onTriggerChange),d=s.useRef(!1),u=s.useRef(!1),v=s.useCallback(()=>d.current=!1,[]);return s.useEffect(()=>()=>document.removeEventListener("pointerup",v),[v]),c.jsx(W,{asChild:!0,...i,children:c.jsx(J.button,{"aria-describedby":o.open?o.contentId:void 0,"data-state":o.stateAttribute,...n,ref:l,onPointerMove:C(t.onPointerMove,p=>{p.pointerType!=="touch"&&!u.current&&!a.isPointerInTransitRef.current&&(o.onTriggerEnter(),u.current=!0)}),onPointerLeave:C(t.onPointerLeave,()=>{o.onTriggerLeave(),u.current=!1}),onPointerDown:C(t.onPointerDown,()=>{o.open&&o.onClose(),d.current=!0,document.addEventListener("pointerup",v,{once:!0})}),onFocus:C(t.onFocus,()=>{d.current||o.onOpen()}),onBlur:C(t.onBlur,o.onClose),onClick:C(t.onClick,o.onClose)})})});se.displayName=A;var ae="TooltipPortal",[We,ie]=w(ae,{forceMount:void 0}),b="TooltipContent",ce=s.forwardRef((t,r)=>{const e=ie(b,t.__scopeTooltip),{forceMount:n=e.forceMount,side:o="top",...a}=t,i=E(b,t.__scopeTooltip);return c.jsx(z,{present:n||i.open,children:i.disableHoverableContent?c.jsx(B,{side:o,...a,ref:r}):c.jsx(le,{side:o,...a,ref:r})})}),le=s.forwardRef((t,r)=>{const e=E(b,t.__scopeTooltip),n=k(b,t.__scopeTooltip),o=s.useRef(null),a=L(r,o),[i,f]=s.useState(null),{trigger:l,onClose:d}=e,u=o.current,{onPointerInTransitChange:v}=n,p=s.useCallback(()=>{f(null),v(!1)},[v]),y=s.useCallback((h,g)=>{const T=h.currentTarget,x={x:h.clientX,y:h.clientY},m=ve(x,T.getBoundingClientRect()),P=xe(x,m),K=he(g.getBoundingClientRect()),F=ge([...P,...K]);f(F),v(!0)},[v]);return s.useEffect(()=>()=>p(),[p]),s.useEffect(()=>{if(l&&u){const h=T=>y(T,u),g=T=>y(T,l);return l.addEventListener("pointerleave",h),u.addEventListener("pointerleave",g),()=>{l.removeEventListener("pointerleave",h),u.removeEventListener("pointerleave",g)}}},[l,u,y,p]),s.useEffect(()=>{if(i){const h=g=>{const T=g.target,x={x:g.clientX,y:g.clientY},m=l?.contains(T)||u?.contains(T),P=!me(x,i);m?p():P&&(p(),d())};return document.addEventListener("pointermove",h),()=>document.removeEventListener("pointermove",h)}},[l,u,i,d,p]),c.jsx(B,{...t,ref:a})}),[ue,de]=w(H,{isInside:!1}),pe=V("TooltipContent"),B=s.forwardRef((t,r)=>{const{__scopeTooltip:e,children:n,"aria-label":o,onEscapeKeyDown:a,onPointerDownOutside:i,...f}=t,l=E(b,e),d=_(e),{onClose:u}=l;return s.useEffect(()=>(document.addEventListener(I,u),()=>document.removeEventListener(I,u)),[u]),s.useEffect(()=>{if(l.trigger){const v=p=>{p.target?.contains(l.trigger)&&u()};return window.addEventListener("scroll",v,{capture:!0}),()=>window.removeEventListener("scroll",v,{capture:!0})}},[l.trigger,u]),c.jsx(q,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:a,onPointerDownOutside:i,onFocusOutside:v=>v.preventDefault(),onDismiss:u,children:c.jsxs(U,{"data-state":l.stateAttribute,...d,...f,ref:r,style:{...f.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[c.jsx(pe,{children:n}),c.jsx(ue,{scope:e,isInside:!0,children:c.jsx(Y,{id:l.contentId,role:"tooltip",children:o||n})})]})})});ce.displayName=b;var G="TooltipArrow",fe=s.forwardRef((t,r)=>{const{__scopeTooltip:e,...n}=t,o=_(e);return de(G,e).isInside?null:c.jsx(X,{...o,...n,ref:r})});fe.displayName=G;function ve(t,r){const e=Math.abs(r.top-t.y),n=Math.abs(r.bottom-t.y),o=Math.abs(r.right-t.x),a=Math.abs(r.left-t.x);switch(Math.min(e,n,o,a)){case a:return"left";case o:return"right";case e:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function xe(t,r,e=5){const n=[];switch(r){case"top":n.push({x:t.x-e,y:t.y+e},{x:t.x+e,y:t.y+e});break;case"bottom":n.push({x:t.x-e,y:t.y-e},{x:t.x+e,y:t.y-e});break;case"left":n.push({x:t.x+e,y:t.y-e},{x:t.x+e,y:t.y+e});break;case"right":n.push({x:t.x-e,y:t.y-e},{x:t.x-e,y:t.y+e});break}return n}function he(t){const{top:r,right:e,bottom:n,left:o}=t;return[{x:o,y:r},{x:e,y:r},{x:e,y:n},{x:o,y:n}]}function me(t,r){const{x:e,y:n}=t;let o=!1;for(let a=0,i=r.length-1;a<r.length;i=a++){const f=r[a],l=r[i],d=f.x,u=f.y,v=l.x,p=l.y;u>n!=p>n&&e<(v-d)*(n-u)/(p-u)+d&&(o=!o)}return o}function ge(t){const r=t.slice();return r.sort((e,n)=>e.x<n.x?-1:e.x>n.x?1:e.y<n.y?-1:e.y>n.y?1:0),ye(r)}function ye(t){if(t.length<=1)return t.slice();const r=[];for(let n=0;n<t.length;n++){const o=t[n];for(;r.length>=2;){const a=r[r.length-1],i=r[r.length-2];if((a.x-i.x)*(o.y-i.y)>=(a.y-i.y)*(o.x-i.x))r.pop();else break}r.push(o)}r.pop();const e=[];for(let n=t.length-1;n>=0;n--){const o=t[n];for(;e.length>=2;){const a=e[e.length-1],i=e[e.length-2];if((a.x-i.x)*(o.y-i.y)>=(a.y-i.y)*(o.x-i.x))e.pop();else break}e.push(o)}return e.pop(),r.length===1&&e.length===1&&r[0].x===e[0].x&&r[0].y===e[0].y?r:r.concat(e)}var Te=N;function Ce({delayDuration:t=0,...r}){return c.jsx(Te,{"data-slot":"tooltip-provider",delayDuration:t,...r})}const be="sidebar_state",we=3600*24*7,Ee="16rem",Pe="3rem",Re="b",Ae=s.createContext(null);function _e({defaultOpen:t=!0,open:r,onOpenChange:e,className:n,style:o,children:a,...i}){const f=re(),[l,d]=s.useState(!1),[u,v]=s.useState(t),p=r??u,y=s.useCallback(x=>{const m=typeof x=="function"?x(p):x;e?e(m):v(m),document.cookie=`${be}=${m}; path=/; max-age=${we}`},[e,p]),h=s.useCallback(()=>f?d(x=>!x):y(x=>!x),[f,y,d]);s.useEffect(()=>{const x=m=>{m.key===Re&&(m.metaKey||m.ctrlKey)&&(m.preventDefault(),h())};return window.addEventListener("keydown",x),()=>window.removeEventListener("keydown",x)},[h]);const g=p?"expanded":"collapsed",T=s.useMemo(()=>({state:g,open:p,setOpen:y,isMobile:f,openMobile:l,setOpenMobile:d,toggleSidebar:h}),[g,p,y,f,l,d,h]);return c.jsx(Ae.Provider,{value:T,children:c.jsx(Ce,{delayDuration:0,children:c.jsx("div",{"data-slot":"sidebar-wrapper",style:{"--sidebar-width":Ee,"--sidebar-width-icon":Pe,...o},className:O("group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full",n),...i,children:a})})})}function je({className:t,...r}){return c.jsx("main",{"data-slot":"sidebar-inset",className:O("bg-background relative flex max-w-full min-h-svh flex-1 flex-col","peer-data-[variant=inset]:min-h-[calc(100svh-(--spacing(4)))] md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-0",t),...r})}function Ie({variant:t="header",children:r,...e}){return t==="sidebar"?c.jsx(je,{...e,children:r}):c.jsx("main",{className:"flex h-full w-full flex-1 flex-col bg-[#f9f6f2] p-6",...e,children:r})}function Me({children:t,variant:r="header"}){const e=M().props.sidebarOpen;return r==="header"?c.jsx("div",{className:"flex min-h-screen w-full flex-col",children:t}):c.jsx(_e,{defaultOpen:e,children:t})}function Oe(){const t=M(),{auth:r}=t.props,e=r.unreadMessages||0,n=s.useRef(null),o=s.useRef(!0);return s.useEffect(()=>{const a=setInterval(()=>{j.reload({only:["auth"],preserveScroll:!0,preserveState:!0})},5e3);return()=>clearInterval(a)},[]),s.useEffect(()=>{if(o.current){n.current=e,o.current=!1,console.log("Initial unread count:",e);return}if(n.current!==null&&e>n.current){const a=e-n.current;console.log("New messages detected:",a,"Previous:",n.current,"Current:",e),ee.info(a===1?"Tienes un nuevo mensaje":`Tienes ${a} mensajes nuevos`,{icon:c.jsx(Q,{className:"h-4 w-4"}),duration:5e3,action:{label:"Ver",onClick:()=>j.visit("/comunicacion")}})}n.current=e},[e]),null}function Le({children:t,breadcrumbs:r}){return c.jsxs(Me,{children:[c.jsx(Z,{breadcrumbs:r}),c.jsx(Ie,{children:t}),c.jsx(te,{}),c.jsx(Oe,{})]})}const qe=({children:t,breadcrumbs:r,...e})=>c.jsx(Le,{breadcrumbs:r,...e,children:t});export{qe as A};
