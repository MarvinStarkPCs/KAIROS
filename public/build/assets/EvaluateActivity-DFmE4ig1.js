import{r as b,j as a,H as S,L as _,a as T}from"./app-CCy7W__U.js";import{A as F}from"./app-layout-Cgwn0YwR.js";import{B as x}from"./button-BPe5EzVr.js";import{C as p,a as y,b as C,d as h}from"./card-wEqWHHWF.js";import{B as j}from"./badge-DGOkHb-1.js";import{I as E}from"./input-fxUu1f-f.js";import{T as L}from"./textarea-Dxw2yNos.js";import{L as u}from"./label-yFtup6Gn.js";import{I as v,G as P}from"./app-header-DKqOVDKz.js";import{A as B}from"./arrow-left-t7vlrSH4.js";import{S as D}from"./save-COCyMSuv.js";import"./app-C6vnqMAD.js";import"./utils-CBfrqCZ4.js";import"./index-m7oUW3f4.js";import"./createLucideIcon-CmQENsVl.js";import"./index-B9GwPkn3.js";import"./index-Drvm0ZTs.js";import"./toaster-CG-J_icD.js";import"./index-YEfPdCwI.js";import"./wayfinder-FFrBTblC.js";import"./house-DKoGCZg9.js";import"./lock-BzKk68zL.js";import"./shield-BzqX2DKN.js";import"./music-Bsm2Yhl0.js";import"./mail-7oQab10h.js";function oa({schedule:l,activity:r,students:n}){const[f,$]=b.useState(new Date().toISOString().split("T")[0]),[o,g]=b.useState(()=>{const e={};return n.forEach(s=>{e[s.id]={student_id:s.id,criteria:r.evaluation_criteria.map(i=>{const c=s.existing_evaluations.find(t=>t.evaluation_criteria_id===i.id);return{evaluation_criteria_id:i.id,points_earned:c?.points_earned||0}}),feedback:s.existing_evaluations[0]?.feedback||""}}),e}),w=(e,s,i)=>{const c=parseFloat(i)||0;g(t=>({...t,[e]:{...t[e],criteria:t[e].criteria.map(m=>m.evaluation_criteria_id===s?{...m,points_earned:c}:m)}}))},k=(e,s)=>{g(i=>({...i,[e]:{...i[e],feedback:s}}))},N=e=>o[e]?.criteria.reduce((s,i)=>s+i.points_earned,0)||0,d=()=>r.evaluation_criteria.reduce((e,s)=>e+s.max_points,0),A=()=>{const e=Object.values(o);T.post(`/profesor/grupo/${l.id}/actividad/${r.id}/evaluaciones`,{evaluation_date:f,evaluations:e})};return a.jsxs(F,{variant:"sidebar",title:`Evaluar: ${r.name} - Portal Profesor`,children:[a.jsx(S,{title:`Evaluar: ${r.name} - Portal Profesor`}),a.jsxs("div",{className:"px-6 py-8",children:[a.jsx("div",{className:"mb-8",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Evaluar Actividad"}),a.jsx("p",{className:"text-gray-600",children:l.program.name})]}),a.jsx(_,{href:`/profesor/grupo/${l.id}`,children:a.jsxs(x,{variant:"outline",children:[a.jsx(v,{iconNode:B,className:"w-4 h-4 mr-2"}),"Volver"]})})]})}),a.jsxs(p,{className:"mb-6",children:[a.jsx(y,{children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsx(C,{className:"text-2xl mb-2",children:r.name}),a.jsx("p",{className:"text-gray-600 mb-3",children:r.description}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(j,{variant:"outline",children:r.study_plan.module_name}),a.jsxs(j,{variant:"secondary",children:["Peso: ",r.weight,"%"]}),a.jsxs(j,{variant:"secondary",children:["Puntaje Total: ",d()," puntos"]})]})]}),a.jsx(v,{iconNode:P,className:"w-12 h-12 text-[#7a9b3c]"})]})}),a.jsx(h,{children:a.jsxs("div",{children:[a.jsx(u,{htmlFor:"evaluation_date",children:"Fecha de Evaluación"}),a.jsx(E,{id:"evaluation_date",type:"date",value:f,onChange:e=>$(e.target.value),className:"max-w-xs"})]})})]}),a.jsx("div",{className:"space-y-6",children:n.length===0?a.jsx(p,{children:a.jsx(h,{className:"py-12 text-center text-gray-500",children:"No hay estudiantes para evaluar"})}):n.map(e=>a.jsxs(p,{children:[a.jsx(y,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(C,{children:e.name}),a.jsx("p",{className:"text-sm text-gray-600",children:e.email})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"text-3xl font-bold text-gray-900",children:[N(e.id),"/",d()]}),a.jsxs("div",{className:"text-sm text-gray-600",children:[d()>0?Math.round(N(e.id)/d()*100):0,"%"]})]})]})}),a.jsx(h,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Criterios de Evaluación"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.evaluation_criteria.map(s=>a.jsxs("div",{className:"space-y-2",children:[a.jsxs(u,{htmlFor:`student-${e.id}-criteria-${s.id}`,children:[s.name,a.jsxs("span",{className:"text-gray-500 ml-2 text-sm",children:["(Max: ",s.max_points," pts)"]})]}),a.jsx(E,{id:`student-${e.id}-criteria-${s.id}`,type:"number",min:"0",max:s.max_points,step:"0.5",value:o[e.id]?.criteria.find(i=>i.evaluation_criteria_id===s.id)?.points_earned||0,onChange:i=>w(e.id,s.id,i.target.value)}),s.description&&a.jsx("p",{className:"text-xs text-gray-500",children:s.description})]},s.id))})]}),a.jsxs("div",{children:[a.jsx(u,{htmlFor:`feedback-${e.id}`,children:"Retroalimentación (opcional)"}),a.jsx(L,{id:`feedback-${e.id}`,placeholder:"Escribe comentarios o sugerencias para el estudiante...",value:o[e.id]?.feedback||"",onChange:s=>k(e.id,s.target.value),rows:3})]})]})})]},e.id))}),n.length>0&&a.jsxs("div",{className:"mt-8 flex gap-4",children:[a.jsxs(x,{onClick:A,className:"flex-1 bg-[#7a9b3c] hover:bg-[#6a8a2c] text-lg py-6",children:[a.jsx(v,{iconNode:D,className:"w-5 h-5 mr-2"}),"Guardar Evaluaciones"]}),a.jsx(_,{href:`/profesor/grupo/${l.id}`,className:"flex-shrink-0",children:a.jsx(x,{variant:"outline",className:"text-lg py-6",children:"Cancelar"})})]})]})]})}export{oa as default};
