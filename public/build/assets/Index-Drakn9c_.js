import{r as m,j as e,H as B,a as x}from"./app-_rOQn_46.js";import{B as i}from"./button-Cwjg0RKq.js";import{I as v}from"./input-C_eRjc1n.js";import{T as I,a as O,b as A,c as n,d as U,e as l}from"./table-mJfQHbWO.js";import{B as p}from"./badge-CxkKJAJ8.js";import{C as P,b as V,c as q,d as W,a as k}from"./card-BBOBQJet.js";import{D as $,a as G,b as J,c as K}from"./dialog-DY_ZgsD6.js";import{s as u}from"./index-ikzcNs2d.js";import{A as X}from"./app-layout-CLhCFhGY.js";import{A as y}from"./activity-BpwSMK-a.js";import{F as Q}from"./filter-BrnGtBRn.js";import{S as E,X as Y}from"./app-header-uhUDMoS0.js";import{C as Z}from"./clock-92yNzH6p.js";import{U as ee}from"./user-C5Kq0LMs.js";import{F as se}from"./file-text-CqZet-U8.js";import{E as te}from"./eye-HnW50b-k.js";import{C as ae}from"./chevron-left-D4ydDAw0.js";import{C as re}from"./chevron-right-KvpbVvzH.js";/* empty css            */import"./utils-CHYGzkwl.js";import"./index-HbNiKBAr.js";import"./index-kZXzX9CC.js";import"./index-C0WYYgI1.js";import"./createLucideIcon-BTUecZaa.js";import"./index-DhMGY2fr.js";import"./index-LDKjRhno.js";import"./index-86eqSqYr.js";import"./toaster-DF114ULM.js";import"./index-B4ow9L1E.js";import"./index-CLa6oRL-.js";import"./wayfinder-Bf9OnZdi.js";import"./index-D12nj1Ca.js";import"./book-open-d3nfV-Db.js";import"./graduation-cap-h2z_kizA.js";import"./users-CU2UoBYp.js";import"./credit-card-CtYZ3YyT.js";import"./calendar-DwYwQP4N.js";import"./lock-BoKNE-VZ.js";import"./shield-DI4dg6mj.js";import"./chevron-down-gmsC21Id.js";import"./loader-circle-eUOhA3c_.js";import"./mail-DuzhTNEq.js";const le=[{title:"Inicio",href:u("programas_academicos.index")},{title:"Auditoría",href:u("audit.index")}];function F(s){return{"App\\Models\\User":"Usuario","App\\Models\\AcademicProgram":"Programa","App\\Models\\Enrollment":"Matrícula","App\\Models\\Payment":"Pago","App\\Models\\Schedule":"Horario","App\\Models\\Attendance":"Asistencia","App\\Models\\StudyPlan":"Plan de Estudio","App\\Models\\Activity":"Actividad","App\\Models\\Message":"Mensaje","App\\Models\\Conversation":"Conversación","App\\Models\\ParentGuardian":"Acudiente","App\\Models\\StudentProfile":"Perfil Estudiante","App\\Models\\TeacherProfile":"Perfil Profesor","App\\Models\\ScheduleEnrollment":"Inscripción Horario","App\\Models\\EvaluationCriteria":"Criterio Evaluación","App\\Models\\ActivityEvaluation":"Evaluación","App\\Models\\PaymentTransaction":"Transacción","App\\Models\\PaymentSetting":"Config. Pago","App\\Models\\WompiSetting":"Config. Wompi","App\\Models\\SmtpSetting":"Config. SMTP","App\\Models\\DemoRequest":"Solicitud Demo","App\\Models\\DemoLead":"Demo Lead","App\\Models\\StudentProgress":"Progreso"}[s]||s.split("\\").pop()||"Desconocido"}function C(s){return{created:{label:"Creado",className:"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-200"},updated:{label:"Actualizado",className:"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200"},deleted:{label:"Eliminado",className:"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-200"}}[s]||{label:s,className:"bg-muted text-foreground"}}function T(s){return new Date(s).toLocaleDateString("es-CO",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function H(s){return s==null?"—":typeof s=="boolean"?s?"Sí":"No":typeof s=="object"?JSON.stringify(s):String(s)}function L(s){return{name:"Nombre",last_name:"Apellido",email:"Email",status:"Estado",description:"Descripción",monthly_fee:"Cuota Mensual",amount:"Monto",due_date:"Fecha Vencimiento",payment_date:"Fecha Pago",payment_method:"Método Pago",enrolled_level:"Nivel",enrollment_date:"Fecha Matrícula",days_of_week:"Días",start_time:"Hora Inicio",end_time:"Hora Fin",classroom:"Salón",max_students:"Cupos Máx.",class_date:"Fecha Clase",notes:"Notas",modality:"Modalidad",concept:"Concepto",reference_number:"Referencia",is_active:"Activo",module_name:"Módulo",hours:"Horas",level:"Nivel",weight:"Peso",order:"Orden",points_earned:"Puntos",feedback:"Retroalimentación",color:"Color",semester:"Semestre",duration_months:"Duración (meses)",progress:"Progreso",remarks:"Observaciones"}[s]||s.replace(/_/g," ").replace(/\b\w/g,h=>h.toUpperCase())}function Je({activities:s,links:c,meta:h,filters:g}){const[j,w]=m.useState(g?.action||""),[f,M]=m.useState(g?.start_date||""),[N,_]=m.useState(g?.end_date||""),[a,S]=m.useState(null),r=h||{current_page:s.current_page,from:s.from,last_page:s.last_page,to:s.to,total:s.total},o=c||s.links,D=()=>{x.get(u("audit.filter"),{action:j||void 0,start_date:f||void 0,end_date:N||void 0},{preserveState:!0,preserveScroll:!0})},R=()=>{w(""),M(""),_(""),x.get(u("audit.index"))},z=j||f||N,b=s.data||s;return e.jsxs(X,{breadcrumbs:le,children:[e.jsx(B,{title:"Auditoría"}),e.jsxs("div",{className:"mx-auto max-w-7xl space-y-6 p-4 lg:p-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Registro de Auditoría"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Historial de cambios realizados en el sistema"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(p,{variant:"outline",className:"text-sm",children:[e.jsx(y,{className:"mr-1 h-3.5 w-3.5"}),r.total," registros"]})})]}),e.jsxs(P,{children:[e.jsxs(V,{className:"pb-3",children:[e.jsxs(q,{className:"flex items-center gap-2 text-base",children:[e.jsx(Q,{className:"h-4 w-4"}),"Filtros"]}),e.jsx(W,{children:"Filtra los registros por acción, fecha o usuario"})]}),e.jsx(k,{children:e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-end",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"mb-1 block text-xs font-medium text-muted-foreground",children:"Buscar acción"}),e.jsxs("div",{className:"relative",children:[e.jsx(v,{value:j,onChange:t=>w(t.target.value),placeholder:"created, updated, deleted...",className:"pl-9",onKeyDown:t=>t.key==="Enter"&&D()}),e.jsx(E,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-medium text-muted-foreground",children:"Desde"}),e.jsx(v,{type:"date",value:f,onChange:t=>M(t.target.value),className:"w-40"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-medium text-muted-foreground",children:"Hasta"}),e.jsx(v,{type:"date",value:N,onChange:t=>_(t.target.value),className:"w-40"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(i,{onClick:D,size:"sm",children:[e.jsx(E,{className:"mr-1 h-4 w-4"}),"Filtrar"]}),z&&e.jsxs(i,{onClick:R,variant:"outline",size:"sm",children:[e.jsx(Y,{className:"mr-1 h-4 w-4"}),"Limpiar"]})]})]})})]}),e.jsxs(P,{children:[e.jsx(k,{className:"p-0",children:e.jsxs(I,{children:[e.jsx(O,{children:e.jsxs(A,{children:[e.jsx(n,{className:"w-[180px]",children:"Fecha"}),e.jsx(n,{children:"Usuario"}),e.jsx(n,{className:"w-[120px]",children:"Acción"}),e.jsx(n,{children:"Entidad"}),e.jsx(n,{children:"Elemento"}),e.jsx(n,{className:"w-[80px] text-center",children:"Detalle"})]})}),e.jsx(U,{children:Array.isArray(b)&&b.length>0?b.map(t=>{const d=C(t.description);return e.jsxs(A,{className:"hover:bg-muted",children:[e.jsx(l,{className:"text-xs text-muted-foreground",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Z,{className:"h-3.5 w-3.5 text-muted-foreground"}),T(t.created_at)]})}),e.jsx(l,{children:t.causer?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex h-7 w-7 items-center justify-center rounded-full bg-muted",children:e.jsx(ee,{className:"h-3.5 w-3.5 text-muted-foreground"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-foreground",children:t.causer.name}),e.jsx("div",{className:"text-xs text-muted-foreground",children:t.causer.email})]})]}):e.jsx("span",{className:"text-xs text-muted-foreground italic",children:"Sistema"})}),e.jsx(l,{children:e.jsx(p,{variant:"secondary",className:d.className,children:d.label})}),e.jsx(l,{children:t.subject?e.jsxs(p,{variant:"outline",className:"font-normal",children:[e.jsx(se,{className:"mr-1 h-3 w-3"}),F(t.subject.type)]}):e.jsx("span",{className:"text-xs text-muted-foreground",children:"—"})}),e.jsxs(l,{children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:t.subject?.name||"—"}),t.subject?.id&&e.jsxs("span",{className:"ml-1 text-xs text-muted-foreground",children:["#",t.subject.id]})]}),e.jsx(l,{className:"text-center",children:e.jsx(i,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>S(t),children:e.jsx(te,{className:"h-4 w-4 text-muted-foreground"})})})]},t.id)}):e.jsx(A,{children:e.jsx(l,{colSpan:6,className:"py-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2 text-muted-foreground",children:[e.jsx(y,{className:"h-10 w-10"}),e.jsx("p",{className:"text-sm font-medium",children:"No se encontraron registros"}),e.jsx("p",{className:"text-xs",children:"Intenta ajustar los filtros de búsqueda"})]})})})})]})}),r.last_page>1&&e.jsxs("div",{className:"flex items-center justify-between border-t px-4 py-3",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Mostrando"," ",e.jsx("span",{className:"font-medium",children:r.from})," ","a"," ",e.jsx("span",{className:"font-medium",children:r.to})," ","de"," ",e.jsx("span",{className:"font-medium",children:r.total})," ","registros"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(i,{variant:"outline",size:"sm",disabled:!o?.prev,onClick:()=>o?.prev&&x.get(o.prev),children:[e.jsx(ae,{className:"h-4 w-4"}),"Anterior"]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Página ",r.current_page," de"," ",r.last_page]}),e.jsxs(i,{variant:"outline",size:"sm",disabled:!o?.next,onClick:()=>o?.next&&x.get(o.next),children:["Siguiente",e.jsx(re,{className:"h-4 w-4"})]})]})]})]})]}),e.jsx($,{open:!!a,onOpenChange:()=>S(null),children:e.jsxs(G,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsx(J,{children:e.jsxs(K,{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-5 w-5"}),"Detalle del Registro #",a?.id]})}),a&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 rounded-lg bg-muted p-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Fecha"}),e.jsx("p",{className:"text-sm text-foreground",children:T(a.created_at)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Acción"}),e.jsx(p,{variant:"secondary",className:C(a.description).className,children:C(a.description).label})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Usuario"}),e.jsx("p",{className:"text-sm text-foreground",children:a.causer?.name||"Sistema"}),a.causer?.email&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.causer.email})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Entidad"}),e.jsx("p",{className:"text-sm text-foreground",children:a.subject?`${F(a.subject.type)} #${a.subject.id}`:"—"}),a.subject?.name&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.subject.name})]})]}),a.properties?.attributes&&e.jsxs("div",{children:[e.jsxs("h4",{className:"mb-2 flex items-center gap-1.5 text-sm font-semibold text-foreground",children:[e.jsx("span",{className:"h-2 w-2 rounded-full bg-green-500"}),a.properties?.old?"Valores Nuevos":"Valores"]}),e.jsx("div",{className:"overflow-hidden rounded-lg border",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-green-50 dark:bg-green-950/30",children:[e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-muted-foreground",children:"Campo"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-muted-foreground",children:"Valor"})]})}),e.jsx("tbody",{className:"divide-y divide-border",children:Object.entries(a.properties.attributes).map(([t,d])=>e.jsxs("tr",{className:"hover:bg-muted",children:[e.jsx("td",{className:"px-3 py-2 font-medium text-muted-foreground",children:L(t)}),e.jsx("td",{className:"px-3 py-2 text-muted-foreground",children:H(d)})]},t))})]})})]}),a.properties?.old&&e.jsxs("div",{children:[e.jsxs("h4",{className:"mb-2 flex items-center gap-1.5 text-sm font-semibold text-foreground",children:[e.jsx("span",{className:"h-2 w-2 rounded-full bg-orange-500"}),"Valores Anteriores"]}),e.jsx("div",{className:"overflow-hidden rounded-lg border",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-orange-50 dark:bg-orange-950/30",children:[e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-muted-foreground",children:"Campo"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-muted-foreground",children:"Valor"})]})}),e.jsx("tbody",{className:"divide-y divide-border",children:Object.entries(a.properties.old).map(([t,d])=>e.jsxs("tr",{className:"hover:bg-muted",children:[e.jsx("td",{className:"px-3 py-2 font-medium text-muted-foreground",children:L(t)}),e.jsx("td",{className:"px-3 py-2 text-muted-foreground",children:H(d)})]},t))})]})})]}),!a.properties?.attributes&&!a.properties?.old&&e.jsx("div",{className:"rounded-lg border border-dashed py-8 text-center text-sm text-muted-foreground",children:"No hay detalles de cambios registrados"})]})]})})]})}export{Je as default};
